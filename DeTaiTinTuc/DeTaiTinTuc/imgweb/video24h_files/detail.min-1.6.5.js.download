!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.zPlayer=t():e.zPlayer=t()}(window,function(){return function(s){function e(e){for(var t,n,r=e[0],i=e[1],o=0,a=[];o<r.length;o++)n=r[o],l[n]&&a.push(l[n][0]),l[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(s[t]=i[t]);for(c&&c(e);a.length;)a.shift()()}var n={},l={0:0};function u(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,u),t.l=!0,t.exports}u.e=function(i){var e,o,t,a,n=[],r=l[i];return 0!==r&&(r?n.push(r[2]):(e=new Promise(function(e,t){r=l[i]=[e,t]}),n.push(r[2]=e),e=document.getElementsByTagName("head")[0],(o=document.createElement("script")).charset="utf-8",o.timeout=120,u.nc&&o.setAttribute("nonce",u.nc),o.src=u.p+""+({}[i]||i)+".min.js",t=function(e){o.onerror=o.onload=null,clearTimeout(a);var t,n,r=l[i];0!==r&&(r&&(t=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,(e=new Error("Loading chunk "+i+" failed.\n("+t+": "+n+")")).type=t,e.request=n,r[1](e)),l[i]=void 0)},a=setTimeout(function(){t({type:"timeout",target:o})},12e4),o.onerror=o.onload=t,e.appendChild(o))),Promise.all(n)},u.m=s,u.c=n,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="https://zjs.zadn.vn/zplayer/releases/v1.0.60/",u.oe=function(e){throw console.error(e),e};var t=(r=window.webpackJsonpzPlayer=window.webpackJsonpzPlayer||[]).push.bind(r);r.push=e;for(var r=r.slice(),i=0;i<r.length;i++)e(r[i]);var c=t;return u(u.s=32)}([function(e,t,n){"undefined"!=typeof window&&(e.exports=function(){return r={},i.m=n={"./node_modules/eventemitter3/index.js":function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,h="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");i=new o(n,r||e,i),t=h?h+t:t;return e._events[t]?e._events[t].fn?e._events[t]=[e._events[t],i]:e._events[t].push(i):(e._events[t]=i,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(h=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(h?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var e=h?h+e:e,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,i=new Array(r);n<r;n++)i[n]=t[n].fn;return i},s.prototype.listenerCount=function(e){e=h?h+e:e,e=this._events[e];return e?e.fn?1:e.length:0},s.prototype.emit=function(e,t,n,r,i,o){var a=h?h+e:e;if(!this._events[a])return!1;var s,l=this._events[a],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,i),!0;case 6:return l.fn.call(l.context,t,n,r,i,o),!0}for(f=1,s=new Array(u-1);f<u;f++)s[f-1]=arguments[f];l.fn.apply(l.context,s)}else for(var c,d=l.length,f=0;f<d;f++)switch(l[f].once&&this.removeListener(e,l[f].fn,void 0,!0),u){case 1:l[f].fn.call(l[f].context);break;case 2:l[f].fn.call(l[f].context,t);break;case 3:l[f].fn.call(l[f].context,t,n);break;case 4:l[f].fn.call(l[f].context,t,n,r);break;default:if(!s)for(c=1,s=new Array(u-1);c<u;c++)s[c-1]=arguments[c];l[f].fn.apply(l[f].context,s)}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,n,r){e=h?h+e:e;if(!this._events[e])return this;if(!t)return l(this,e),this;var i=this._events[e];if(i.fn)i.fn!==t||r&&!i.once||n&&i.context!==n||l(this,e);else{for(var o=0,a=[],s=i.length;o<s;o++)(i[o].fn!==t||r&&!i[o].once||n&&i[o].context!==n)&&a.push(i[o]);a.length?this._events[e]=1===a.length?a[0]:a:l(this,e)}return this},s.prototype.removeAllListeners=function(e){return e?(e=h?h+e:e,this._events[e]&&l(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=h,e.exports=s.EventEmitter=s},"./node_modules/node-libs-browser/node_modules/events/events.js":function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((e.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,o,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(c(n=this._events[e]))return!1;if(l(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(u(n))for(i=Array.prototype.slice.call(arguments,1),r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i);return!0},r.prototype.on=r.prototype.addListener=function(e,t){var n;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(n=c(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,i,o;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||l(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(n)){for(o=i;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){e=this._events[e];if(l(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,n){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,o=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}r=s.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return n.alwaysNormalize?(r.path=s.normalizePath(r.path),s.buildURLFromParts(r)):t;t=s.parseURL(e);if(!t)throw new Error("Error trying to parse base URL.");!t.netLoc&&t.path&&"/"!==t.path[0]&&(i=o.exec(t.path),t.netLoc=i[1],t.path=i[2]),t.netLoc&&!t.path&&(t.path="/");var i,e={scheme:t.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};return r.netLoc||(e.netLoc=t.netLoc,"/"===r.path[0])||(r.path?(i=(i=t.path).substring(0,i.lastIndexOf("/")+1)+r.path,e.path=s.normalizePath(i)):(e.path=t.path,r.params||(e.params=t.params,r.query||(e.query=t.query)))),null===e.path&&(e.path=n.alwaysNormalize?s.normalizePath(r.path):r.path),s.buildURLFromParts(e)},parseURL:function(e){e=r.exec(e);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=s},"./node_modules/webworkify-webpack/index.js":function(e,t,f){function o(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=r,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var e=i(i.s=ENTRY_MODULE);return e.default||e}var h="[\\.|\\-|\\+|\\w|/|@]+",p="\\((/\\*.*?\\*/)?s?.*?("+h+").*?\\)";function y(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}e.exports=function(d,e){var n={main:f.m},r=(e=e||{}).all?{main:Object.keys(n.main)}:function(e){for(var t={main:[d]},n={main:[]},r={main:{}};function(n){return Object.keys(n).reduce(function(e,t){return e||0<n[t].length},!1)}(t);)for(var i=Object.keys(t),o=0;o<i.length;o++){var a=i[o],s=t[a].pop();if(r[a]=r[a]||{},!r[a][s]&&e[a][s]){r[a][s]=!0,n[a]=n[a]||[],n[a].push(s);for(var l=function(e,t,n){var r={};r[n]=[];var i=t.toString();if(!(t=i.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/)))return r;for(var o,t=t[1],a=new RegExp("(\\\\n|\\W)"+y(t)+p,"g");o=a.exec(i);)"dll-reference"!==o[3]&&r[n].push(o[3]);for(a=new RegExp("\\("+y(t)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+p,"g");o=a.exec(i);)e[o[2]]||(r[n].push(o[1]),e[o[2]]=f(o[1]).m),r[o[2]]=r[o[2]]||[],r[o[2]].push(o[4]);for(var s,l=Object.keys(r),u=0;u<l.length;u++)for(var c=0;c<r[l[u]].length;c++)s=r[l[u]][c],isNaN(+s)||(r[l[u]][c]=+r[l[u]][c]);return r}(e,e[a][s],a),u=Object.keys(l),c=0;c<u.length;c++)t[u[c]]=t[u[c]]||[],t[u[c]]=t[u[c]].concat(l[u[c]])}}return n}(n),i="";Object.keys(r).filter(function(e){return"main"!==e}).forEach(function(t){for(var e=0;r[t][e];)e++;r[t].push(e),n[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+"var "+t+" = ("+o.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+r[t].map(function(e){return JSON.stringify(e)+": "+n[t][e].toString()}).join(",")+"});\n"});var i=i+"new (("+o.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+r.main.map(function(e){return JSON.stringify(e)+": "+n.main[e].toString()}).join(",")+"}))(self);",t=new window.Blob([i],{type:"text/javascript"});if(e.bare)return t;e=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(t),t=new window.Worker(e);return t.objectURL=e,t}},"./src/config.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./src/controller/abr-controller.js"),i=n("./src/controller/buffer-controller.js"),o=n("./src/controller/cap-level-controller.js"),a=n("./src/controller/fps-controller.js"),s=n("./src/utils/xhr-loader.js"),l=n("./src/controller/audio-track-controller.js"),u=n("./src/controller/audio-stream-controller.js"),c=n("./src/utils/cues.js"),d=n("./src/controller/timeline-controller.js"),f=n("./src/controller/subtitle-track-controller.js"),h=n("./src/controller/subtitle-stream-controller.js"),p=n("./src/controller/eme-controller.js"),n=n("./src/utils/mediakeys-helper.js");t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:r.default,bufferController:i.default,capLevelController:o.default,fpsController:a.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:n.requestMediaKeySystemAccess},t.hlsDefaultConfig.subtitleStreamController=h.SubtitleStreamController,t.hlsDefaultConfig.subtitleTrackController=f.default,t.hlsDefaultConfig.timelineController=d.default,t.hlsDefaultConfig.cueHandler=c,t.hlsDefaultConfig.enableCEA708Captions=!0,t.hlsDefaultConfig.enableWebVTT=!0,t.hlsDefaultConfig.captionsTextTrack1Label="English",t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en",t.hlsDefaultConfig.captionsTextTrack2Label="Spanish",t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es",t.hlsDefaultConfig.audioStreamController=u.default,t.hlsDefaultConfig.audioTrackController=l.default,t.hlsDefaultConfig.emeController=p.default},"./src/controller/abr-controller.js":function(e,l,u){"use strict";!function(i){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(l,"__esModule",{value:!0});var n,g=u("./src/events.js"),t=u("./src/event-handler.js"),m=u("./src/utils/buffer-helper.js"),o=u("./src/errors.js"),v=u("./src/utils/logger.js"),a=u("./src/utils/ewma-bandwidth-estimator.js"),b=window.performance,e=(n=t.default,e(s,n),s.prototype.destroy=function(){this.clearTimer(),t.default.prototype.destroy.call(this)},s.prototype.onFragLoading=function(e){var t,n,r,i=e.frag;"main"!==i.type||(this.timer||(this.fragCurrent=i,this.timer=setInterval(this.onCheck,100)),this._bwEstimator)||(n=(t=this.hls).config,r=i.level,i=e=void 0,i=t.levels[r].details.live?(e=n.abrEwmaFastLive,n.abrEwmaSlowLive):(e=n.abrEwmaFastVoD,n.abrEwmaSlowVoD),this._bwEstimator=new a.default(t,i,e,n.abrEwmaDefaultEstimate))},s.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,n=this.fragCurrent;if(n){var r=n.loader,i=e.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return v.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var o=r.stats;if(t&&o&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var a=b.now()-o.trequest,s=Math.abs(t.playbackRate);if(a>500*n.duration/s){var l=e.levels,u=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/a),c=l[n.level],d=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate,c=o.total||Math.max(o.loaded,Math.round(n.duration*d/8)),d=t.currentTime,c=(c-o.loaded)/u,f=(m.BufferHelper.bufferInfo(t,d,e.config.maxBufferHole).end-d)/s;if(f<2*n.duration/s&&f<c){for(var h=void 0,p=void 0,p=n.level-1;i<p;p--){var y=l[p].realBitrate?Math.max(l[p].realBitrate,l[p].bitrate):l[p].bitrate;if((h=n.duration*y/(6.4*u))<f)break}h<c&&(v.logger.warn("loading too slow, abort fragment loading and switch to level "+p+":fragLoadedDelay["+p+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+h.toFixed(1)+"<"+c.toFixed(1)+":"+f.toFixed(1)),e.nextLoadLevel=p,this._bwEstimator.sample(a,o.loaded),r.abort(),this.clearTimer(),e.trigger(g.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:o}))}}}}},s.prototype.onFragLoaded=function(e){var t,n,r=e.frag;"main"===r.type&&i.isFinite(r.sn)&&(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate&&(r=((t=this.hls.levels[r.level]).loaded?t.loaded.bytes:0)+e.stats.loaded,n=(t.loaded?t.loaded.duration:0)+e.frag.duration,t.loaded={bytes:r,duration:n},t.realBitrate=Math.round(8*r/n)),e.frag.bitrateTest&&((n=e.stats).tparsed=n.tbuffered=n.tload,this.onFragBuffered(e)))},s.prototype.onFragBuffered=function(e){var t=e.stats,n=e.frag;!0===t.aborted||"main"!==n.type||!i.isFinite(n.sn)||n.bitrateTest&&t.tload!==t.tbuffered||(e=t.tparsed-t.trequest,v.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(e,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=e/1e3:this.bitrateTestDelay=0)},s.prototype.onError=function(e){switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},s.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Object.defineProperty(s.prototype,"nextAutoLevel",{get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;t=this._nextABRAutoLevel;return t=-1!==e?Math.min(e,t):t},set:function(e){this._nextAutoLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_nextABRAutoLevel",{get:function(){var e=this.hls,t=e.maxAutoLevel,n=e.levels,r=e.config,i=e.minAutoLevel,o=e.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=o?o.currentTime:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,d=(m.BufferHelper.bufferInfo(o,l,r.maxBufferHole).end-l)/u,f=this._findBestLevel(a,s,c,i,t,d,r.abrBandWidthFactor,r.abrBandWidthUpFactor,n);if(0<=f)return f;v.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");e=s?Math.min(s,r.maxStarvationDelay):r.maxStarvationDelay,o=r.abrBandWidthFactor,l=r.abrBandWidthUpFactor;return 0!=d||(u=this.bitrateTestDelay)&&(e=(s?Math.min(s,r.maxLoadingDelay):r.maxLoadingDelay)-u,v.logger.trace("bitrate test took "+Math.round(1e3*u)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*e)+" ms"),o=l=1),f=this._findBestLevel(a,s,c,i,t,d+e,o,l,n),Math.max(f,0)},enumerable:!0,configurable:!0}),s.prototype._findBestLevel=function(e,t,n,r,i,o,a,s,l){for(var u=i;r<=u;u--){var c=l[u];if(c){var d=c.details,f=d?d.totalduration/d.fragments.length:t,h=!!d&&d.live,p=u<=e?a*n:s*n,c=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,d=c*f/p;if(v.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+c+"/"+f+"/"+o+"/"+d),c<p&&(!d||h&&!this.bitrateTestDelay||d<o))return u}}return-1},s);function s(e){var t=n.call(this,e,g.default.FRAG_LOADING,g.default.FRAG_LOADED,g.default.FRAG_BUFFERED,g.default.ERROR)||this;return t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=e,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(t),t}l.default=e}.call(this,u("./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":function(e,n,a){"use strict";!function(E){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i,k=a("./src/utils/binary-search.js"),A=a("./src/utils/buffer-helper.js"),c=a("./src/demux/demuxer.js"),S=a("./src/events.js"),l=a("./src/controller/level-helper.js"),o=a("./src/utils/time-ranges.js"),u=a("./src/errors.js"),w=a("./src/utils/logger.js"),T=a("./src/utils/discontinuities.js"),P=a("./src/controller/fragment-tracker.js"),d=a("./src/loader/fragment.js"),O=a("./src/controller/base-stream-controller.js"),L=window.performance,e=(i=O.default,e(t,i),t.prototype.onHandlerDestroying=function(){this.stopLoad(),i.prototype.onHandlerDestroying.call(this)},t.prototype.onHandlerDestroyed=function(){this.state=O.State.STOPPED,this.fragmentTracker=null,i.prototype.onHandlerDestroyed.call(this)},t.prototype.onInitPtsFound=function(e){var t=e.id,n=e.frag.cc,e=e.initPTS;"main"===t&&(this.initPTS[n]=e,this.videoTrackCC=n,w.logger.log("InitPTS for cc: "+n+" found from video track: "+e),this.state===O.State.WAITING_INIT_PTS&&this.tick())},t.prototype.startLoad=function(e){var t;this.tracks?(t=this.lastCurrentTime,this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===e?(w.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=O.State.IDLE):(this.lastCurrentTime=this.startPosition||e,this.state=O.State.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()):(this.startPosition=e,this.state=O.State.STOPPED)},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=O.State.STOPPED},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t;this.state!==e&&(t=this.state,this._state=e,w.logger.log("audio stream:"+t+"->"+e))},enumerable:!0,configurable:!0}),t.prototype.doTick=function(){var e,t,n,r=this.hls,i=r.config;switch(this.state){case O.State.ERROR:case O.State.PAUSED:case O.State.BUFFER_FLUSHING:break;case O.State.STARTING:this.state=O.State.WAITING_TRACK,this.loadedmetadata=!1;break;case O.State.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var a=this.mediaBuffer||this.media,s=this.videoBuffer||this.media,l=A.BufferHelper.bufferInfo(a,e,i.maxBufferHole),u=A.BufferHelper.bufferInfo(s,e,i.maxBufferHole),c=l.len,d=l.end,f=this.fragPrevious,h=Math.min(i.maxBufferLength,i.maxMaxBufferLength),p=Math.max(h,u.len),y=this.audioSwitch,s=this.trackId;if((c<p||y)&&s<o.length){if(void 0===(n=o[s].details)){this.state=O.State.WAITING_TRACK;break}if(!y&&this._streamEnded(l,n))return this.hls.trigger(S.default.BUFFER_EOS,{type:"audio"}),void(this.state=O.State.ENDED);var h=n.fragments,u=h.length,c=h[0].start,p=h[u-1].start+h[u-1].duration,g=void 0;if(y)if(n.live&&!n.PTSKnown)w.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),d=0;else if(d=e,n.PTSKnown&&e<c){if(!(l.end>c||l.nextStart))return;w.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=c+.05}if(n.initSegment&&!n.initSegment.data)g=n.initSegment;else if(d<=c){if(g=h[0],null!==this.videoTrackCC&&g.cc!==this.videoTrackCC&&(g=T.findFragWithCC(h,this.videoTrackCC)),n.live&&g.loadIdx&&g.loadIdx===this.fragLoadIdx){var m=l.nextStart||c;return w.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(m+.05)),void(this.media.currentTime=m+.05)}}else{var o=void 0,v=i.maxFragLookUpTolerance,l=f?h[f.sn-h[0].sn+1]:void 0,m=function(e){var t=Math.min(v,e.duration);return e.start+e.duration-t<=d?1:e.start-t>d&&e.start?-1:0};(o=d<p?(p-v<d&&(v=0),l&&!m(l)?l:k.default.search(h,m)):h[u-1])&&(c=(g=o).start,f&&g.level===f.level&&g.sn===f.sn&&(g.sn<n.endSN?(g=h[g.sn+1-n.startSN],w.logger.log("SN just loaded, load next one: "+g.sn)):g=null))}g&&(g.encrypted?(w.logger.log("Loading key for "+g.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.state=O.State.KEY_LOADING,r.trigger(S.default.KEY_LOADING,{frag:g})):(w.logger.log("Loading "+g.sn+", cc: "+g.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+s+", currentTime:"+e+",bufferEnd:"+d.toFixed(3)),this.fragCurrent=g,!y&&this.fragmentTracker.getState(g)!==P.FragmentState.NOT_LOADED||(this.startFragRequested=!0,E.isFinite(g.sn)&&(this.nextLoadPosition=g.start+g.duration),r.trigger(S.default.FRAG_LOADING,{frag:g}),this.state=O.State.FRAG_LOADING)))}break;case O.State.WAITING_TRACK:(t=this.tracks[this.trackId])&&t.details&&(this.state=O.State.IDLE);break;case O.State.FRAG_LOADING_WAITING_RETRY:var b=L.now(),g=this.retryDate,_=(a=this.media)&&a.seeking;(!g||g<=b||_)&&(w.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=O.State.IDLE);break;case O.State.WAITING_INIT_PTS:b=this.videoTrackCC;if(void 0===this.initPTS[b])break;var _=this.waitingFragment;_?b!==(_=_.frag.cc)?(t=this.tracks[this.trackId]).details&&t.details.live&&(w.logger.warn("Waiting fragment CC ("+_+") does not match video track CC ("+b+")"),this.waitingFragment=null,this.state=O.State.IDLE):(this.state=O.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null):this.state=O.State.IDLE;break;case O.State.STOPPED:case O.State.FRAG_LOADING:case O.State.PARSING:case O.State.PARSED:case O.State.ENDED:}},t.prototype.onMediaAttached=function(e){e=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);e=this.config;this.tracks&&e.autoStartLoad&&this.startLoad(e.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(w.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onAudioTracksUpdated=function(e){w.logger.log("audio tracks updated"),this.tracks=e.audioTracks},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=O.State.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=O.State.IDLE),this.tick()},t.prototype.onAudioTrackLoaded=function(e){var t=e.details,n=e.id,r=this.tracks[n],i=t.totalduration,e=0;w.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live?(i=r.details)&&0<t.fragments.length?(l.mergeDetails(i,t),e=t.fragments[0].start,t.PTSKnown?w.logger.log("live audio playlist sliding:"+e.toFixed(3)):w.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,w.logger.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1,r.details=t,this.startFragRequested||(-1===this.startPosition&&(t=t.startTimeOffset,E.isFinite(t)?(w.logger.log("start time offset found in playlist, adjust startPosition to "+t),this.startPosition=t):this.startPosition=0),this.nextLoadPosition=this.startPosition),this.state===O.State.WAITING_TRACK&&(this.state=O.State.IDLE),this.tick()},t.prototype.onKeyLoaded=function(){this.state===O.State.KEY_LOADING&&(this.state=O.State.IDLE,this.tick())},t.prototype.onFragLoaded=function(e){var t,n,r,i,o,a,s,l=this.fragCurrent,u=e.frag;this.state===O.State.FRAG_LOADING&&l&&"audio"===u.type&&u.level===l.level&&u.sn===l.sn&&(n=(t=(s=this.tracks[this.trackId]).details).totalduration,r=l.level,i=l.sn,o=l.cc,a=this.config.defaultAudioCodec||s.audioCodec||"mp4a.40.2",u=this.stats=e.stats,"initSegment"===i?(this.state=O.State.IDLE,u.tparsed=u.tbuffered=L.now(),t.initSegment.data=e.payload,this.hls.trigger(S.default.FRAG_BUFFERED,{stats:u,frag:l,id:"audio"}),this.tick()):(this.state=O.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new c.default(this.hls,"audio")),s=this.initPTS[o],u=t.initSegment?t.initSegment.data:[],t.initSegment||void 0!==s?(this.pendingBuffering=!0,w.logger.log("Demuxing "+i+" of ["+t.startSN+" ,"+t.endSN+"],track "+r),this.demuxer.push(e.payload,u,a,null,l,n,!1,s)):(w.logger.log("unknown video PTS for continuity counter "+o+", waiting for video PTS before demuxing audio frag "+i+" of ["+t.startSN+" ,"+t.endSN+"],track "+r),this.waitingFragment=e,this.state=O.State.WAITING_INIT_PTS))),this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===O.State.PARSING&&(n=void 0,(t=e.tracks).video&&delete t.video,(n=t.audio)&&(n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(S.default.BUFFER_CODECS,t),w.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]"),(n=n.initSegment)&&(n={type:"audio",data:n,parent:"audio",content:"initSegment"},this.audioSwitch?this.pendingData=[n]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(S.default.BUFFER_APPENDING,n))),this.tick()))},t.prototype.onFragParsingData=function(t){var n=this,e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&"audio"===t.type&&r.sn===e.sn&&r.level===e.level&&this.state===O.State.PARSING){var i=this.trackId,o=this.tracks[i],a=this.hls;E.isFinite(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),e.addElementaryStream(d.default.ElementaryStreamTypes.AUDIO),w.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),l.updateFragPTSDTS(o.details,e,t.startPTS,t.endPTS);var r=this.audioSwitch,o=this.media,e=!1;r&&o&&(o.readyState?(o=o.currentTime,w.logger.log("switching audio track : currentTime:"+o),o>=t.startPTS&&(w.logger.log("switching audio track : flushing all audio"),this.state=O.State.BUFFER_FLUSHING,a.trigger(S.default.BUFFER_FLUSHING,{startOffset:0,endOffset:E.POSITIVE_INFINITY,type:"audio"}),this.audioSwitch=!(e=!0),a.trigger(S.default.AUDIO_TRACK_SWITCHED,{id:i}))):(this.audioSwitch=!1,a.trigger(S.default.AUDIO_TRACK_SWITCHED,{id:i})));var s=this.pendingData;if(!s)return w.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void a.trigger(S.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&s.push({type:t.type,data:e,parent:"audio",content:"data"})}),!e&&s.length&&(s.forEach(function(e){n.state===O.State.PARSING&&(n.pendingBuffering=!0,n.hls.trigger(S.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===O.State.PARSING&&(this.stats.tparsed=L.now(),this.state=O.State.PARSED,this._checkAppendedParsed())},t.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},t.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},t.prototype.onBufferAppended=function(e){var t;"audio"===e.parent&&((t=this.state)!==O.State.PARSING&&t!==O.State.PARSED||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed()))},t.prototype._checkAppendedParsed=function(){var e,t,n;this.state!==O.State.PARSED||this.appended&&this.pendingBuffering||(n=this.fragCurrent,e=this.stats,t=this.hls,n&&(this.fragPrevious=n,e.tbuffered=L.now(),t.trigger(S.default.FRAG_BUFFERED,{stats:e,frag:n,id:"audio"}),n=this.mediaBuffer||this.media,w.logger.log("audio buffered : "+o.default.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,t.trigger(S.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=O.State.IDLE),this.tick())},t.prototype.onError=function(e){var t,n=e.frag;if(!n||"audio"===n.type)switch(e.details){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:var r,i,o=e.frag;if(o&&"audio"!==o.type)break;e.fatal||((r=this.fragLoadError)?r++:r=1,r<=(t=this.config).fragLoadingMaxRetry?(this.fragLoadError=r,i=Math.min(Math.pow(2,r-1)*t.fragLoadingRetryDelay,t.fragLoadingMaxRetryTimeout),w.logger.warn("AudioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=L.now()+i,this.state=O.State.FRAG_LOADING_WAITING_RETRY):(w.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=O.State.ERROR));break;case u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case u.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==O.State.ERROR&&(this.state=e.fatal?O.State.ERROR:O.State.IDLE,w.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case u.ErrorDetails.BUFFER_FULL_ERROR:"audio"!==e.parent||this.state!==O.State.PARSING&&this.state!==O.State.PARSED||(r=this.mediaBuffer,i=this.media.currentTime,r&&A.BufferHelper.isBuffered(r,i)&&A.BufferHelper.isBuffered(r,i+.5)?((t=this.config).maxMaxBufferLength>=t.maxBufferLength&&(t.maxMaxBufferLength/=2,w.logger.warn("AudioStreamController: reduce max buffer length to "+t.maxMaxBufferLength+"s")),this.state=O.State.IDLE):(w.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=O.State.BUFFER_FLUSHING,this.hls.trigger(S.default.BUFFER_FLUSHING,{startOffset:0,endOffset:E.POSITIVE_INFINITY,type:"audio"})))}},t.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(w.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach(function(e){t.hls.trigger(S.default.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=O.State.PARSED):(this.state=O.State.IDLE,this.fragPrevious=null,this.tick())},t);function t(e,t){var n=i.call(this,e,S.default.MEDIA_ATTACHED,S.default.MEDIA_DETACHING,S.default.AUDIO_TRACKS_UPDATED,S.default.AUDIO_TRACK_SWITCHING,S.default.AUDIO_TRACK_LOADED,S.default.KEY_LOADED,S.default.FRAG_LOADED,S.default.FRAG_PARSING_INIT_SEGMENT,S.default.FRAG_PARSING_DATA,S.default.FRAG_PARSED,S.default.ERROR,S.default.BUFFER_RESET,S.default.BUFFER_CREATED,S.default.BUFFER_APPENDED,S.default.BUFFER_FLUSHED,S.default.INIT_PTS_FOUND)||this;return n.fragmentTracker=t,n.config=e.config,n.audioCodecSwap=!1,n._state=O.State.STOPPED,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}n.default=e}.call(this,a("./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n("./src/events.js"),s=n("./src/task-loop.js"),l=n("./src/utils/logger.js"),u=n("./src/errors.js"),i=(o=s.default,i(c,o),c.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},c.prototype.onManifestParsed=function(e){e=this.tracks=e.audioTracks||[];this.hls.trigger(a.default.AUDIO_TRACKS_UPDATED,{audioTracks:e})},c.prototype.onAudioTrackLoaded=function(e){var t;e.id>=this.tracks.length?l.logger.warn("Invalid audio track id:",e.id):(l.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()&&(t=1e3*e.details.targetduration,this.setInterval(t)),!e.details.live&&this.hasInterval()&&this.clearInterval())},c.prototype.onAudioTrackSwitched=function(e){e=this.tracks[e.id].groupId;e&&this.audioGroupId!==e&&(this.audioGroupId=e)},c.prototype.onLevelLoaded=function(e){var e=this.hls.levels[e.level];e.audioGroupIds&&(e=e.audioGroupIds[e.urlId],this.audioGroupId!==e&&(this.audioGroupId=e,this._selectInitialAudioTrack()))},c.prototype.onError=function(e){e.type===u.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(l.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Object.defineProperty(c.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"audioTrack",{get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),c.prototype._setAudioTrack=function(e){var t,n,r;this._trackId===e&&this.tracks[this._trackId].details?l.logger.debug("Same id as current audio-track passed, and track details available -> no-op"):e<0||e>=this.tracks.length?l.logger.warn("Invalid id passed to audio-track controller"):(t=this.tracks[e],l.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e,n=t.url,r=t.type,e=t.id,this.hls.trigger(a.default.AUDIO_TRACK_SWITCHING,{id:e,type:r,url:n}),this._loadTrackDetailsIfNeeded(t))},c.prototype.doTick=function(){this._updateTrack(this._trackId)},c.prototype._selectInitialAudioTrack=function(){var e,t,n,r,i=this,o=this.tracks;o.length&&(e=this.tracks[this._trackId],t=null,e&&(t=e.name),this._selectDefaultTrack&&((r=o.filter(function(e){return e.default})).length?o=r:l.logger.warn("No default audio tracks defined")),n=!1,(r=function(){o.forEach(function(e){n||i.audioGroupId&&e.groupId!==i.audioGroupId||t&&t!==e.name||(i._setAudioTrack(e.id),n=!0)})})(),n||(t=null,r()),n||(l.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0})))},c.prototype._needsTrackLoading=function(e){var t=e.details,e=e.url;return!(t&&!t.live||!e)},c.prototype._loadTrackDetailsIfNeeded=function(e){var t;this._needsTrackLoading(e)&&(t=e.url,e=e.id,l.logger.log("loading audio-track playlist for id: "+e),this.hls.trigger(a.default.AUDIO_TRACK_LOADING,{url:t,id:e}))},c.prototype._updateTrack=function(e){e<0||e>=this.tracks.length||(this.clearInterval(),this._trackId=e,l.logger.log("trying to update audio-track "+e),e=this.tracks[e],this._loadTrackDetailsIfNeeded(e))},c.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],n=t.name,r=t.language,t=t.groupId;l.logger.warn("Loading failed on audio track id: "+e+", group-id: "+t+', name/language: "'+n+'" / "'+r+'"');for(var i=e,o=0;o<this.tracks.length;o++)if(!this.trackIdBlacklist[o]&&this.tracks[o].name===n){i=o;break}i!==e?(l.logger.log("Attempting audio-track fallback id:",i,"group-id:",this.tracks[i].groupId),this._setAudioTrack(i)):l.logger.warn('No fallback audio-track found for name/language: "'+n+'" / "'+r+'"')},c);function c(e){e=o.call(this,e,a.default.MANIFEST_LOADING,a.default.MANIFEST_PARSED,a.default.AUDIO_TRACK_LOADED,a.default.AUDIO_TRACK_SWITCHED,a.default.LEVEL_LOADED,a.default.ERROR)||this;return e._trackId=-1,e._selectDefaultTrack=!0,e.tracks=[],e.trackIdBlacklist=Object.create(null),e.audioGroupId=null,e}t.default=i},"./src/controller/base-stream-controller.js":function(e,c,a){"use strict";!function(s){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(c,"__esModule",{value:!0});var t=a("./src/task-loop.js"),i=a("./src/controller/fragment-tracker.js"),l=a("./src/utils/buffer-helper.js"),u=a("./src/utils/logger.js");c.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var n,e=(n=t.default,e(o,n),o.prototype.doTick=function(){},o.prototype._streamEnded=function(e,t){var n=this.fragCurrent,r=this.fragmentTracker;if(t.live||!n||n.backtracked||n.sn!==t.endSN||e.nextStart)return!1;n=r.getState(n);return n===i.FragmentState.PARTIAL||n===i.FragmentState.OK},o.prototype.onMediaSeeking=function(){var e,t=this.config,n=this.media,r=this.mediaBuffer,i=this.state,o=n?n.currentTime:null,a=l.BufferHelper.bufferInfo(r||n,o,this.config.maxBufferHole);s.isFinite(o)&&u.logger.log("media seeking to "+o.toFixed(3)),i===c.State.FRAG_LOADING?(e=this.fragCurrent,0===a.len&&e&&(r=t.maxFragLookUpTolerance,t=e.start-r,r=e.start+e.duration+r,o<t||r<o?(e.loader&&(u.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=c.State.IDLE):u.logger.log("seeking outside of buffer but within currently loaded fragment range"))):i===c.State.ENDED&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=c.State.IDLE),n&&(this.lastCurrentTime=o),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=o),this.tick()},o.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},o);function o(){return null!==n&&n.apply(this,arguments)||this}c.default=e}.call(this,a("./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":function(e,s,d){"use strict";!function(r){var i,e=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(s,"__esModule",{value:!0});var t,l=d("./src/events.js"),n=d("./src/event-handler.js"),u=d("./src/utils/logger.js"),c=d("./src/errors.js"),o=d("./src/utils/mediasource-helper.js").getMediaSource(),e=(t=n.default,e(a,t),a.prototype.destroy=function(){n.default.prototype.destroy.call(this)},a.prototype.onLevelPtsUpdated=function(e){var t=e.type,n=this.tracks.audio;if("audio"===t&&n&&"audio/mpeg"===n.container){t=this.sourceBuffer.audio;if(.1<Math.abs(t.timestampOffset-e.start)){n=t.updating;try{t.abort()}catch(e){u.logger.warn("can not abort audio buffer: "+e)}n?this.audioTimestampOffset=e.start:(u.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+e.start),t.timestampOffset=e.start)}}},a.prototype.onManifestParsed=function(e){this.bufferCodecEventsExpected=e.altAudio?2:1,u.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},a.prototype.onMediaAttaching=function(e){var t=this.media=e.media;t&&(e=this.mediaSource=new o,this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),e.addEventListener("sourceopen",this.onmso),e.addEventListener("sourceended",this.onmse),e.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(e),this._objectUrl=t.src)},a.prototype.onMediaDetaching=function(){u.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){u.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l.default.MEDIA_DETACHED)},a.prototype.onMediaSourceOpen=function(){u.logger.log("media source opened"),this.hls.trigger(l.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},a.prototype.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,n=Object.keys(t).length;(n&&!e||2===n)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},a.prototype.onMediaSourceClose=function(){u.logger.log("media source closed")},a.prototype.onMediaSourceEnded=function(){u.logger.log("media source ended")},a.prototype.onSBUpdateEnd=function(){this.audioTimestampOffset&&(t=this.sourceBuffer.audio,u.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset),t.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset),this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var e,n=this.parent,t=this.segments.reduce(function(e,t){return t.parent===n?e+1:e},0),r={},i=this.sourceBuffer;for(e in i)r[e]=i[e].buffered;this.hls.trigger(l.default.BUFFER_APPENDED,{parent:n,pending:t,timeRanges:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration(),0===t&&this.flushLiveBackBuffer()},a.prototype.onSBUpdateError=function(e){u.logger.error("sourceBuffer error:",e),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},a.prototype.onBufferReset=function(){var e,t=this.sourceBuffer;for(e in t){var n=t[e];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},a.prototype.onBufferCodecs=function(t){var e,n=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach(function(e){n.pendingTracks[e]=t[e]}),e=this.mediaSource,this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),e&&"open"===e.readyState&&this.checkPendingTracks())},a.prototype.createSourceBuffers=function(e){var t,n=this.sourceBuffer,r=this.mediaSource;for(t in e)if(!n[t]){var i=e[t],o=i.levelCodec||i.codec,a=i.container+";codecs="+o;u.logger.log("creating sourceBuffer("+a+")");try{var s=n[t]=r.addSourceBuffer(a);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[t]={codec:o,container:i.container},i.buffer=s}catch(e){u.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:a})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:e})},a.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},a.prototype.onBufferAppendFail=function(e){u.logger.error("sourceBuffer error:",e.event),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},a.prototype.onBufferEos=function(e){var t,n=this.sourceBuffer,r=e.type;for(t in n)r&&t!==r||n[t].ended||(n[t].ended=!0,u.logger.log(t+" sourceBuffer now EOS"));this.checkEos()},a.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var n in e){n=e[n];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}u.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){u.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},a.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},a.prototype.flushLiveBackBuffer=function(){if(this._live){var e=this.hls.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))for(var t=this.media.currentTime,n=this.sourceBuffer,r=Object.keys(n),i=t-Math.max(e,this._levelTargetDuration),o=r.length-1;0<=o;o--){var a=r[o],s=n[a].buffered;0<s.length&&i>s.start(0)&&this.removeBufferRange(a,n[a],0,i)}}},a.prototype.onLevelUpdated=function(e){e=e.details;0<e.fragments.length&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._levelTargetDuration=e.averagetargetduration||e.targetduration||10,this._live=e.live,this.updateMediaElementDuration())},a.prototype.updateMediaElementDuration=function(){var e,t=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var n in this.sourceBuffer)if(!0===this.sourceBuffer[n].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(u.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!r.isFinite(e))&&(u.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},a.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;try{for(var r in n)t+=n[r].buffered.length}catch(e){u.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.default.BUFFER_FLUSHED)}},a.prototype.doAppending=function(){var e=this.hls,t=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(this.media.error)return this.segments=[],void u.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending&&(t&&t.length)){var r=t.shift();try{var i=n[r.type];i?i.updating?t.unshift(r):(i.ended=!1,this.parent=r.parent,i.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(n){u.logger.error("error while trying to append buffer:"+n.message),t.unshift(r);r={type:c.ErrorTypes.MEDIA_ERROR,parent:r.parent};22!==n.code?(this.appendError?this.appendError++:this.appendError=1,r.details=c.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(u.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],r.fatal=!0):r.fatal=!1):(this.segments=[],r.details=c.ErrorDetails.BUFFER_FULL_ERROR,r.fatal=!1),e.trigger(l.default.ERROR,r)}}}},a.prototype.flushBuffer=function(e,t,n){var r,i=this.sourceBuffer;if(Object.keys(i).length){if(u.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var o in i)if(!n||o===n){if((r=i[o]).ended=!1,r.updating)return u.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(o,r,e,t))return this.flushBufferCounter++,!1}}else u.logger.warn("abort flushing too many retries");u.logger.log("buffer flushed")}return!0},a.prototype.removeBufferRange=function(e,t,n,r){try{for(var i=0;i<t.buffered.length;i++){var o=t.buffered.start(i),a=t.buffered.end(i),s=Math.max(o,n),l=Math.min(a,r);if(.5<Math.min(l,a)-s)return u.logger.log("sb remove "+e+" ["+s+","+l+"], of ["+o+","+a+"], pos:"+this.media.currentTime),t.remove(s,l),!0}}catch(e){u.logger.warn("removeBufferRange failed",e)}return!1},a);function a(e){e=t.call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED)||this;return e._msDuration=null,e._levelDuration=null,e._levelTargetDuration=10,e._live=null,e._objectUrl=null,e.bufferCodecEventsExpected=0,e.onsbue=e.onSBUpdateEnd.bind(e),e.onsbe=e.onSBUpdateError.bind(e),e.pendingTracks={},e.tracks={},e}s.default=e}.call(this,d("./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":function(e,a,s){"use strict";!function(t){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(a,"__esModule",{value:!0});var n,i=s("./src/events.js"),e=(n=s("./src/event-handler.js").default,e(o,n),o.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},o.prototype.onFpsDropLevelCapping=function(e){o.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this._startCapping()},o.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},o.prototype.onLevelsUpdated=function(e){this.levels=e.levels},o.prototype.onMediaDetaching=function(){this._stopCapping()},o.prototype.detectPlayerSize=function(){var e,t;!this.media||(e=this.levels?this.levels.length:0)&&((t=this.hls).autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping)},o.prototype.getMaxLevel=function(n){var r=this;if(!this.levels)return-1;var e=this.levels.filter(function(e,t){return o.isLevelAllowed(t,r.restrictedLevels)&&t<=n});return o.getMaxLevelByMediaSize(e,this.mediaWidth,this.mediaHeight)},o.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=t.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=t.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(o.prototype,"mediaWidth",{get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=o.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"mediaHeight",{get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=o.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(o,"contentScaleFactor",{get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e},enumerable:!0,configurable:!0}),o.isLevelAllowed=function(e,t){return-1===(t=void 0===t?[]:t).indexOf(e)},o.getMaxLevelByMediaSize=function(e,t,n){if(!e||!e.length)return-1;for(var r,i=e.length-1,o=0;o<e.length;o+=1){var a=e[o];if((a.width>=t||a.height>=n)&&(!(r=e[o+1])||a.width!==r.width||a.height!==r.height)){i=o;break}}return i},o);function o(e){e=n.call(this,e,i.default.FPS_DROP_LEVEL_CAPPING,i.default.MEDIA_ATTACHING,i.default.MANIFEST_PARSED,i.default.BUFFER_CODECS,i.default.MEDIA_DETACHING)||this;return e.autoLevelCapping=t.POSITIVE_INFINITY,e.firstLevel=null,e.levels=[],e.media=null,e.restrictedLevels=[],e.timer=null,e}a.default=e}.call(this,s("./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n("./src/event-handler.js"),s=n("./src/events.js"),l=n("./src/errors.js"),u=n("./src/utils/logger.js"),c=window.XMLHttpRequest,d="com.widevine.alpha",i=(o=a.default,i(f,o),f.prototype.getLicenseServerUrl=function(e){var t=e===d?this._widevineLicenseUrl:null;return t||(u.logger.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},f.prototype._attemptKeySystemAccess=function(t,e,n){var r=this,n=function(e,t){if(e!==d)throw Error("Unknown key-system: "+e);return n={videoCapabilities:[]},t.forEach(function(e){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[n];var n}(t,n);n?(u.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,n).then(function(e){r._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){u.logger.error('Failed to obtain key-system "'+t+'" access:',e)})):u.logger.warn("Can not create config for key-system (maybe because platform is not supported):",t)},Object.defineProperty(f.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),f.prototype._onMediaKeySystemAccessObtained=function(t,e){var n=this;u.logger.log('Access for key-system "'+t+'" obtained');var r={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(r),e.createMediaKeys().then(function(e){r.mediaKeys=e,u.logger.log('Media-keys created for key-system "'+t+'"'),n._onMediaKeysCreated()}).catch(function(e){u.logger.error("Failed to create media-keys:",e)})},f.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},f.prototype._onNewMediaKeySession=function(t){var n=this;u.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(e){n._onKeySessionMessage(t,e.message)},!1)},f.prototype._onKeySessionMessage=function(t,e){u.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){u.logger.log("Received license data, updating key-session"),t.update(e)})},f.prototype._onMediaEncrypted=function(e,t){u.logger.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},f.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return u.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});u.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},f.prototype._generateRequestWithPreferredKeySession=function(){var e,t,n,r=this,i=this._mediaKeysList[0];if(!i)return u.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});i.mediaKeysSessionInitialized?u.logger.warn("Key-Session already initialized but requested again"):((e=i.mediaKeysSession)||(u.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0})),t=this._mediaEncryptionInitDataType,n=this._mediaEncryptionInitData,u.logger.log('Generating key-session request for "'+t+'" init data type'),i.mediaKeysSessionInitialized=!0,e.generateRequest(t,n).then(function(){u.logger.debug("Key-session generation succeeded")}).catch(function(e){u.logger.error("Error generating key-session request:",e),r.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))},f.prototype._createLicenseXhr=function(e,t,n){var r=new c,i=this._licenseXhrSetup;try{if(i)try{i(r,e)}catch(t){r.open("POST",e,!0),i(r,e)}r.readyState||r.open("POST",e,!0)}catch(e){return u.logger.error("Error setting up key-system license XHR",e),void this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,n),r},f.prototype._onLicenseRequestReadyStageChange=function(e,t,n,r){if(4===e.readyState)if(200===e.status)this._requestLicenseFailureCount=0,u.logger.log("License request succeeded"),r(e.response);else{if(u.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){e=3-this._requestLicenseFailureCount+1;return u.logger.warn("Retrying license request, "+e+" attempts left"),void this._requestLicense(n,r)}this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},f.prototype._generateLicenseRequestChallenge=function(e,t){var n;return"com.microsoft.playready"===e.mediaKeySystemDomain?u.logger.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===d?n=t:u.logger.error("Unsupported key-system:",e.mediaKeySystemDomain),n},f.prototype._requestLicense=function(e,t){u.logger.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return u.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var r=this.getLicenseServerUrl(n.mediaKeySystemDomain),t=this._createLicenseXhr(r,e,t);u.logger.log("Sending license request to URL: "+r),t.send(this._generateLicenseRequestChallenge(n,e))},f.prototype.onMediaAttached=function(e){var t=this;this._emeEnabled&&(e=e.media,(this._media=e).addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)}))},f.prototype.onManifestParsed=function(e){var t;this._emeEnabled&&(t=e.levels.map(function(e){return e.audioCodec}),e=e.levels.map(function(e){return e.videoCodec}),this._attemptKeySystemAccess(d,t,e))},f);function f(e){var t=o.call(this,e,s.default.MEDIA_ATTACHED,s.default.MANIFEST_PARSED)||this;return t._widevineLicenseUrl=e.config.widevineLicenseUrl,t._licenseXhrSetup=e.config.licenseXhrSetup,t._emeEnabled=e.config.emeEnabled,t._requestMediaKeySystemAccess=e.config.requestMediaKeySystemAccessFunc,t._mediaKeysList=[],t._media=null,t._hasSetMediaKeys=!1,t._isMediaEncrypted=!1,t._requestLicenseFailureCount=0,t}t.default=i},"./src/controller/fps-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,l=n("./src/events.js"),a=n("./src/event-handler.js"),u=n("./src/utils/logger.js"),c=window.performance,i=(o=a.default,i(s,o),s.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},s.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},s.prototype.checkFPS=function(e,t,n){var r,i,o,a,s=c.now();t&&(this.lastTime&&(o=s-this.lastTime,r=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,i=1e3*r/o,(o=this.hls).trigger(l.default.FPS_DROP,{currentDropped:r,currentDecoded:a,totalDroppedFrames:n}),0<i&&r>o.config.fpsDroppedMonitoringThreshold*a&&(a=o.currentLevel,u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+a),0<a&&(-1===o.autoLevelCapping||o.autoLevelCapping>=a)&&(o.trigger(l.default.FPS_DROP_LEVEL_CAPPING,{level:--a,droppedLevel:o.currentLevel}),o.autoLevelCapping=a,o.streamController.nextLevelSwitch()))),this.lastTime=s,this.lastDroppedFrames=n,this.lastDecodedFrames=t)},s.prototype.checkFPSInterval=function(){var e,t=this.video;t&&(this.isVideoPlaybackQualityAvailable?(e=t.getVideoPlaybackQuality(),this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)):this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount))},s);function s(e){return o.call(this,e,l.default.MEDIA_ATTACHING)||this}t.default=i},"./src/controller/fragment-finders.js":function(e,t,n){"use strict";!function(o){Object.defineProperty(t,"__esModule",{value:!0});var i=n("./src/utils/binary-search.js");function a(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0);t=Math.min(t,n.duration+(n.deltaPTS||0));return n.start+n.duration-t<=e?1:n.start-t>e&&n.start?-1:0}function s(e,t,n){t=1e3*Math.min(t,n.duration+(n.deltaPTS||0));return n.endProgramDateTime-t>e}t.findFragmentByPDT=function(e,t,n){if(!Array.isArray(e)||!e.length||!o.isFinite(t))return null;if(t<e[0].programDateTime)return null;if(t>=e[e.length-1].endProgramDateTime)return null;n=n||0;for(var r=0;r<e.length;++r){var i=e[r];if(s(t,n,i))return i}return null},t.findFragmentByPTS=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);e=e?t[e.sn-t[0].sn+1]:null;return e&&!a(n,r,e)?e:i.default.search(t,a.bind(null,n,r))},t.fragmentWithinToleranceTest=a,t.pdtWithinToleranceTest=s}.call(this,n("./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":function(e,s,l){"use strict";!function(t){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(s,"__esModule",{value:!0});var n=l("./src/event-handler.js"),i=l("./src/events.js");s.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var o,e=(o=n.default,e(a,o),a.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,n.default.prototype.destroy.call(this),o.prototype.destroy.call(this)},a.prototype.getBufferedFrag=function(t,n){var r=this.fragments,e=Object.keys(r).filter(function(e){e=r[e];if(e.body.type!==n)return!1;if(!e.buffered)return!1;e=e.body;return e.startPTS<=t&&t<=e.endPTS});if(0===e.length)return null;e=e.pop();return r[e].body},a.prototype.detectEvictedFragments=function(r,i){var o,a,s=this;Object.keys(this.fragments).forEach(function(e){var t=s.fragments[e];if(!0===t.buffered){e=t.range[r];if(e){o=e.time;for(var n=0;n<o.length;n++)if(a=o[n],!1===s.isTimeBuffered(a.startPTS,a.endPTS,i)){s.removeFragment(t.body);break}}}})},a.prototype.detectPartialFragments=function(n){var r=this,e=this.getFragmentKey(n),i=this.fragments[e];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(e){var t;n.hasElementaryStream(e)&&(t=r.timeRanges[e],i.range[e]=r.getBufferedTimes(n.startPTS,n.endPTS,t))}))},a.prototype.getBufferedTimes=function(e,t,n){for(var r,i,o=[],a=!1,s=0;s<n.length;s++){if(r=n.start(s)-this.bufferPadding,i=n.end(s)+this.bufferPadding,r<=e&&t<=i){o.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))});break}if(e<i&&r<t)o.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))}),a=!0;else if(t<=r)break}return{time:o,partial:a}},a.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},a.prototype.getPartialFragment=function(t){var n,r,i=this,o=null,a=0;return Object.keys(this.fragments).forEach(function(e){e=i.fragments[e];i.isPartial(e)&&(n=e.body.startPTS-i.bufferPadding,r=e.body.endPTS+i.bufferPadding,n<=t&&t<=r&&(r=Math.min(t-n,r-t),a<=r&&(o=e.body,a=r)))}),o},a.prototype.getState=function(e){var t=this.getFragmentKey(e),e=this.fragments[t],t=s.FragmentState.NOT_LOADED;return t=void 0!==e?e.buffered?!0===this.isPartial(e)?s.FragmentState.PARTIAL:s.FragmentState.OK:s.FragmentState.APPENDING:t},a.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},a.prototype.isTimeBuffered=function(e,t,n){for(var r,i,o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,i=n.end(o)+this.bufferPadding,r<=e&&t<=i)return!0;if(t<=r)return!1}return!1},a.prototype.onFragLoaded=function(e){e=e.frag;t.isFinite(e.sn)&&!e.bitrateTest&&(this.fragments[this.getFragmentKey(e)]={body:e,range:Object.create(null),buffered:!1})},a.prototype.onBufferAppended=function(e){var n=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var t=n.timeRanges[e];n.detectEvictedFragments(e,t)})},a.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},a.prototype.hasFragment=function(e){e=this.getFragmentKey(e);return void 0!==this.fragments[e]},a.prototype.removeFragment=function(e){e=this.getFragmentKey(e);delete this.fragments[e]},a.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},a);function a(e){var t=o.call(this,e,i.default.BUFFER_APPENDED,i.default.FRAG_BUFFERED,i.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}s.FragmentTracker=e}.call(this,l("./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./src/utils/buffer-helper.js"),s=n("./src/errors.js"),l=n("./src/events.js"),u=n("./src/utils/logger.js"),n=(r.prototype.poll=function(e,t){var n=this.config,r=this.media,i=r.currentTime,o=window.performance.now();if(i!==e)return this.stallReported&&(u.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(o-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);r.ended||!r.buffered.length||2<r.readyState||r.seeking&&a.BufferHelper.isBuffered(r,i)||(e=o-this.stalled,n=a.BufferHelper.bufferInfo(r,i,n.maxBufferHole),this.stalled?(1e3<=e&&this._reportStall(n.len),this._tryFixBufferStall(n,e)):this.stalled=o)},r.prototype._tryFixBufferStall=function(e,t){var n=this.config,r=this.fragmentTracker,i=this.media.currentTime,i=r.getPartialFragment(i);i&&this._trySkipBufferHole(i),.5<e.len&&t>1e3*n.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},r.prototype._reportStall=function(e){var t=this.hls,n=this.media;this.stallReported||(this.stallReported=!0,u.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer"),t.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},r.prototype._trySkipBufferHole=function(e){for(var t=this.hls,n=this.media,r=n.currentTime,i=0,o=0;o<n.buffered.length;o++){var a=n.buffered.start(o);if(i<=r&&r<a)return n.currentTime=Math.max(a,n.currentTime+.1),u.logger.warn("skipping hole, adjusting currentTime from "+r+" to "+n.currentTime),this.stalled=null,void t.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+r+" to "+n.currentTime,frag:e});i=n.buffered.end(o)}},r.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,n=this.media,r=n.currentTime,i=(this.nudgeRetry||0)+1;(this.nudgeRetry=i)<e.nudgeMaxRetry?(i=r+i*e.nudgeOffset,u.logger.log("adjust currentTime from "+r+" to "+i),n.currentTime=i,t.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(u.logger.error("still stuck in high buffer @"+r+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0}))},r);function r(e,t,n,r){this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r,this.stallReported=!1}t.default=n},"./src/controller/id3-track-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n("./src/events.js"),s=n("./src/event-handler.js"),d=n("./src/demux/id3.js"),l=n("./src/utils/texttrack-utils.js"),i=(o=s.default,i(u,o),u.prototype.destroy=function(){s.default.prototype.destroy.call(this)},u.prototype.onMediaAttached=function(e){this.media=e.media,this.media},u.prototype.onMediaDetaching=function(){l.clearCurrentCues(this.id3Track),this.id3Track=void 0,this.media=void 0},u.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return l.sendAddTrackEvent(n,this.media),n}return this.media.addTextTrack("metadata","id3")},u.prototype.onFragParsingMetadata=function(e){var t=e.frag,n=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<n.length;i++){var o=d.default.getID3Frames(n[i].data);if(o){var a=n[i].pts,s=i<n.length-1?n[i+1].pts:t.endPTS;a===s&&(s+=1e-4);for(var l=0;l<o.length;l++){var u,c=o[l];d.default.isTimeStampFrame(c)||((u=new r(a,s,"")).value=c,this.id3Track.addCue(u))}}}},u);function u(e){e=o.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA)||this;return e.id3Track=void 0,e.media=void 0,e}t.default=i},"./src/controller/level-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var u,o,c=n("./src/events.js"),a=n("./src/event-handler.js"),d=n("./src/utils/logger.js"),f=n("./src/errors.js"),h=n("./src/utils/codecs.js"),p=n("./src/controller/level-helper.js"),s=window.performance,i=(o=a.default,i(l,o),l.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},l.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},l.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},l.prototype.stopLoad=function(){this.canload=!1},l.prototype.onManifestLoaded=function(e){var t,n=[],r=[],i={},o=null,a=!1,s=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,a=a||!!e.videoCodec,s=s||!!e.audioCodec,u&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(o=i[e.bitrate])?o.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,n.push(e)),t&&(t.AUDIO&&(s=!0,p.addGroupId(o||e,"audio",t.AUDIO)),t.SUBTITLES&&p.addGroupId(o||e,"text",t.SUBTITLES))}),n=(n=a&&s?n.filter(function(e){return!!e.videoCodec}):n).filter(function(e){var t=e.audioCodec,e=e.videoCodec;return(!t||h.isCodecSupportedInMp4(t,"audio"))&&(!e||h.isCodecSupportedInMp4(e,"video"))}),e.audioTracks&&(r=e.audioTracks.filter(function(e){return!e.audioCodec||h.isCodecSupportedInMp4(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),0<n.length){t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n;for(var l=0;l<n.length;l++)if(n[l].bitrate===t){this._firstLevel=l,d.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(c.default.MANIFEST_PARSED,{levels:n,audioTracks:r,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:a,altAudio:r.some(function(e){return!!e.url})})}else this.hls.trigger(c.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(l.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))},enumerable:!0,configurable:!0}),l.prototype.setLevelInternal=function(e){var t,n=this._levels,r=this.hls;0<=e&&e<n.length?(this.clearTimer(),this.currentLevelIndex!==e&&(d.logger.log("switching to level "+e),(t=n[this.currentLevelIndex=e]).level=e,r.trigger(c.default.LEVEL_SWITCHING,t)),(n=(t=n[e]).details)&&!n.live||(n=t.urlId,r.trigger(c.default.LEVEL_LOADING,{url:t.url[n],level:e,id:n}))):r.trigger(c.default.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(l.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(e){this._firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"startLevel",{get:function(){if(void 0!==this._startLevel)return this._startLevel;var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel},set:function(e){this._startLevel=e},enumerable:!0,configurable:!0}),l.prototype.onError=function(e){if(e.fatal)e.type===f.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,n=!1,r=!1;switch(e.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,r=!0;break;case f.ErrorDetails.LEVEL_LOAD_ERROR:case f.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,n=!0;break;case f.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,n=!0}void 0!==t&&this.recoverLevel(e,t,n,r)}},l.prototype.recoverLevel=function(e,t,n,r){var i=this,o=this.hls.config,a=e.details,s=this._levels[t];if(s.loadError++,s.fragmentError=r,n){if(!(this.levelRetryCount+1<=o.levelLoadingMaxRetry))return d.logger.error("level controller, cannot recover from "+a+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);o=Math.min(Math.pow(2,this.levelRetryCount)*o.levelLoadingRetryDelay,o.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return i.loadLevel()},o),e.levelRetry=!0,this.levelRetryCount++,d.logger.warn("level controller, "+a+", retry in "+o+" ms, current retry count is "+this.levelRetryCount)}(n||r)&&(1<(n=s.url.length)&&s.loadError<n?(s.urlId=(s.urlId+1)%n,s.details=void 0,d.logger.warn("level controller, "+a+" for level "+t+": switching to redundant URL-id "+s.urlId)):-1===this.manualLevelIndex?(t=0===t?this._levels.length-1:t-1,d.logger.warn("level controller, "+a+": switch to "+t),this.hls.nextAutoLevel=this.currentLevelIndex=t):r&&(d.logger.warn("level controller, "+a+": reload a fragment"),this.currentLevelIndex=null))},l.prototype.onFragLoaded=function(e){var e=e.frag;void 0===e||"main"!==e.type||void 0!==(e=this._levels[e.level])&&(e.fragmentError=!1,e.loadError=0,this.levelRetryCount=0)},l.prototype.onLevelLoaded=function(e){var t,n,r,i=this,o=e.level;o===this.currentLevelIndex&&((r=this._levels[o]).fragmentError||(r.loadError=0,this.levelRetryCount=0),(t=e.details).live?(o=n=1e3*(t.averagetargetduration||t.targetduration),(r=r.details)&&t.endSN===r.endSN&&(o/=2,d.logger.log("same live playlist, reload twice faster")),o-=s.now()-e.stats.trequest,o=Math.max(n/2,Math.round(o)),d.logger.log("live playlist, reload in "+Math.round(o)+" ms"),this.timer=setTimeout(function(){return i.loadLevel()},o)):this.clearTimer())},l.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,n=this.hls.levels[this.currentLevelIndex];n&&n.audioGroupIds&&((e=n.audioGroupIds.findIndex(function(e){return e===t}))!==n.urlId&&(n.urlId=e,this.startLoad()))},l.prototype.loadLevel=function(){var e,t,n;d.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload&&"object"==typeof(n=this._levels[this.currentLevelIndex])&&0<n.url.length&&(e=this.currentLevelIndex,t=n.urlId,n=n.url[t],d.logger.log("Attempt loading level index "+e+" with URL-id "+t),this.hls.trigger(c.default.LEVEL_LOADING,{url:n,level:e,id:t}))},Object.defineProperty(l.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)},enumerable:!0,configurable:!0}),l);function l(e){e=o.call(this,e,c.default.MANIFEST_LOADED,c.default.LEVEL_LOADED,c.default.AUDIO_TRACK_SWITCHED,c.default.FRAG_LOADED,c.default.ERROR)||this;return e.canload=!1,e.currentLevelIndex=null,e.manualLevelIndex=-1,e.timer=null,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),e}t.default=i},"./src/controller/level-helper.js":function(e,t,n){"use strict";!function(h){Object.defineProperty(t,"__esModule",{value:!0});var p=n("./src/utils/logger.js");function c(e,t,n){var r=e[t],i=e[n],e=i.startPTS;h.isFinite(e)?t<n?(r.duration=e-r.start,r.duration<0&&p.logger.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(i.duration=r.start-e,i.duration<0&&p.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):i.start=t<n?r.start+r.duration:Math.max(r.start-i.duration,0)}function y(e,t,n,r,i,o){var a=n;h.isFinite(t.startPTS)&&(s=Math.abs(t.startPTS-n),h.isFinite(t.deltaPTS)?t.deltaPTS=Math.max(s,t.deltaPTS):t.deltaPTS=s,a=Math.max(n,t.startPTS),n=Math.min(n,t.startPTS),r=Math.max(r,t.endPTS),i=Math.min(i,t.startDTS),o=Math.max(o,t.endDTS));var s=n-t.start;t.start=t.startPTS=n,t.maxStartPTS=a,t.endPTS=r,t.startDTS=i,t.endDTS=o,t.duration=r-n;var l,u,n=t.sn;if(!e||n<e.startSN||n>e.endSN)return 0;for(n=n-e.startSN,(l=e.fragments)[n]=t,u=n;0<u;u--)c(l,u,u-1);for(u=n;u<l.length-1;u++)c(l,u,u+1);return e.PTSKnown=!0,s}t.addGroupId=function(e,t,n){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(n);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(n)}},t.updatePTS=c,t.updateFragPTSDTS=y,t.mergeDetails=function(e,t){var n,r=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,o=t.startSN-e.startSN,a=e.fragments,s=t.fragments,l=0;if(t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment),i<r)t.PTSKnown=!1;else{for(var u=r;u<=i;u++){var c=a[o+u],d=s[u];d&&c&&(l=c.cc-d.cc,h.isFinite(c.startPTS)&&(d.start=d.startPTS=c.startPTS,d.endPTS=c.endPTS,d.duration=c.duration,d.backtracked=c.backtracked,d.dropped=c.dropped,n=d))}if(l)for(p.logger.log("discontinuity sliding from playlist, take drift into account"),u=0;u<s.length;u++)s[u].cc+=l;if(n)y(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS);else if(0<=o&&o<a.length)for(var f=a[o].start,u=0;u<s.length;u++)s[u].start+=f;t.PTSKnown=e.PTSKnown}}}.call(this,n("./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":function(e,_,E){"use strict";!function(s){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(_,"__esModule",{value:!0});var i,d=E("./src/utils/binary-search.js"),l=E("./src/utils/buffer-helper.js"),u=E("./src/demux/demuxer.js"),c=E("./src/events.js"),n=E("./src/controller/fragment-tracker.js"),a=E("./src/loader/fragment.js"),t=E("./src/loader/playlist-loader.js"),f=E("./src/controller/level-helper.js"),o=E("./src/utils/time-ranges.js"),h=E("./src/errors.js"),p=E("./src/utils/logger.js"),y=E("./src/utils/discontinuities.js"),g=E("./src/controller/fragment-finders.js"),m=E("./src/controller/gap-controller.js"),v=E("./src/controller/base-stream-controller.js"),e=(i=v.default,e(b,i),b.prototype.onHandlerDestroying=function(){this.stopLoad(),i.prototype.onHandlerDestroying.call(this)},b.prototype.onHandlerDestroyed=function(){this.state=v.State.STOPPED,this.fragmentTracker=null,i.prototype.onHandlerDestroyed.call(this)},b.prototype.startLoad=function(e){var t,n,r;this.levels?(t=this.lastCurrentTime,n=this.hls,this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested||(-1===(r=n.startLevel)&&(this.bitrateTest=!(r=0)),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1),0<t&&-1===e&&(p.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=v.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()):(this.forceStartLoad=!0,this.state=v.State.STOPPED)},b.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=v.State.STOPPED,this.forceStartLoad=!1},b.prototype.doTick=function(){switch(this.state){case v.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case v.State.IDLE:this._doTickIdle();break;case v.State.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=v.State.IDLE);break;case v.State.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),e=this.retryDate;(!e||e<=t||this.media&&this.media.seeking)&&(p.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=v.State.IDLE);break;case v.State.ERROR:case v.State.STOPPED:case v.State.FRAG_LOADING:case v.State.PARSING:case v.State.PARSED:case v.State.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},b.prototype._doTickIdle=function(){var e=this.hls,t=e.config,n=this.media;if(void 0!==this.levelLastLoaded&&(n||!this.startFragRequested&&t.startFragPrefetch)){var r=this.loadedmetadata?n.currentTime:this.nextLoadPosition,i=e.nextLoadLevel,o=this.levels[i];if(o){var a=o.bitrate,a=a?Math.max(8*t.maxBufferSize/a,t.maxBufferLength):t.maxBufferLength;a=Math.min(a,t.maxMaxBufferLength);n=l.BufferHelper.bufferInfo(this.mediaBuffer||n,r,t.maxBufferHole),t=n.len;if(!(a<=t)){p.logger.trace("buffer length of "+t.toFixed(3)+" is below max of "+a.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;o=o.details;if(!o||o.live&&this.levelLastLoaded!==i)this.state=v.State.WAITING_LEVEL;else{if(this._streamEnded(n,o)){i={};return this.altAudio&&(i.type="video"),this.hls.trigger(c.default.BUFFER_EOS,i),void(this.state=v.State.ENDED)}this._fetchPayloadOrEos(r,n,o)}}}}},b.prototype._fetchPayloadOrEos=function(e,t,n){var r=this.fragPrevious,i=this.level,o=n.fragments,a=o.length;if(0!==a){var s,l=o[0].start,u=o[a-1].start+o[a-1].duration,c=t.end;if(n.initSegment&&!n.initSegment.data)s=n.initSegment;else if(n.live){t=this.config.initialLiveManifestSize;if(a<t)return void p.logger.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+t);if(null===(s=this._ensureFragmentAtLivePoint(n,c,l,u,r,o,a)))return}else c<l&&(s=o[0]);(s=s||this._findFragment(l,r,a,o,c,u,n))&&(s.encrypted?(p.logger.log("Loading key for "+s.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+i),this._loadKey(s)):(p.logger.log("Loading "+s.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+i+", currentTime:"+e.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(s)))}},b.prototype._ensureFragmentAtLivePoint=function(e,t,n,r,i,o,a){var s,l=this.hls.config,u=this.media,c=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;return t<Math.max(n-l.maxFragLookUpTolerance,r-c)&&(n=this.liveSyncPosition=this.computeLivePosition(n,e),p.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+n.toFixed(3)),t=n,u&&u.readyState&&u.duration>n&&(u.currentTime=n),this.nextLoadPosition=n),e.PTSKnown&&r<t&&u&&u.readyState?null:(this.startFragRequested&&!e.PTSKnown&&(i&&(e.hasProgramDateTime?(p.logger.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),s=g.findFragmentByPDT(o,i.endProgramDateTime,l.maxFragLookUpTolerance)):((l=i.sn+1)>=e.startSN&&l<=e.endSN&&(e=o[l-e.startSN],i.cc===e.cc&&p.logger.log("live playlist, switching playlist, load frag with next SN: "+(s=e).sn)),s||(s=d.default.search(o,function(e){return i.cc-e.cc}))&&p.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn))),s||(s=o[Math.min(a-1,Math.round(a/2))],p.logger.log("live playlist, switching playlist, unknown, load middle frag : "+s.sn))),s)},b.prototype._findFragment=function(e,t,n,r,i,o,a){var s,l=this.hls.config;return(o=i<o?(s=i>o-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance,g.findFragmentByPTS(t,r,i,s)):r[n-1])&&(i=o.sn-a.startSN,s=t&&o.level===t.level,n=r[i-1],r=r[1+i],t&&o.sn===t.sn&&(s&&!o.backtracked?o.sn<a.endSN?(a=t.deltaPTS)&&a>l.maxBufferHole&&t.dropped&&i?(o=n,p.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):p.logger.log("SN just loaded, load next one: "+(o=r).sn,o):o=null:o.backtracked&&(r&&r.backtracked?(p.logger.warn("Already backtracked from fragment "+r.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+r.sn),o=r):(p.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,n?(o=n).backtracked=!0:i&&(o=null))))),o},b.prototype._loadKey=function(e){this.state=v.State.KEY_LOADING,this.hls.trigger(c.default.KEY_LOADING,{frag:e})},b.prototype._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,s.isFinite(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===n.FragmentState.NOT_LOADED||t===n.FragmentState.PARTIAL?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(c.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new u.default(this.hls,"main")),this.state=v.State.FRAG_LOADING):t===n.FragmentState.APPENDING&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},Object.defineProperty(b.prototype,"state",{get:function(){return this._state},set:function(e){var t;this.state!==e&&(t=this.state,this._state=e,p.logger.log("main stream:"+t+"->"+e),this.hls.trigger(c.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e}))},enumerable:!0,configurable:!0}),b.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,t.default.LevelType.MAIN)},Object.defineProperty(b.prototype,"currentLevel",{get:function(){var e=this.media;if(e){e=this.getBufferedFrag(e.currentTime);if(e)return e.level}return-1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"nextBufferedFrag",{get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null},enumerable:!0,configurable:!0}),b.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Object.defineProperty(b.prototype,"nextLevel",{get:function(){var e=this.nextBufferedFrag;return e?e.level:-1},enumerable:!0,configurable:!0}),b.prototype._checkFragmentChanged=function(){var e,t,n=this.media;n&&n.readyState&&!1===n.seeking&&((e=n.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=e),l.BufferHelper.isBuffered(n,e)?t=this.getBufferedFrag(e):l.BufferHelper.isBuffered(n,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)&&((e=t)!==this.fragPlaying&&(this.hls.trigger(c.default.FRAG_CHANGED,{frag:e}),t=e.level,this.fragPlaying&&this.fragPlaying.level===t||this.hls.trigger(c.default.LEVEL_SWITCHED,{level:t}),this.fragPlaying=e))},b.prototype.immediateLevelSwitch=function(){var e;p.logger.log("immediateLevelSwitch"),this.immediateSwitch||(this.immediateSwitch=!0,t=void 0,(e=this.media)?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t);var t=this.fragCurrent;t&&t.loader&&t.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,s.POSITIVE_INFINITY)},b.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,l.BufferHelper.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},b.prototype.nextLevelSwitch=function(){var e,t,n,r,i=this.media;i&&i.readyState&&(e=r=void 0,(t=this.getBufferedFrag(i.currentTime))&&1<t.startPTS&&this.flushMainBuffer(0,t.startPTS-1),r=i.paused?0:(n=this.hls.nextLoadLevel,t=this.levels[n],(n=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*t.bitrate/(1e3*n)+1:0),(e=this.getBufferedFrag(i.currentTime+r))&&(e=this.followingBufferedFrag(e))&&((r=this.fragCurrent)&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(e.maxStartPTS,s.POSITIVE_INFINITY)))},b.prototype.flushMainBuffer=function(e,t){this.state=v.State.BUFFER_FLUSHING;t={startOffset:e,endOffset:t};this.altAudio&&(t.type="video"),this.hls.trigger(c.default.BUFFER_FLUSHING,t)},b.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);e=this.config;this.levels&&e.autoStartLoad&&this.hls.startLoad(e.startPosition),this.gapController=new m.default(e,t,this.fragmentTracker,this.hls)},b.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(p.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},b.prototype.onMediaSeeked=function(){var e=this.media,e=e?e.currentTime:void 0;s.isFinite(e)&&p.logger.log("media seeked to "+e.toFixed(3)),this.tick()},b.prototype.onManifestLoading=function(){p.logger.log("trigger BUFFER_RESET"),this.hls.trigger(c.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},b.prototype.onManifestParsed=function(e){var t,n=!1,r=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(n=!0),-1!==t.indexOf("mp4a.40.5")&&(r=!0))}),this.audioCodecSwitch=n&&r,this.audioCodecSwitch&&p.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;e=this.config;(e.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(e.startPosition)},b.prototype.onLevelLoaded=function(e){var t=e.details,n=e.level,r=this.levels[this.levelLastLoaded],i=this.levels[n],o=t.totalduration,a=0;p.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+o),t.live?(e=i.details)&&0<t.fragments.length?(f.mergeDetails(e,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,e),t.PTSKnown&&s.isFinite(a)?p.logger.log("live playlist sliding:"+a.toFixed(3)):(p.logger.log("live playlist - outdated PTS, unknown sliding"),y.alignStream(this.fragPrevious,r,t))):(p.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,y.alignStream(this.fragPrevious,r,t)):t.PTSKnown=!1,i.details=t,this.levelLastLoaded=n,this.hls.trigger(c.default.LEVEL_UPDATED,{details:t,level:n}),!1===this.startFragRequested&&(-1!==this.startPosition&&-1!==this.lastCurrentTime||(n=t.startTimeOffset,s.isFinite(n)?(n<0&&(p.logger.log("negative start time offset "+n+", count from end of last fragment"),n=a+o+n),p.logger.log("start time offset found in playlist, adjust startPosition to "+n),this.startPosition=n):t.live?(this.startPosition=this.computeLivePosition(a,t),p.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition),this.nextLoadPosition=this.startPosition),this.state===v.State.WAITING_LEVEL&&(this.state=v.State.IDLE),this.tick()},b.prototype.onKeyLoaded=function(){this.state===v.State.KEY_LOADING&&(this.state=v.State.IDLE,this.tick())},b.prototype.onFragLoaded=function(e){var t,n,r=this.fragCurrent,i=this.hls,o=this.levels,a=this.media,s=e.frag;this.state===v.State.FRAG_LOADING&&r&&"main"===s.type&&s.level===r.level&&s.sn===r.sn&&(n=e.stats,o=(t=o[r.level]).details,this.bitrateTest=!1,this.stats=n,p.logger.log("Loaded "+r.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+r.level),s.bitrateTest&&i.nextLoadLevel?(this.state=v.State.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=window.performance.now(),i.trigger(c.default.FRAG_BUFFERED,{stats:n,frag:r,id:"main"}),this.tick()):"initSegment"===s.sn?(this.state=v.State.IDLE,n.tparsed=n.tbuffered=window.performance.now(),o.initSegment.data=e.payload,i.trigger(c.default.FRAG_BUFFERED,{stats:n,frag:r,id:"main"}),this.tick()):(p.logger.log("Parsing "+r.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+r.level+", cc "+r.cc),this.state=v.State.PARSING,this.pendingBuffering=!0,this.appended=!1,s.bitrateTest&&(s.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:s})),n=!(a&&a.seeking)&&(o.PTSKnown||!o.live),s=o.initSegment?o.initSegment.data:[],a=this._getAudioCodec(t),(this.demuxer=this.demuxer||new u.default(this.hls,"main")).push(e.payload,s,a,t.videoCodec,r,o.totalduration,n))),this.fragLoadError=0},b.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;if(t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===v.State.PARSING){var r=e.tracks,i=void 0,o=void 0;for(i in r.audio&&this.altAudio&&delete r.audio,(o=r.audio)&&(n=this.levels[this.level].audioCodec,t=navigator.userAgent.toLowerCase(),n&&this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==o.metadata.channelCount&&-1===t.indexOf("firefox")&&(n="mp4a.40.5"),-1!==t.indexOf("android")&&"audio/mpeg"!==o.container&&p.logger.log("Android: force audio codec to "+(n="mp4a.40.2")),o.levelCodec=n,o.id=e.id),(o=r.video)&&(o.levelCodec=this.levels[this.level].videoCodec,o.id=e.id),this.hls.trigger(c.default.BUFFER_CODECS,r),r){o=r[i],p.logger.log("main track:"+i+",container:"+o.container+",codecs[level/parsed]=["+o.levelCodec+"/"+o.codec+"]");var a=o.initSegment;a&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(c.default.BUFFER_APPENDING,{type:i,data:a,parent:"main",content:"initSegment"}))}this.tick()}},b.prototype.onFragParsingData=function(t){var n=this,e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===v.State.PARSING){var i=this.levels[this.level],r=e;if(s.isFinite(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),!0===t.hasAudio&&r.addElementaryStream(a.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&r.addElementaryStream(a.default.ElementaryStreamTypes.VIDEO),p.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(r.dropped=t.dropped,r.dropped)if(r.backtracked)p.logger.warn("Already backtracked on this fragment, appending with the gap",r.sn);else{e=i.details;if(!e||r.sn!==e.startSN)return p.logger.warn("missing video frame(s), backtracking fragment",r.sn),this.fragmentTracker.removeFragment(r),r.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=v.State.IDLE,this.fragPrevious=r,void this.tick();p.logger.warn("missing video frame(s) on first frag, appending with gap",r.sn)}else r.backtracked=!1;var r=f.updateFragPTSDTS(i.details,r,t.startPTS,t.endPTS,t.startDTS,t.endDTS),o=this.hls;o.trigger(c.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:r,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&n.state===v.State.PARSING&&(n.appended=!0,n.pendingBuffering=!0,o.trigger(c.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},b.prototype.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===v.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=v.State.PARSED,this._checkAppendedParsed())},b.prototype.onAudioTrackSwitching=function(e){var t,n=!!e.url,e=e.id;n||(this.mediaBuffer!==this.media&&(p.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,(t=this.fragCurrent).loader&&(p.logger.log("switching to main audio track, cancel main fragment load"),t.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=v.State.IDLE),(t=this.hls).trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:s.POSITIVE_INFINITY,type:"audio"}),t.trigger(c.default.AUDIO_TRACK_SWITCHED,{id:e}),this.altAudio=!1)},b.prototype.onAudioTrackSwitched=function(e){var t=e.id,e=!!this.hls.audioTracks[t].url;!e||(t=this.videoBuffer)&&this.mediaBuffer!==t&&(p.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t),this.altAudio=e,this.tick()},b.prototype.onBufferCreated=function(e){var t,n,r,i=e.tracks,o=!1;for(r in i){var a=i[r];"main"===a.id?(t=a,"video"===(n=r)&&(this.videoBuffer=i[r].buffer)):o=!0}o&&t?(p.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},b.prototype.onBufferAppended=function(e){var t;"main"===e.parent&&((t=this.state)!==v.State.PARSING&&t!==v.State.PARSED||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed()))},b.prototype._checkAppendedParsed=function(){var e,t;this.state!==v.State.PARSED||this.appended&&this.pendingBuffering||((e=this.fragCurrent)&&(t=this.mediaBuffer||this.media,p.logger.log("main buffered : "+o.default.toString(t.buffered)),this.fragPrevious=e,(t=this.stats).tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*t.total/(t.tbuffered-t.tfirst)),this.hls.trigger(c.default.FRAG_BUFFERED,{stats:t,frag:e,id:"main"}),this.state=v.State.IDLE),this.tick())},b.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n,r=!!this.media&&l.BufferHelper.isBuffered(this.media,this.media.currentTime)&&l.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:e.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),p.logger.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=v.State.FRAG_LOADING_WAITING_RETRY):(p.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=v.State.ERROR));break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==v.State.ERROR&&(e.fatal?(this.state=v.State.ERROR,p.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==v.State.WAITING_LEVEL||(this.state=v.State.IDLE));break;case h.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==v.State.PARSING&&this.state!==v.State.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=v.State.IDLE):(p.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,s.POSITIVE_INFINITY)))}}},b.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,p.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},b.prototype._checkBuffer=function(){var e=this.media;e&&0!==e.readyState&&(e=(this.mediaBuffer||e).buffered,!this.loadedmetadata&&e.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,e))},b.prototype.onFragLoadEmergencyAborted=function(){this.state=v.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},b.prototype.onBufferFlushed=function(){var e=this.mediaBuffer||this.media;e&&this.fragmentTracker.detectEvictedFragments(a.default.ElementaryStreamTypes.VIDEO,e.buffered),this.state=v.State.IDLE,this.fragPrevious=null},b.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},b.prototype.computeLivePosition=function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)},b.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,n=e.seeking?t:this.startPosition;t!==n&&(p.logger.log("target start position not buffered, seek to buffered.start(0) "+n+" from current time "+t+" "),e.currentTime=n)},b.prototype._getAudioCodec=function(e){e=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),e=e&&(-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),e},Object.defineProperty(b.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e},enumerable:!0,configurable:!0}),b);function b(e,t){var n=i.call(this,e,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.MANIFEST_LOADING,c.default.MANIFEST_PARSED,c.default.LEVEL_LOADED,c.default.KEY_LOADED,c.default.FRAG_LOADED,c.default.FRAG_LOAD_EMERGENCY_ABORTED,c.default.FRAG_PARSING_INIT_SEGMENT,c.default.FRAG_PARSING_DATA,c.default.FRAG_PARSED,c.default.ERROR,c.default.AUDIO_TRACK_SWITCHING,c.default.AUDIO_TRACK_SWITCHED,c.default.BUFFER_CREATED,c.default.BUFFER_APPENDED,c.default.BUFFER_FLUSHED)||this;return n.fragmentTracker=t,n.config=e.config,n.audioCodecSwap=!1,n._state=v.State.STOPPED,n.stallReported=!1,n.gapController=null,n}_.default=e}.call(this,E("./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var u=n("./src/events.js"),c=n("./src/utils/logger.js"),o=n("./src/crypt/decrypter.js"),a=n("./src/task-loop.js"),d=n("./src/utils/buffer-helper.js"),f=n("./src/controller/fragment-finders.js"),h=n("./src/controller/fragment-tracker.js"),s=window.performance;t.SubtitleStreamControllerState={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"};var l,p=t.SubtitleStreamControllerState,i=(l=a.default,i(y,l),y.prototype.onHandlerDestroyed=function(){this.fragmentTracker=null,this.state=p.STOPPED,l.prototype.onHandlerDestroyed.call(this)},y.prototype.onSubtitleFragProcessed=function(e){if(this.state=p.IDLE,e.success){var t=this.tracksBuffered[this.currentTrackId],n=e.frag;if(this.fragPrevious=n,t){for(var r,i=0;i<t.length;i++)if(n.start>=t[i].start&&n.start<=t[i].end){r=t[i];break}r?r.end=n.start+n.duration:t.push({start:n.start,end:n.start+n.duration})}}},y.prototype.onMediaAttached=function(e){this.media=e.media,this.state=p.IDLE},y.prototype.onMediaDetaching=function(){this.media=null,this.state=p.STOPPED},y.prototype.onError=function(e){e=e.frag;e&&"subtitle"===e.type&&(this.state=p.IDLE)},y.prototype.onSubtitleTracksUpdated=function(e){var t=this;c.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},y.prototype.onSubtitleTrackSwitch=function(e){this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId?(e=this.tracks[this.currentTrackId])&&e.details&&this.setInterval(500):this.clearInterval()},y.prototype.onSubtitleTrackLoaded=function(e){var t=e.id,e=e.details;this.tracks?(this.tracks[t]&&(c.logger.log("Updating subtitle track details"),this.tracks[t].details=e),this.setInterval(500)):c.logger.warn("Can not update subtitle details, no tracks found")},y.prototype.onKeyLoaded=function(){this.state===p.KEY_LOADING&&(this.state=p.IDLE)},y.prototype.onFragLoaded=function(e){var n,t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,o=this.hls;this.state===p.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&r&&r.key&&"AES-128"===r.method&&(n=s.now(),this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=s.now();o.trigger(u.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:n,tdecrypt:t}})}))},y.prototype.doTick=function(){if(this.media)switch(this.state){case p.IDLE:var e=this.tracks,t=this.currentTrackId;if(!e||!e[t]||!e[t].details)break;var n=e[t].details,r=this.config,i=r.maxBufferHole,o=Math.min(r.maxBufferLength,r.maxMaxBufferLength),a=r.maxFragLookUpTolerance,s=d.BufferHelper.bufferedInfo(this._getBuffered(),this.media.currentTime,i),l=s.end,e=s.len,r=n.fragments,i=r.length,s=r[i-1].start+r[i-1].duration,i=void 0;e<o&&l<s?i=f.findFragmentByPTS(this.fragPrevious,r,l,a):n.hasProgramDateTime&&this.fragPrevious&&(i=f.findFragmentByPDT(r,this.fragPrevious.endProgramDateTime,a)),i&&i.encrypted?(c.logger.log("Loading key for "+i.sn),this.state=p.KEY_LOADING,this.hls.trigger(u.default.KEY_LOADING,{frag:i})):i&&this.fragmentTracker.getState(i)===h.FragmentState.NOT_LOADED&&(i.trackId=t,this.fragCurrent=i,this.state=p.FRAG_LOADING,this.hls.trigger(u.default.FRAG_LOADING,{frag:i}))}else this.state=p.IDLE},y.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},y);function y(e,t){var n=l.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.ERROR,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.SUBTITLE_TRACKS_UPDATED,u.default.SUBTITLE_TRACK_SWITCH,u.default.SUBTITLE_TRACK_LOADED,u.default.SUBTITLE_FRAG_PROCESSED)||this;return n.fragmentTracker=t,n.config=e.config,n.state=p.STOPPED,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new o.default(e,e.config),n}t.SubtitleStreamController=i},"./src/controller/subtitle-track-controller.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("./src/events.js"),a=n("./src/event-handler.js"),s=n("./src/utils/logger.js");function l(e){for(var t=[],n=0;n<e.length;n++)"subtitles"===e[n].kind&&t.push(e[n]);return t}var u,i=(u=a.default,i(c,u),c.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=l(this.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack=e}},c.prototype.destroy=function(){a.default.prototype.destroy.call(this)},c.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},c.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},c.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},c.prototype.onManifestLoaded=function(e){var t=this,e=e.subtitles||[];this.tracks=e,this.trackId=-1,this.hls.trigger(o.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:e}),e.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},c.prototype.onTick=function(){var e,t=this.trackId,n=this.tracks[t];n&&((e=n.details)&&!e.live||(s.logger.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(o.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:t})))},c.prototype.onSubtitleTrackLoaded=function(e){var t=this;e.id<this.tracks.length&&(s.logger.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&this._stopTimer())},Object.defineProperty(c.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this.setSubtitleTrackInternal(e))},enumerable:!0,configurable:!0}),c.prototype.setSubtitleTrackInternal=function(e){var t,n=this.hls,r=this.tracks;"number"!=typeof e||e<-1||e>=r.length||(this._stopTimer(),this.trackId=e,s.logger.log("switching to subtitle track "+e),n.trigger(o.default.SUBTITLE_TRACK_SWITCH,{id:e}),-1===e)||((r=(t=r[e]).details)&&!r.live||(s.logger.log("(re)loading playlist for subtitle track "+e),n.trigger(o.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:e})))},c.prototype._stopTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=null)},c.prototype._toggleTrackModes=function(e){var t=this.media,n=this.subtitleDisplay,r=this.trackId;t&&(t=l(t.textTracks),-1===e?[].slice.call(t).forEach(function(e){e.mode="disabled"}):(r=t[r])&&(r.mode="disabled"),(e=t[e])&&(e.mode=n?"showing":"hidden"))},c);function c(e){e=u.call(this,e,o.default.MEDIA_ATTACHED,o.default.MEDIA_DETACHING,o.default.MANIFEST_LOADING,o.default.MANIFEST_LOADED,o.default.SUBTITLE_TRACK_LOADED)||this;return e.tracks=[],e.trackId=-1,e.media=null,e.subtitleDisplay=!0,e}t.default=i},"./src/controller/timeline-controller.js":function(e,f,h){"use strict";!function(o){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(f,"__esModule",{value:!0});var i,a=h("./src/events.js"),t=h("./src/event-handler.js"),s=h("./src/utils/cea-608-parser.js"),l=h("./src/utils/output-filter.js"),u=h("./src/utils/webvtt-parser.js"),c=h("./src/utils/logger.js"),d=h("./src/utils/texttrack-utils.js"),e=(i=t.default,e(n,i),n.prototype.addCues=function(e,t,n,r){for(var i,o,a=this.cueRanges,s=!1,l=a.length;l--;){var u=a[l],c=(i=u[0],o=u[1],c=t,Math.min(o,n)-Math.max(i,c));if(0<=c&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],n),s=!0,.5<c/(n-t)))return}s||a.push([t,n]),this.Cues.newCue(this.captionsTracks[e],t,n,r)},n.prototype.onInitPtsFound=function(e){var t=this;"main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),this.unparsedVttFrags.length&&(e=this.unparsedVttFrags,this.unparsedVttFrags=[],e.forEach(function(e){t.onFragLoaded(e)}))},n.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n];if(r[e])return r}return null},n.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],n=t.label,r=t.languageCode,i=this.captionsTracks;i[e]||((t=this.getExistingTrack(e))?(i[e]=t,d.clearCurrentCues(i[e]),d.sendAddTrackEvent(i[e],this.media)):(r=this.createTextTrack("captions",n,r))&&(r[e]=!0,i[e]=r))},n.prototype.createTextTrack=function(e,t,n){var r=this.media;if(r)return r.addTextTrack(e,t,n)},n.prototype.destroy=function(){t.default.prototype.destroy.call(this)},n.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},n.prototype.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){d.clearCurrentCues(t[e]),delete t[e]})},n.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},n.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)d.clearCurrentCues(t[n])}},n.prototype.onManifestLoaded=function(e){var r,i=this;this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT&&(this.tracks=e.subtitles||[],r=this.media?this.media.textTracks:[],this.tracks.forEach(function(t,e){var n;e<r.length&&((e=[].slice.call(r).find(function(e){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}))&&(n=e)),n=n||i.createTextTrack("subtitles",t.name,t.lang),t.default?n.mode=i.hls.subtitleDisplay?"showing":"hidden":n.mode="disabled",i.textTracks.push(n)}))},n.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},n.prototype.onFragLoaded=function(e){var t=e.frag,n=e.payload;if("main"===t.type){var r,i=t.sn;i===this.lastSn+1||(r=this.cea608Parser)&&r.reset(),this.lastSn=i}else if("subtitle"===t.type)if(n.byteLength){if(!o.isFinite(this.initPTS[t.cc]))return this.unparsedVttFrags.push(e),void(this.initPTS.length&&this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));e=t.decryptdata;null!=e&&null!=e.key&&"AES-128"===e.method||this._parseVTTs(t,n)}else this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},n.prototype._parseVTTs=function(t,e){var n=this.vttCCs;n[t.cc]||(n[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var i=this.textTracks,o=this.hls;u.default.parse(e,this.initPTS[t.cc],n,t.cc,function(e){var r=i[t.trackId];"disabled"!==r.mode?(e.forEach(function(t){if(!r.cues.getCueById(t.id))try{r.addCue(t)}catch(e){var n=new window.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,r.addCue(n)}}),o.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})):o.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},function(e){c.logger.log("Failed to parse VTT cue: "+e),o.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},n.prototype.onFragDecrypted=function(e){var t=e.payload,n=e.frag;"subtitle"===n.type&&(o.isFinite(this.initPTS[n.cc])?this._parseVTTs(n,t):this.unparsedVttFrags.push(e))},n.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var n=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,n)}},n.prototype.extractCea608Data=function(e){for(var t,n,r,i=31&e[0],o=2,a=[],s=0;s<i;s++)t=e[o++],n=127&e[o++],r=127&e[o++],0==n&&0==r||0!=(4&t)&&0==(3&t)&&(a.push(n),a.push(r));return a},n);function n(e){var t,n=i.call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_USERDATA,a.default.FRAG_DECRYPTED,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.FRAG_LOADED,a.default.LEVEL_SWITCHING,a.default.INIT_PTS_FOUND)||this;return n.hls=e,n.config=e.config,n.enabled=!0,n.Cues=e.config.cueHandler,n.textTracks=[],n.tracks=[],n.unparsedVttFrags=[],n.initPTS=[],n.cueRanges=[],n.captionsTracks={},n.captionsProperties={textTrack1:{label:n.config.captionsTextTrack1Label,languageCode:n.config.captionsTextTrack1LanguageCode},textTrack2:{label:n.config.captionsTextTrack2Label,languageCode:n.config.captionsTextTrack2LanguageCode}},n.config.enableCEA708Captions&&(t=new l.default(n,"textTrack1"),e=new l.default(n,"textTrack2"),n.cea608Parser=new s.default(0,t,e)),n}f.default=e}.call(this,h("./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},i);function i(e,t){this.subtle=e,this.aesIV=t}t.default=r},"./src/crypt/aes-decryptor.js":function(e,t,n){"use strict";function x(e){var t=e.byteLength,n=t&&new DataView(e).getUint8(t-1);return n?e.slice(0,t-n):e}Object.defineProperty(t,"__esModule",{value:!0}),t.removePadding=x;var r=(i.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<4;r++)n[r]=t.getUint32(4*r);return n},i.prototype.initTable=function(){for(var e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],n=this.invSubMix,s=n[0],l=n[1],u=n[2],c=n[3],d=new Uint32Array(256),f=0,h=0,p=0,p=0;p<256;p++)d[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var y=h^h<<1^h<<2^h<<3^h<<4;e[f]=y=y>>>8^255&y^99;var g=d[t[y]=f],m=d[g],v=d[m],b=257*d[y]^16843008*y;r[f]=b<<24|b>>>8,i[f]=b<<16|b>>>16,o[f]=b<<8|b>>>24,a[f]=b,s[y]=(b=16843009*v^65537*m^257*g^16843008*f)<<24|b>>>8,l[y]=b<<16|b>>>16,u[y]=b<<8|b>>>24,c[y]=b,f?(f=g^d[d[d[v^g]]],h^=d[d[h]]):f=h=1}},i.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);for(var o,a,s,l=this.ksRows=4*(i+6+1),u=this.keySchedule=new Uint32Array(l),c=this.invKeySchedule=new Uint32Array(l),d=this.sBox,f=this.rcon,e=this.invSubMix,h=e[0],p=e[1],y=e[2],g=e[3],m=0;m<l;m++)m<i?a=u[m]=t[m]:(s=a,m%i==0?(s=d[(s=s<<8|s>>>24)>>>24]<<24|d[s>>>16&255]<<16|d[s>>>8&255]<<8|d[255&s],s^=f[m/i|0]<<24):6<i&&m%i==4&&(s=d[s>>>24]<<24|d[s>>>16&255]<<16|d[s>>>8&255]<<8|d[255&s]),u[m]=a=(u[m-i]^s)>>>0);for(o=0;o<l;o++)m=l-o,s=3&o?u[m]:u[m-4],c[o]=o<4||m<=4?s:h[d[s>>>24]]^p[d[s>>>16&255]]^y[d[s>>>8&255]]^g[d[255&s]],c[o]=c[o]>>>0}},i.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},i.prototype.decrypt=function(e,t,n,r){for(var i,o,a,s,l,u,c,d,f,h,p,y,g,m,v=this.keySize+6,b=this.invKeySchedule,_=this.invSBox,E=this.invSubMix,k=E[0],A=E[1],S=E[2],w=E[3],n=this.uint8ArrayToUint32Array_(n),T=n[0],P=n[1],O=n[2],L=n[3],R=new Int32Array(e),C=new Int32Array(R.length),D=this.networkToHostOrderSwap;t<R.length;){for(f=D(R[t]),h=D(R[t+1]),p=D(R[t+2]),y=D(R[t+3]),l=f^b[0],u=y^b[1],c=p^b[2],d=h^b[3],g=4,m=1;m<v;m++)i=k[l>>>24]^A[u>>16&255]^S[c>>8&255]^w[255&d]^b[g],o=k[u>>>24]^A[c>>16&255]^S[d>>8&255]^w[255&l]^b[g+1],a=k[c>>>24]^A[d>>16&255]^S[l>>8&255]^w[255&u]^b[g+2],s=k[d>>>24]^A[l>>16&255]^S[u>>8&255]^w[255&c]^b[g+3],l=i,u=o,c=a,d=s,g+=4;i=_[l>>>24]<<24^_[u>>16&255]<<16^_[c>>8&255]<<8^_[255&d]^b[g],o=_[u>>>24]<<24^_[c>>16&255]<<16^_[d>>8&255]<<8^_[255&l]^b[g+1],a=_[c>>>24]<<24^_[d>>16&255]<<16^_[l>>8&255]<<8^_[255&u]^b[g+2],s=_[d>>>24]<<24^_[l>>16&255]<<16^_[u>>8&255]<<8^_[255&c]^b[g+3],g+=3,C[t]=D(i^T),C[t+1]=D(s^P),C[t+2]=D(a^O),C[t+3]=D(o^L),T=f,P=h,O=p,L=y,t+=4}return r?x(C.buffer):C.buffer},i.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},i);function i(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}t.default=r},"./src/crypt/decrypter.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("./src/crypt/aes-crypto.js"),l=n("./src/crypt/fast-aes-key.js"),u=n("./src/crypt/aes-decryptor.js"),o=n("./src/errors.js"),c=n("./src/utils/logger.js"),a=n("./src/events.js"),i=n("./src/utils/get-self-scope.js").getSelfScope(),n=(r.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},r.prototype.decrypt=function(t,n,r,i){var e,o,a=this;this.disableWebCrypto&&this.config.enableSoftwareAES?(this.logEnabled&&(c.logger.log("JS AES decrypt"),this.logEnabled=!1),(e=this.decryptor)||(this.decryptor=e=new u.default),e.expandKey(n),i(e.decrypt(t,0,r,this.removePKCS7Padding))):(this.logEnabled&&(c.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1),o=this.subtle,this.key!==n&&(this.key=n,this.fastAesKey=new l.default(o,n)),this.fastAesKey.expandKey().then(function(e){new s.default(o,r).decrypt(t,e).catch(function(e){a.onWebCryptoError(e,t,n,r,i)}).then(function(e){i(e)})}).catch(function(e){a.onWebCryptoError(e,t,n,r,i)}))},r.prototype.onWebCryptoError=function(e,t,n,r,i){this.config.enableSoftwareAES?(c.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,n,r,i)):(c.logger.error("decrypting error : "+e.message),this.observer.trigger(a.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},r.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},r);function r(e,t,n){n=(void 0===n?{}:n).removePKCS7Padding,n=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n)try{var r=i.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}t.default=n},"./src/crypt/fast-aes-key.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},i);function i(e,t){this.subtle=e,this.key=t}t.default=r},"./src/demux/aacdemuxer.js":function(e,n,r){"use strict";!function(p){Object.defineProperty(n,"__esModule",{value:!0});var y=r("./src/demux/adts.js"),g=r("./src/utils/logger.js"),m=r("./src/demux/id3.js"),e=(t.prototype.resetInitSegment=function(e,t,n,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(e){if(!e)return!1;for(var t=(m.default.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(y.probe(e,t))return g.logger.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(e,t,n,r){for(var i=this._audioTrack,o=m.default.getID3Data(e,0)||[],a=m.default.getTimeStamp(o),s=p.isFinite(a)?90*a:9e4*t,l=0,u=s,c=e.length,d=o.length,f=[{pts:u,dts:u,data:o}];d<c-1;)if(y.isHeader(e,d)&&d+5<c){y.initTrackConfig(i,this.observer,e,d,i.manifestCodec);var h=y.appendFrame(i,e,d,s,l);if(!h){g.logger.log("Unable to parse AAC frame");break}d+=h.length,u=h.sample.pts,l++}else m.default.isHeader(e,d)?(o=m.default.getID3Data(e,d),f.push({pts:u,dts:u,data:o}),d+=o.length):d++;this.remuxer.remux(i,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,n,r)},t.prototype.destroy=function(){},t);function t(e,t,n){this.observer=e,this.config=n,this.remuxer=t}n.default=e}.call(this,r("./src/polyfills/number.js").Number)},"./src/demux/adts.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=n("./src/utils/logger.js"),f=n("./src/errors.js"),h=n("./src/events.js");function o(e,t,n,r){var i,o,a,s=navigator.userAgent.toLowerCase(),l=r,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=1+((192&t[n+2])>>>6);if(!((i=(60&t[n+2])>>>2)>u.length-1))return o=(1&t[n+2])<<2,o|=(192&t[n+3])>>>6,d.logger.log("manifest codec:"+r+",ADTS data:type:"+c+",sampleingIndex:"+i+"["+u[i]+"Hz],channelConfig:"+o),r=/firefox/i.test(s)?6<=i?(c=5,a=new Array(4),i-3):(c=2,a=new Array(2),i):-1!==s.indexOf("android")?(c=2,a=new Array(2),i):(c=5,a=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&6<=i?i-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(6<=i&&1==o||/vivaldi/i.test(s))||!r&&1==o)&&(c=2,a=new Array(2)),i)),a[0]=c<<3,a[0]|=(14&i)>>1,a[1]|=(1&i)<<7,a[1]|=o<<3,5===c&&(a[1]|=(14&r)>>1,a[2]=(1&r)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:u[i],channelCount:o,codec:"mp4a.40."+c,manifestCodec:l};e.trigger(h.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+i})}function r(e,t){return 255===e[t]&&240==(246&e[t+1])}function s(e,t){return 1&e[t+1]?7:9}function l(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function a(e){return 9216e4/e}function u(e,t,n,r,i){var o=e.length,a=s(e,t),e=l(e,t);if(0<(e-=a)&&t+a+e<=o)return{headerLength:a,frameLength:e,stamp:n+r*i}}t.getAudioConfig=o,t.isHeaderPattern=r,t.getHeaderLength=s,t.getFullFrameLength=l,t.isHeader=function(e,t){return!!(t+1<e.length&&r(e,t))},t.probe=function(e,t){if(t+1<e.length&&r(e,t)){var n=s(e,t),n=t+(n=t+5<e.length?l(e,t):n);if(n===e.length||n+1<e.length&&r(e,n))return!0}return!1},t.initTrackConfig=function(e,t,n,r,i){e.samplerate||(i=o(t,n,r,i),e.config=i.config,e.samplerate=i.samplerate,e.channelCount=i.channelCount,e.codec=i.codec,e.manifestCodec=i.manifestCodec,d.logger.log("parsed codec:"+e.codec+",rate:"+i.samplerate+",nb channel:"+i.channelCount))},t.getFrameDuration=a,t.parseFrameHeader=u,t.appendFrame=function(e,t,n,r,i){var o=u(t,n,r,i,a(e.samplerate));if(o){r=o.stamp,i=o.headerLength,o=o.frameLength,r={unit:t.subarray(n+i,n+i+o),pts:r,dts:r};return e.samples.push(r),e.len+=o,{sample:r,length:o+i}}}},"./src/demux/demuxer-inline.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y,A=n("./src/events.js"),S=n("./src/errors.js"),g=n("./src/crypt/decrypter.js"),w=n("./src/demux/aacdemuxer.js"),T=n("./src/demux/mp4demuxer.js"),P=n("./src/demux/tsdemuxer.js"),O=n("./src/demux/mp3demuxer.js"),L=n("./src/remux/mp4-remuxer.js"),R=n("./src/remux/passthrough-remuxer.js"),r=n("./src/utils/get-self-scope.js"),n=n("./src/utils/logger.js"),r=r.getSelfScope();try{y=r.performance.now.bind(r.performance)}catch(e){n.logger.debug("Unable to use Performance API on this environment"),y=r.Date.now}i.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},i.prototype.push=function(e,n,r,i,o,a,s,l,u,c,d,f){var t,h,p=this;0<e.byteLength&&null!=n&&null!=n.key&&"AES-128"===n.method?(null==(t=this.decrypter)&&(t=this.decrypter=new g.default(this.observer,this.config)),h=y(),t.decrypt(e,n.key.buffer,n.iv.buffer,function(e){var t=y();p.observer.trigger(A.default.FRAG_DECRYPTED,{stats:{tstart:h,tdecrypt:t}}),p.pushDecrypted(new Uint8Array(e),n,new Uint8Array(r),i,o,a,s,l,u,c,d,f)})):this.pushDecrypted(new Uint8Array(e),n,new Uint8Array(r),i,o,a,s,l,u,c,d,f)},i.prototype.pushDecrypted=function(e,t,n,r,i,o,a,s,l,u,c,d){if(!(E=this.demuxer)||(a||s)&&!this.probe(e)){for(var f=this.observer,h=this.typeSupported,p=this.config,y=[{demux:P.default,remux:L.default},{demux:T.default,remux:R.default},{demux:w.default,remux:L.default},{demux:O.default,remux:L.default}],g=0,m=y.length;g<m;g++){var v=y[g],b=v.demux.probe;if(b(e)){var _=this.remuxer=new v.remux(f,p,h,this.vendor),E=new v.demux(f,_,p,h);this.probe=b;break}}if(!E)return void f.trigger(A.default.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=E}var k=this.remuxer;(a||s)&&(E.resetInitSegment(n,r,i,u),k.resetInitSegment()),a&&(E.resetTimeStamp(d),k.resetTimeStamp(d)),"function"==typeof E.setDecryptData&&E.setDecryptData(t),E.append(e,o,l,c)},r=i;function i(e,t,n,r){this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r}t.default=r},"./src/demux/demuxer-worker.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./src/demux/demuxer-inline.js"),s=n("./src/events.js"),l=n("./src/utils/logger.js"),u=n("./node_modules/node-libs-browser/node_modules/events/events.js");t.default=function(r){var i=new u.EventEmitter;i.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(t))},i.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(t))};function o(e,t){r.postMessage({event:e,data:t})}r.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var n=JSON.parse(t.config);r.demuxer=new a.default(i,t.typeSupported,n,t.vendor),l.enableLogs(n.debug),o("init",null);break;case"demux":r.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS)}}),i.on(s.default.FRAG_DECRYPTED,o),i.on(s.default.FRAG_PARSING_INIT_SEGMENT,o),i.on(s.default.FRAG_PARSED,o),i.on(s.default.ERROR,o),i.on(s.default.FRAG_PARSING_METADATA,o),i.on(s.default.FRAG_PARSING_USERDATA,o),i.on(s.default.INIT_PTS_FOUND,o),i.on(s.default.FRAG_PARSING_DATA,function(e,t){var n=[],e={event:e,data:t};t.data1&&(e.data1=t.data1.buffer,n.push(t.data1.buffer),delete t.data1),t.data2&&(e.data2=t.data2.buffer,n.push(t.data2.buffer),delete t.data2),r.postMessage(e,n)})}},"./src/demux/demuxer.js":function(e,r,i){"use strict";!function(p){Object.defineProperty(r,"__esModule",{value:!0});var u=i("./node_modules/webworkify-webpack/index.js"),c=i("./src/events.js"),d=i("./src/demux/demuxer-inline.js"),y=i("./src/utils/logger.js"),f=i("./src/errors.js"),e=i("./src/utils/mediasource-helper.js"),t=i("./src/utils/get-self-scope.js"),h=i("./src/observer.js"),g=t.getSelfScope(),m=e.getMediaSource(),e=(n.prototype.destroy=function(){var e=this.w;e?(e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null):(t=this.demuxer)&&(t.destroy(),this.demuxer=null);var t=this.observer;t&&(t.removeAllListeners(),this.observer=null)},n.prototype.push=function(e,t,n,r,i,o,a,s){var l=this.w,u=p.isFinite(i.startPTS)?i.startPTS:i.start,c=i.decryptdata,d=this.frag,f=!(d&&i.cc===d.cc),h=!(d&&i.level===d.level),d=d&&i.sn===d.sn+1,d=!h&&d;f&&y.logger.log(this.id+":discontinuity detected"),h&&y.logger.log(this.id+":switch detected"),this.frag=i,l?l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:n,videoCodec:r,timeOffset:u,discontinuity:f,trackSwitch:h,contiguous:d,duration:o,accurateTimeOffset:a,defaultInitPTS:s},e instanceof ArrayBuffer?[e]:[]):(l=this.demuxer)&&l.push(e,c,t,n,r,u,f,h,d,o,a,s)},n.prototype.onWorkerMessage=function(e){var t=e.data,n=this.hls;switch(t.event){case"init":g.URL.revokeObjectURL(this.w.objectURL);break;case c.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}},n);function n(n,e){var r=this;this.hls=n,this.id=e;function t(e,t){(t=t||{}).frag=r.frag,t.id=r.id,n.trigger(e,t)}var i=this.observer=new h.Observer,o=n.config;i.on(c.default.FRAG_DECRYPTED,t),i.on(c.default.FRAG_PARSING_INIT_SEGMENT,t),i.on(c.default.FRAG_PARSING_DATA,t),i.on(c.default.FRAG_PARSED,t),i.on(c.default.ERROR,t),i.on(c.default.FRAG_PARSING_METADATA,t),i.on(c.default.FRAG_PARSING_USERDATA,t),i.on(c.default.INIT_PTS_FOUND,t);var a={mp4:m.isTypeSupported("video/mp4"),mpeg:m.isTypeSupported("audio/mpeg"),mp3:m.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(o.enableWorker&&"undefined"!=typeof Worker){y.logger.log("demuxing in webworker");var l=void 0;try{l=this.w=u("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),l.addEventListener("message",this.onwmsg),l.onerror=function(e){n.trigger(c.default.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},l.postMessage({cmd:"init",typeSupported:a,vendor:s,id:e,config:JSON.stringify(o)})}catch(n){y.logger.warn("Error in worker:",n),y.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),l&&g.URL.revokeObjectURL(l.objectURL),this.demuxer=new d.default(i,a,o,s),this.w=void 0}}else this.demuxer=new d.default(i,a,o,s)}r.default=e}.call(this,i("./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./src/utils/logger.js"),n=(i.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),t=Math.min(4,t);if(0===t)throw new Error("no bytes available");r.set(e.subarray(n,n+t)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*t,this.bytesAvailable-=t},i.prototype.skipBits=function(e){var t;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},i.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return 32<e&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?n<<t|this.readBits(t):n},i.prototype.skipLZ=function(){for(var e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},i.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},i.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},i.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},i.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},i.prototype.readBoolean=function(){return 1===this.readBits(1)},i.prototype.readUByte=function(){return this.readBits(8)},i.prototype.readUShort=function(){return this.readBits(16)},i.prototype.readUInt=function(){return this.readBits(32)},i.prototype.skipScalingList=function(e){for(var t=8,n=8,r=0;r<e;r++)t=0===(n=0!==n?(t+this.readEG()+256)%256:n)?t:n},i.prototype.readSPS=function(){var e,t,n,r,i=0,o=0,a=0,s=0,l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),f=this.skipBits.bind(this),h=this.skipEG.bind(this),p=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(l(),e=l(),u(5),f(3),l(),p(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var g=c();if(3===g&&f(1),p(),p(),f(1),d())for(n=3!==g?8:12,r=0;r<n;r++)d()&&y(r<6?16:64)}p();var g=c();if(0===g)c();else if(1===g)for(f(1),h(),h(),t=c(),r=0;r<t;r++)h();p(),f(1),g=c(),p=c(),0===(u=u(1))&&f(1),f(1),d()&&(i=c(),o=c(),a=c(),s=c());var m=[1,1];if(d()&&d())switch(l()){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[l()<<8|l(),l()<<8|l()]}return{width:Math.ceil(16*(g+1)-2*i-2*o),height:(2-u)*(p+1)*16-(u?2:4)*(a+s),pixelRatio:m}},i.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},i);function i(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}t.default=n},"./src/demux/id3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(s.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},s.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},s.getID3Data=function(e,t){for(var n=t,r=0;s.isHeader(e,t);)r+=10,r+=s._readSize(e,t+6),s.isFooter(e,t+10)&&(r+=10),t+=r;if(0<r)return e.subarray(n,n+r)},s._readSize=function(e,t){var n=0,n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]},s.getTimeStamp=function(e){for(var t=s.getID3Frames(e),n=0;n<t.length;n++){var r=t[n];if(s.isTimeStampFrame(r))return s._readTimeStamp(r)}},s.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},s._getFrameData=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=s._readSize(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},s.getID3Frames=function(e){for(var t=0,n=[];s.isHeader(e,t);){for(var r=s._readSize(e,t+6),i=(t+=10)+r;t+8<i;){var o=s._getFrameData(e.subarray(t)),a=s._decodeFrame(o);a&&n.push(a),t+=o.size+10}s.isFooter(e,t)&&(t+=10)}return n},s._decodeFrame=function(e){return"PRIV"===e.type?s._decodePrivFrame(e):"T"===e.type[0]?s._decodeTextFrame(e):"W"===e.type[0]?s._decodeURLFrame(e):void 0},s._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),e=1&t[3],t=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return t/=45,e&&(t+=47721858.84),Math.round(t)}},s._decodePrivFrame=function(e){if(!(e.size<2)){var t=s._utf8ArrayToStr(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}},s._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,n=s._utf8ArrayToStr(e.data.subarray(1));t+=n.length+1;t=s._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:n,data:t}}t=s._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:t}}},s._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,n=s._utf8ArrayToStr(e.data.subarray(1));t+=n.length+1;t=s._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:n,data:t}}t=s._utf8ArrayToStr(e.data);return{key:e.type,data:t}},s._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);for(var n,r,i,o=e.length,a="",s=0;s<o;){if(0===(n=e[s++])&&t)return a;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:r=e[s++],a+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=e[s++],i=e[s++],a+=String.fromCharCode((15&n)<<12|(63&r)<<6|(63&i)<<0)}}return a},s);function s(){}t.utf8ArrayToStr=r._utf8ArrayToStr,t.default=r},"./src/demux/mp3demuxer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=n("./src/demux/id3.js"),i=n("./src/utils/logger.js"),y=n("./src/demux/mpegaudio.js"),n=(r.prototype.resetInitSegment=function(e,t,n,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},r.prototype.resetTimeStamp=function(){},r.probe=function(e){var t,n,r=p.default.getID3Data(e,0);if(r&&void 0!==p.default.getTimeStamp(r))for(t=r.length,n=Math.min(e.length-1,t+100);t<n;t++)if(y.default.probe(e,t))return i.logger.log("MPEG Audio sync word found !"),!0;return!1},r.prototype.append=function(e,t,n,r){for(var i=p.default.getID3Data(e,0),o=p.default.getTimeStamp(i),a=o?90*o:9e4*t,s=i.length,l=e.length,u=0,c=0,d=this._audioTrack,f=[{pts:a,dts:a,data:i}];s<l;)if(y.default.isHeader(e,s)){var h=y.default.appendFrame(d,e,s,a,u);if(!h)break;s+=h.length,c=h.sample.pts,u++}else p.default.isHeader(e,s)?(i=p.default.getID3Data(e,s),f.push({pts:c,dts:c,data:i}),s+=i.length):s++;this.remuxer.remux(d,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,n,r)},r.prototype.destroy=function(){},r);function r(e,t,n){this.observer=e,this.config=n,this.remuxer=t}t.default=n},"./src/demux/mp4demuxer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./src/utils/logger.js"),s=n("./src/events.js"),a=Math.pow(2,32)-1,n=(f.prototype.resetTimeStamp=function(e){this.initPTS=e},f.prototype.resetInitSegment=function(e,t,n,r){var i,o;e&&e.byteLength?(null==t&&(t="mp4a.40.5"),null==n&&(n="avc1.42e01e"),o={},(i=this.initData=f.parseInitSegment(e)).audio&&i.video?o.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:r?e:null}:(i.audio&&(o.audio={container:"audio/mp4",codec:t,initSegment:r?e:null}),i.video&&(o.video={container:"video/mp4",codec:n,initSegment:r?e:null})),this.observer.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})):(t&&(this.audioCodec=t),n&&(this.videoCodec=n))},f.probe=function(e){return 0<f.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length},f.bin2str=function(e){return String.fromCharCode.apply(null,e)},f.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);t=e[t]<<8|e[t+1];return t<0?65536+t:t},f.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);t=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return t<0?4294967296+t:t},f.writeUint32=function(e,t,n){e.data&&(t+=e.start,e=e.data),e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n},f.findBox=function(e,t){var n,r,i,o,a,s=[];if(e.data?(o=e.start,r=e.end,e=e.data):(o=0,r=e.byteLength),!t.length)return null;for(n=o;n<r;)a=1<(i=f.readUint32(e,n))?n+i:r,f.bin2str(e.subarray(n+4,n+8))===t[0]&&(1===t.length?s.push({data:e,start:n+8,end:a}):(i=f.findBox({data:e,start:n+8,end:a},t.slice(1))).length&&(s=s.concat(i))),n=a;return s},f.parseSegmentIndex=function(e){var t=f.findBox(e,["moov"])[0],t=t?t.end:null,n=0,r=f.findBox(e,["sidx"]);if(!r||!r[0])return null;var i=[],e=(r=r[0]).data[0],n=0===e?8:16,o=f.readUint32(r,n);n+=4,n+=0===e?8:16;var a=r.end+0,s=f.readUint16(r,n+=2);n+=2;for(var l=0;l<s;l++){var u=n,c=f.readUint32(r,u);u+=4;var d=2147483647&c;if(1==(2147483648&c)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");c=f.readUint32(r,u);u+=4,i.push({referenceSize:d,subsegmentDuration:c,info:{duration:c/o,start:a,end:a+d-1}}),a+=d,n=u+=4}return{earliestPresentationTime:0,timescale:o,version:e,referencesCount:s,references:i,moovEndOffset:t}},f.parseInitSegment=function(e){var i=[];return f.findBox(e,["moov","trak"]).forEach(function(e){var t,n,r=f.findBox(e,["tkhd"])[0];r&&(n=0===r.data[r.start]?12:20,t=f.readUint32(r,n),(r=f.findBox(e,["mdia","mdhd"])[0])&&(n=0===r.data[r.start]?12:20,r=f.readUint32(r,n),!(n=f.findBox(e,["mdia","hdlr"])[0])||(n={soun:"audio",vide:"video"}[f.bin2str(n.data.subarray(n.start+8,n.start+12))])&&((e=f.findBox(e,["mdia","minf","stbl","stsd"])).length&&(e=e[0],e=f.bin2str(e.data.subarray(e.start+12,e.start+16)),o.logger.log("MP4Demuxer:"+n+":"+e+" found")),i[t]={timescale:r,type:n},i[n]={timescale:r,id:t})))}),i},f.getStartDTS=function(n,e){var e=f.findBox(e,["moof","traf"]),e=[].concat.apply([],e.map(function(t){return f.findBox(t,["tfhd"]).map(function(e){var e=f.readUint32(e,4),e=n[e].timescale||9e4;return f.findBox(t,["tfdt"]).map(function(e){var t=e.data[e.start],n=f.readUint32(e,4);return 1===t&&(n*=Math.pow(2,32),n+=f.readUint32(e,8)),n})[0]/e})})),e=Math.min.apply(null,e);return isFinite(e)?e:0},f.offsetStartDTS=function(n,e,i){f.findBox(e,["moof","traf"]).map(function(t){return f.findBox(t,["tfhd"]).map(function(e){var e=f.readUint32(e,4),r=n[e].timescale||9e4;f.findBox(t,["tfdt"]).map(function(e){var t=e.data[e.start],n=f.readUint32(e,4);0===t?f.writeUint32(e,4,n-i*r):(n*=Math.pow(2,32),n+=f.readUint32(e,8),n-=i*r,n=Math.max(n,0),t=Math.floor(n/(1+a)),n=Math.floor(n%(1+a)),f.writeUint32(e,4,t),f.writeUint32(e,8,n))})})})},f.prototype.append=function(e,t,n,r){var i=this.initData;i||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),i=this.initData);var o,a=this.initPTS;void 0===a&&(o=f.getStartDTS(i,e),this.initPTS=a=o-t,this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:a})),f.offsetStartDTS(i,e,a),a=f.getStartDTS(i,e),this.remuxer.remux(i.audio,i.video,null,null,a,n,r,e)},f.prototype.destroy=function(){},f);function f(e,t){this.observer=e,this.remuxer=t}t.default=n},"./src/demux/mpegaudio.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,n,r,i){if(!(n+24>t.length)){var o=this.parseHeader(t,n);if(o&&n+o.frameLength<=t.length){i=r+i*(9e4*o.samplesPerFrame/o.sampleRate),i={unit:t.subarray(n,n+o.frameLength),pts:i,dts:i};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(i),e.len+=o.frameLength,{sample:i,length:o.frameLength}}}},parseHeader:function(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3,a=e[t+2]>>1&1;if(1!=n&&0!=i&&15!=i&&3!=o){i=1e3*s.BitratesMap[14*(3==n?3-r:3==r?3:4)+i-1],o=s.SamplingRateMap[3*(3==n?0:2==n?1:2)+o],e=e[t+3]>>6==3?1:2,t=s.SamplesCoefficients[n][r],n=s.BytesInSlot[r],r=8*t*n;return{sampleRate:o,channelCount:e,frameLength:parseInt(t*i/o+a,10)*n,samplesPerFrame:r}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var n=this.parseHeader(e,t),r=4,r=t+(r=n&&n.frameLength?n.frameLength:r);if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}};t.default=s},"./src/demux/sample-aes.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("./src/crypt/decrypter.js"),n=(r.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},r.prototype.decryptAacSample=function(t,n,r,i){var o=t[n].unit,e=o.subarray(16,o.length-o.length%16),e=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),a=this;this.decryptBuffer(e,function(e){e=new Uint8Array(e),o.set(e,16),i||a.decryptAacSamples(t,n+1,r)})},r.prototype.decryptAacSamples=function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,r),!r)return}}},r.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),r=0,i=32;i<=e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n},r.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var n=0,r=32;r<=e.length-16;r+=160,n+=16)e.set(t.subarray(n,n+16),r);return e},r.prototype.decryptAvcSample=function(t,n,r,i,o,a){var s=this.discardEPB(o.data),e=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(e.buffer,function(e){o.data=l.getAvcDecryptedUnit(s,e),a||l.decryptAvcSamples(t,n,r+1,i)})},r.prototype.decryptAvcSamples=function(e,t,n,r){for(;;t++,n=0){if(t>=e.length)return void r();for(var i=e[t].units;!(n>=i.length);n++){var o=i[n];if(!(o.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,r,o,a),!a)return}}}},r);function r(e,t,n,r){this.decryptdata=n,this.discardEPB=r,this.decrypter=new i.default(e,t,{removePKCS7Padding:!1})}t.default=n},"./src/demux/tsdemuxer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=n("./src/demux/adts.js"),s=n("./src/demux/mpegaudio.js"),C=n("./src/events.js"),A=n("./src/demux/exp-golomb.js"),r=n("./src/demux/sample-aes.js"),D=n("./src/utils/logger.js"),x=n("./src/errors.js"),i={video:1,audio:2,id3:3,text:4},n=(I.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new r.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},I.probe=function(e){e=I._syncOffset(e);return!(e<0||(e&&D.logger.warn("MPEG2-TS detected but first sync word found @ offset "+e+", junk ahead ?"),0))},I._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71===e[n]&&71===e[n+188]&&71===e[n+376])return n;n++}return-1},I.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:i[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},I.prototype.resetInitSegment=function(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=I.createTrack("video",r),this._audioTrack=I.createTrack("audio",r),this._id3Track=I.createTrack("id3",r),this._txtTrack=I.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=n,this._duration=r},I.prototype.resetTimeStamp=function(){},I.prototype.append=function(e,t,n,r){var i,o,a,s,l,u=e.length,c=!1;this.contiguous=n;var d=this.pmtParsed,f=this._avcTrack,h=this._audioTrack,p=this._id3Track,y=f.pid,g=h.pid,m=p.pid,v=this._pmtId,b=f.pesData,_=h.pesData,E=p.pesData,k=this._parsePAT,A=this._parsePMT,S=this._parsePES,w=this._parseAVCPES.bind(this),T=this._parseAACPES.bind(this),P=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),L=I._syncOffset(e);for(u-=(u+L)%188,i=L;i<u;i+=188)if(71===e[i]){if(o=!!(64&e[i+1]),a=((31&e[i+1])<<8)+e[i+2],1<(48&e[i+3])>>4){if((s=i+5+e[i+4])===i+188)continue}else s=i+4;switch(a){case y:o&&(b&&(l=S(b))&&void 0!==l.pts&&w(l,!1),b={data:[],size:0}),b&&(b.data.push(e.subarray(s,i+188)),b.size+=i+188-s);break;case g:o&&(_&&(l=S(_))&&void 0!==l.pts&&(h.isAAC?T:P)(l),_={data:[],size:0}),_&&(_.data.push(e.subarray(s,i+188)),_.size+=i+188-s);break;case m:o&&(E&&(l=S(E))&&void 0!==l.pts&&O(l),E={data:[],size:0}),E&&(E.data.push(e.subarray(s,i+188)),E.size+=i+188-s);break;case 0:o&&(s+=e[s]+1),v=this._pmtId=k(e,s);break;case v:o&&(s+=e[s]+1);var R=A(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(y=R.avc)&&(f.pid=y),0<(g=R.audio)&&(h.pid=g,h.isAAC=R.isAAC),0<(m=R.id3)&&(p.pid=m),c&&!d&&(D.logger.log("reparse from beginning"),c=!1,i=L-188),d=this.pmtParsed=!0;break;case 17:case 8191:break;default:c=!0}}else this.observer.trigger(C.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(l=S(b))&&void 0!==l.pts?(w(l,!0),f.pesData=null):f.pesData=b,_&&(l=S(_))&&void 0!==l.pts?((h.isAAC?T:P)(l),h.pesData=null):(_&&_.size&&D.logger.log("last AAC PES packet truncated,might overlap between fragments"),h.pesData=_),E&&(l=S(E))&&void 0!==l.pts?(O(l),p.pesData=null):p.pesData=E,null==this.sampleAes?this.remuxer.remux(h,f,p,this._txtTrack,t,n,r):this.decryptAndRemux(h,f,p,this._txtTrack,t,n,r)},I.prototype.decryptAndRemux=function(e,t,n,r,i,o,a){var s;e.samples&&e.isAAC?(s=this).sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,n,r,i,o,a)}):this.decryptAndRemuxAvc(e,t,n,r,i,o,a)},I.prototype.decryptAndRemuxAvc=function(e,t,n,r,i,o,a){var s;t.samples?(s=this).sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,n,r,i,o,a)}):this.remuxer.remux(e,t,n,r,i,o,a)},I.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},I.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},I.prototype._parsePMT=function(e,t,n,r){var i,o={audio:-1,avc:-1,id3:-1,isAAC:!0},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(i=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){D.logger.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=i);break;case 21:-1===o.id3&&(o.id3=i);break;case 219:if(!r){D.logger.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=i);break;case 3:case 4:n?-1===o.audio&&(o.audio=i,o.isAAC=!1):D.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:D.logger.warn("HEVC stream type found, not supported for now");break;default:D.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o},I.prototype._parsePES=function(e){var t,n,r,i,o,a,s=0,l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&1<l.length;){var u=new Uint8Array(l[0].length+l[1].length);u.set(l[0]),u.set(l[1],l[0].length),l[0]=u,l.splice(1,1)}if(1!==((t=l[0])[0]<<16)+(t[1]<<8)+t[2])return null;if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&(4294967295<(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)&&(i-=8589934592),64&r?(4294967295<(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(o-=8589934592),54e5<i-o&&(D.logger.warn(Math.round((i-o)/9e4)+"s delta between PTS and DTS, align them"),i=o)):o=i),a=(r=t[8])+9,e.size-=a;for(var c=new Uint8Array(e.size),d=0,f=l.length;d<f;d++){var h=(t=l[d]).byteLength;if(a){if(h<a){a-=h;continue}t=t.subarray(a),h-=a,a=0}c.set(t,s),s+=h}return n&&(n-=r+3),{data:c,pts:i,dts:o,len:n}},I.prototype.pushAccesUnit=function(e,t){var n,r;e.units.length&&e.frame&&(r=(n=t.samples).length,!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,n.push(e)):t.dropped++),e.debug.length&&D.logger.log(e.pts+"/"+e.dts+":"+e.debug)},I.prototype._parseAVCPES=function(h,e){function p(e,t,n,r){return{key:e,pts:t,dts:n,units:[],debug:r}}var y,g,m,v=this,b=this._avcTrack,t=this._parseAVCNALu(h.data),_=this.avcSample,E=!1,k=this.pushAccesUnit.bind(this);h.data=null,_&&t.length&&!b.audFound&&(k(_,b),_=this.avcSample=p(!1,h.pts,h.dts,"")),t.forEach(function(e){switch(e.type){case 1:g=!0,(_=_||(v.avcSample=p(!0,h.pts,h.dts,""))).frame=!0;var t=e.data;E&&4<t.length&&(2!==(u=new A.default(t).readSliceType())&&4!==u&&7!==u&&9!==u||(_.key=!0));break;case 5:g=!0,(_=_||(v.avcSample=p(!0,h.pts,h.dts,""))).key=!0,_.frame=!0;break;case 6:g=!0,(y=new A.default(v.discardEPB(e.data))).readUByte();for(var n=0,r=0,i=!1,o=0;!i&&1<y.bytesAvailable;){for(n=0;n+=o=y.readUByte(),255===o;);for(r=0;r+=o=y.readUByte(),255===o;);if(4===n&&0!==y.bytesAvailable){if(i=!0,181===y.readUByte()&&49===y.readUShort()&&1195456820===y.readUInt()&&3===y.readUByte()){var a=y.readUByte(),s=31&a,l=[a,y.readUByte()];for(m=0;m<s;m++)l.push(y.readUByte()),l.push(y.readUByte()),l.push(y.readUByte());v._insertSampleInOrder(v._txtTrack.samples,{type:3,pts:h.pts,bytes:l})}}else if(r<y.bytesAvailable)for(m=0;m<r;m++)y.readUByte()}break;case 7:if(E=g=!0,!b.sps){var u=(y=new A.default(e.data)).readSPS();b.width=u.width,b.height=u.height,b.pixelRatio=u.pixelRatio,b.sps=[e.data],b.duration=v._duration;var c=e.data.subarray(1,4),d="avc1.";for(m=0;m<3;m++){var f=c[m].toString(16);d+=f=f.length<2?"0"+f:f}b.codec=d}break;case 8:g=!0,b.pps||(b.pps=[e.data]);break;case 9:g=!1,b.audFound=!0,_&&k(_,b),_=v.avcSample=p(!1,h.pts,h.dts,"");break;case 12:g=!1;break;default:g=!1,_&&(_.debug+="unknown NAL "+e.type+" ")}_&&g&&_.units.push(e)}),e&&_&&(k(_,b),this.avcSample=null)},I.prototype._insertSampleInOrder=function(e,t){var n=e.length;if(0<n){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;0<=r;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)},I.prototype._getLastNalUnit=function(){var e,t,n=this.avcSample;return t=(n=!n||0===n.units.length?(e=this._avcTrack.samples)[e.length-1]:n)?(n=n.units)[n.length-1]:t},I.prototype._parseAVCNALu=function(e){var t,n,r,i,o,a,s=0,l=e.byteLength,u=this._avcTrack,c=u.naluState||0,d=c,f=[],h=-1;for(-1===c&&(i=31&e[h=0],c=0,s=1);s<l;)t=e[s++],c=c?1!==c?t?1===t?(0<=h?(r={data:e.subarray(h,s-c-1),type:i},f.push(r)):(o=this._getLastNalUnit())&&(d&&s<=4-d&&o.state&&(o.data=o.data.subarray(0,o.data.byteLength-d)),0<(n=s-c-1)&&((a=new Uint8Array(o.data.byteLength+n)).set(o.data,0),a.set(e.subarray(0,n),o.data.byteLength),o.data=a)),s<l?(i=31&e[h=s],0):-1):0:3:t?0:2:t?0:1;return 0<=h&&0<=c&&(r={data:e.subarray(h,l),type:i,state:c},f.push(r)),0===f.length&&(o=this._getLastNalUnit())&&((a=new Uint8Array(o.data.byteLength+e.byteLength)).set(o.data,0),a.set(e,o.data.byteLength),o.data=a),u.naluState=c,f},I.prototype.discardEPB=function(e){for(var t=e.byteLength,n=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;for(var i=t-n.length,o=new Uint8Array(i),a=0,r=0;r<i;a++,r++)a===n[0]&&(a++,n.shift()),o[r]=e[a];return o},I.prototype._parseAACPES=function(e){var t,n,r,i,o=this._audioTrack,a=e.data,s=e.pts,l=this.aacOverFlow,e=this.aacLastPTS;for(l&&((u=new Uint8Array(l.byteLength+a.byteLength)).set(l,0),u.set(a,l.byteLength),a=u),n=0,i=a.length;n<i-1&&!f.isHeader(a,n);n++);if(n){var u=void 0,c=void 0,c=n<i-1?(u="AAC PES did not start with ADTS header,offset:"+n,!1):(u="no ADTS header found in AAC PES",!0);if(D.logger.warn("parsing error:"+u),this.observer.trigger(C.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:c,reason:u}),c)return}for(f.initTrackConfig(o,this.observer,a,n,this.audioCodec),t=0,c=f.getFrameDuration(o.samplerate),l&&e&&(c=e+c,1<Math.abs(c-s)&&(D.logger.log("AAC: align PTS for overlapping frames by "+Math.round((c-s)/90)),s=c));n<i;)if(f.isHeader(a,n)&&n+5<i){var d=f.appendFrame(o,a,n,s,t);if(!d)break;n+=d.length,r=d.sample.pts,t++}else n++;l=n<i?a.subarray(n,i):null,this.aacOverFlow=l,this.aacLastPTS=r},I.prototype._parseMPEGPES=function(e){for(var t=e.data,n=t.length,r=0,i=0,o=e.pts;i<n;)if(s.default.isHeader(t,i)){var a=s.default.appendFrame(this._audioTrack,t,i,o,r);if(!a)break;i+=a.length,r++}else i++},I.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},I);function I(e,t,n,r){this.observer=e,this.config=n,this.typeSupported=r,this.remuxer=t,this.sampleAes=null}t.default=n},"./src/errors.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./src/utils/logger.js"),i=n("./src/errors.js"),o=n("./src/events.js"),a={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},n=(s.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},s.prototype.onHandlerDestroying=function(){},s.prototype.onHandlerDestroyed=function(){},s.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},s.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(a[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},s.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},s.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},s.prototype.onEventGeneric=function(e,t){try{!function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)}.call(this,e,t).call()}catch(t){r.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(o.default.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},s);function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.hls=e,this.onEvent=this.onEvent.bind(this),this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}t.default=n},"./src/events.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var g,o=n("./node_modules/url-toolkit/src/url-toolkit.js"),a=n("./src/errors.js"),m=n("./src/loader/playlist-loader.js"),v=n("./src/loader/fragment-loader.js"),b=n("./src/loader/key-loader.js"),_=n("./src/controller/fragment-tracker.js"),E=n("./src/controller/stream-controller.js"),k=n("./src/controller/level-controller.js"),A=n("./src/controller/id3-track-controller.js"),s=n("./src/is-supported.js"),S=n("./src/utils/logger.js"),l=n("./src/config.js"),u=n("./src/events.js"),i=(g=n("./src/observer.js").Observer,i(w,g),Object.defineProperty(w,"version",{get:function(){return"0.12.2"},enumerable:!0,configurable:!0}),w.isSupported=function(){return s.isSupported()},Object.defineProperty(w,"Events",{get:function(){return u.default},enumerable:!0,configurable:!0}),Object.defineProperty(w,"ErrorTypes",{get:function(){return a.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(w,"ErrorDetails",{get:function(){return a.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(w,"DefaultConfig",{get:function(){return w.defaultConfig||l.hlsDefaultConfig},set:function(e){w.defaultConfig=e},enumerable:!0,configurable:!0}),w.prototype.destroy=function(){S.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},w.prototype.attachMedia=function(e){S.logger.log("attachMedia"),this.media=e,this.trigger(u.default.MEDIA_ATTACHING,{media:e})},w.prototype.detachMedia=function(){S.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null},w.prototype.loadSource=function(e){e=o.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),S.logger.log("loadSource:"+e),this.url=e,this.trigger(u.default.MANIFEST_LOADING,{url:e})},w.prototype.startLoad=function(t){void 0===t&&(t=-1),S.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},w.prototype.stopLoad=function(){S.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},w.prototype.swapAudioCodec=function(){S.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},w.prototype.recoverMediaError=function(){S.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Object.defineProperty(w.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(e){S.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(e){S.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(e){S.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){S.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(e){S.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(e){S.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"minAutoLevel",{get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,n=e?e.length:0,r=0;r<n;r++)if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>t)return r;return 0},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"maxAutoLevel",{get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"audioTracks",{get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"audioTrack",{get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"subtitleTracks",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"subtitleTrack",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"subtitleDisplay",{get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)},enumerable:!0,configurable:!0}),w);function w(e){void 0===e&&(e={});var t,n=g.call(this)||this,r=w.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(t in r)t in e||(e[t]=r[t]);if(void 0!==e.liveMaxLatencyDurationCount&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||void 0===e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');S.enableLogs(e.debug),n.config=e,n._autoLevelCapping=-1;var i=n.abrController=new e.abrController(n),o=new e.bufferController(n),a=new e.capLevelController(n),s=new e.fpsController(n),l=new m.default(n),u=new v.default(n),c=new b.default(n),d=new A.default(n),f=n.levelController=new k.default(n),h=new _.FragmentTracker(n),p=[f,n.streamController=new E.default(n,h)],f=e.audioStreamController;f&&p.push(new f(n,h)),n.networkControllers=p;var y,s=[l,u,c,i,o,a,s,d,h];return(f=e.audioTrackController)&&(d=new f(n),n.audioTrackController=d,s.push(d)),(f=e.subtitleTrackController)&&(y=new f(n),n.subtitleTrackController=y,s.push(y)),(f=e.emeController)&&(y=new f(n),n.emeController=y,s.push(y)),(f=e.subtitleStreamController)&&s.push(new f(n,h)),(f=e.timelineController)&&s.push(new f(n)),n.coreComponents=s,n}t.default=i},"./src/is-supported.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./src/utils/mediasource-helper.js");t.isSupported=function(){var e=r.getMediaSource(),t=window.SourceBuffer||window.WebKitSourceBuffer,e=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!e&&!!t}},"./src/loader/fragment-loader.js":function(e,u,c){"use strict";!function(s){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(u,"__esModule",{value:!0});var i,o=c("./src/events.js"),t=c("./src/event-handler.js"),a=c("./src/errors.js"),l=c("./src/utils/logger.js"),e=(i=t.default,e(n,i),n.prototype.destroy=function(){var e,t=this.loaders;for(e in t){var n=t[e];n&&n.destroy()}this.loaders={},i.prototype.destroy.call(this)},n.prototype.onFragLoading=function(e){var t=e.frag,n=t.type,r=this.loaders,i=this.hls.config,o=i.fLoader,a=i.loader;t.loaded=0,(e=r[n])&&(l.logger.warn("abort previous fragment loader for type: "+n),e.abort());var e=r[n]=t.loader=new(i.fLoader?o:a)(i),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1},a=t.byteRangeStartOffset,t=t.byteRangeEndOffset;s.isFinite(a)&&s.isFinite(t)&&(o.rangeStart=a,o.rangeEnd=t),t={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},i={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},e.load(o,t,i)},n.prototype.loadsuccess=function(e,t,n,r){void 0===r&&(r=null);e=e.data,n=n.frag;n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(o.default.FRAG_LOADED,{payload:e,frag:n,stats:t,networkDetails:r})},n.prototype.loaderror=function(e,t,n){void 0===n&&(n=null);var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[r.type]=void 0,this.hls.trigger(o.default.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:n})},n.prototype.loadtimeout=function(e,t,n){void 0===n&&(n=null);var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[r.type]=void 0,this.hls.trigger(o.default.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:n})},n.prototype.loadprogress=function(e,t,n,r){void 0===r&&(r=null);t=t.frag;t.loaded=e.loaded,this.hls.trigger(o.default.FRAG_LOAD_PROGRESS,{frag:t,stats:e,networkDetails:r})},n);function n(e){e=i.call(this,e,o.default.FRAG_LOADING)||this;return e.loaders={},e}u.default=e}.call(this,c("./src/polyfills/number.js").Number)},"./src/loader/fragment.js":function(e,o,a){"use strict";!function(t){Object.defineProperty(o,"__esModule",{value:!0});var e=a("./node_modules/url-toolkit/src/url-toolkit.js"),r=a("./src/loader/level-key.js"),n=(Object.defineProperty(i,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=e.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e,t,n=[];return this.rawByteRange&&(1===(e=this.rawByteRange.split("@",2)).length?(t=this.lastByteRangeEndOffset,n[0]=t||0):n[0]=parseInt(e[1]),n[1]=parseInt(e[0])+n[0],this._byteRange=n),n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"endProgramDateTime",{get:function(){if(!t.isFinite(this.programDateTime))return null;var e=t.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),i.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},i.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},i.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},i.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var n=e;return e&&e.method&&e.uri&&!e.iv&&((n=new r.default).method=e.method,n.baseuri=e.baseuri,n.reluri=e.reluri,n.iv=this.createInitializationVector(t)),n},i);function i(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[i.ElementaryStreamTypes.AUDIO]=!1,e[i.ElementaryStreamTypes.VIDEO]=!1,e)}o.default=n}.call(this,a("./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n("./src/events.js"),s=n("./src/event-handler.js"),l=n("./src/errors.js"),u=n("./src/utils/logger.js"),i=(o=s.default,i(c,o),c.prototype.destroy=function(){for(var e in this.loaders){e=this.loaders[e];e&&e.destroy()}this.loaders={},s.default.prototype.destroy.call(this)},c.prototype.onKeyLoading=function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=t.decryptdata,o=i.uri;o!==this.decrypturl||null===this.decryptkey?(e=this.hls.config,r&&(u.logger.warn("abort previous key loader for type:"+n),r.abort()),t.loader=this.loaders[n]=new e.loader(e),this.decrypturl=o,this.decryptkey=null,n={url:o,frag:t,responseType:"arraybuffer"},o={timeout:e.fragLoadingTimeOut,maxRetry:0,retryDelay:e.fragLoadingRetryDelay,maxRetryDelay:e.fragLoadingMaxRetryTimeout},e={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(n,o,e)):this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))},c.prototype.loadsuccess=function(e,t,n){n=n.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:n})},c.prototype.loaderror=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})},c.prototype.loadtimeout=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},c);function c(e){e=o.call(this,e,a.default.KEY_LOADING)||this;return e.loaders={},e.decryptkey=null,e.decrypturl=null,e}t.default=i},"./src/loader/level-key.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./node_modules/url-toolkit/src/url-toolkit.js"),n=(Object.defineProperty(i.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=r.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),i);function i(){this.method=null,this.key=null,this.iv=null,this._uri=null}t.default=n},"./src/loader/level.js":function(e,r,t){"use strict";!function(e){Object.defineProperty(r,"__esModule",{value:!0});var t=(Object.defineProperty(n.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!e.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),n);function n(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}r.default=t}.call(this,t("./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":function(e,t,r){"use strict";!function(S){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./node_modules/url-toolkit/src/url-toolkit.js"),w=r("./src/loader/fragment.js"),T=r("./src/loader/level.js"),P=r("./src/loader/level-key.js"),O=r("./src/utils/attr-list.js"),L=r("./src/utils/logger.js"),a=r("./src/utils/codecs.js"),s=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,l=/#EXT-X-MEDIA:(.*)/g,R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),C=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,D=/\.(mp4|m4s|m4v|m4a)$/i,e=(u.findGroup=function(e,t){if(!e)return null;for(var n=null,r=0;r<e.length;r++){var i=e[r];i.id===t&&(n=i)}return n},u.convertAVC1ToAVCOTI=function(e){var t,n=e.split(".");return 2<n.length?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t},u.resolve=function(e,t){return n.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},u.parseMasterPlaylist=function(e,t){var n=[];for(s.lastIndex=0;null!=(o=s.exec(e));){var r={},i=r.attrs=new O.default(o[1]);r.url=u.resolve(o[2],t);var o=i.decimalResolution("RESOLUTION");o&&(r.width=o.width,r.height=o.height),r.bitrate=i.decimalInteger("AVERAGE-BANDWIDTH")||i.decimalInteger("BANDWIDTH"),r.name=i.NAME,function(r,i){["video","audio"].forEach(function(t){var e,n=r.filter(function(e){return a.isCodecType(e,t)});n.length&&(e=n.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}),i[t+"Codec"]=(0<e.length?e:n)[0],r=r.filter(function(e){return-1===n.indexOf(e)}))}),i.unknownCodecs=r}([].concat((i.CODECS||"").split(/[ ,]+/)),r),r.videoCodec&&-1!==r.videoCodec.indexOf("avc1")&&(r.videoCodec=u.convertAVC1ToAVCOTI(r.videoCodec)),n.push(r)}return n},u.parseMasterPlaylistMedia=function(e,t,n,r){void 0===r&&(r=[]);var i=[],o=0;for(l.lastIndex=0;null!==(s=l.exec(e));){var a={},s=new O.default(s[1]);s.TYPE===n&&(a.groupId=s["GROUP-ID"],a.name=s.NAME,a.type=n,a.default="YES"===s.DEFAULT,a.autoselect="YES"===s.AUTOSELECT,a.forced="YES"===s.FORCED,s.URI&&(a.url=u.resolve(s.URI,t)),a.lang=s.LANGUAGE,a.name||(a.name=a.lang),r.length&&(s=u.findGroup(r,a.groupId),a.audioCodec=(s||r[0]).codec),a.id=o++,i.push(a))}return i},u.parseLevelPlaylist=function(e,t,n,r,i){var o,a,s=0,l=0,u=new T.default(t),c=new P.default,d=0,f=null,h=new w.default,p=null;for(R.lastIndex=0;null!==(o=R.exec(e));){var y,g=o[1];if(g){h.duration=parseFloat(g);var m=(" "+o[2]).slice(1);h.title=m||null,h.tagList.push(m?["INF",g,m]:["INF",g])}else if(o[3])S.isFinite(h.duration)&&(m=s++,h.type=r,h.start=l,h.levelkey=c,h.sn=m,h.level=n,h.cc=d,h.urlId=i,h.baseurl=t,h.relurl=(" "+o[3]).slice(1),g=f,(m=h).rawProgramDateTime?m.programDateTime=Date.parse(m.rawProgramDateTime):g&&g.programDateTime&&(m.programDateTime=g.endProgramDateTime),S.isFinite(m.programDateTime)||(m.programDateTime=null,m.rawProgramDateTime=null),u.fragments.push(h),l+=(f=h).duration,h=new w.default);else if(o[4])h.rawByteRange=(" "+o[4]).slice(1),f&&(y=f.byteRangeEndOffset)&&(h.lastByteRangeEndOffset=y);else if(o[5])h.rawProgramDateTime=(" "+o[5]).slice(1),h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]),null===p&&(p=u.fragments.length);else{for(o=o[0].match(C),a=1;a<o.length&&void 0===o[a];a++);var v=(" "+o[a+1]).slice(1),b=(" "+o[a+2]).slice(1);switch(o[a]){case"#":h.tagList.push(b?[v,b]:[v]);break;case"PLAYLIST-TYPE":u.type=v.toUpperCase();break;case"MEDIA-SEQUENCE":s=u.startSN=parseInt(v);break;case"TARGETDURATION":u.targetduration=parseFloat(v);break;case"VERSION":u.version=parseInt(v);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":d++,h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(v);break;case"KEY":var _=new O.default(v),E=_.enumeratedString("METHOD"),k=_.URI,_=_.hexadecimalInteger("IV");E&&(c=new P.default,k&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(E)&&(c.method=E,c.baseuri=t,c.reluri=k,c.key=null,c.iv=_));break;case"START":var A=new O.default(v).decimalFloatingPoint("TIME-OFFSET");S.isFinite(A)&&(u.startTimeOffset=A);break;case"MAP":A=new O.default(v);h.relurl=A.URI,h.rawByteRange=A.BYTERANGE,h.baseurl=t,h.level=n,h.type=r,h.sn="initSegment",u.initSegment=h,(h=new w.default).rawProgramDateTime=u.initSegment.rawProgramDateTime;break;default:L.logger.warn("line parsed but not handled: "+o)}}}return(h=f)&&!h.relurl&&(u.fragments.pop(),l-=h.duration),u.totalduration=l,u.averagetargetduration=l/u.fragments.length,u.endSN=s-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=d,!u.initSegment&&u.fragments.length&&u.fragments.every(function(e){return D.test(e.relurl)})&&(L.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(h=new w.default).relurl=u.fragments[0].relurl,h.baseurl=t,h.level=n,h.type=r,h.sn="initSegment",u.initSegment=h,u.needSidxRanges=!0),p&&function(e,t){for(var n=e[t],r=t-1;0<=r;r--){var i=e[r];i.programDateTime=n.programDateTime-1e3*i.duration,n=i}}(u.fragments,p),u},u);function u(){}t.default=e}.call(this,r("./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":function(e,a,l){"use strict";!function(f){var r,e=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(a,"__esModule",{value:!0});var t,h=l("./src/events.js"),n=l("./src/event-handler.js"),s=l("./src/errors.js"),c=l("./src/utils/logger.js"),i=l("./src/demux/mp4demuxer.js"),p=l("./src/loader/m3u8-parser.js"),y=window.performance,g={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},o={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},e=(t=n.default,e(m,t),Object.defineProperty(m,"ContextType",{get:function(){return g},enumerable:!0,configurable:!0}),Object.defineProperty(m,"LevelType",{get:function(){return o},enumerable:!0,configurable:!0}),m.canHaveQualityLevels=function(e){return e!==g.AUDIO_TRACK&&e!==g.SUBTITLE_TRACK},m.mapContextToLevelType=function(e){switch(e.type){case g.AUDIO_TRACK:return o.AUDIO;case g.SUBTITLE_TRACK:return o.SUBTITLE;default:return o.MAIN}},m.getResponseUrl=function(e,t){e=e.url;return e=void 0===e||0===e.indexOf("data:")?t.url:e},m.prototype.createInternalLoader=function(e){var t=this.hls.config,n=t.pLoader,r=t.loader,t=new(n||r)(t);return e.loader=t,this.loaders[e.type]=t},m.prototype.getInternalLoader=function(e){return this.loaders[e.type]},m.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},m.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},m.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},m.prototype.onManifestLoading=function(e){this.load(e.url,{type:g.MANIFEST,level:0,id:null})},m.prototype.onLevelLoading=function(e){this.load(e.url,{type:g.LEVEL,level:e.level,id:e.id})},m.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:g.AUDIO_TRACK,level:null,id:e.id})},m.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:g.SUBTITLE_TRACK,level:null,id:e.id})},m.prototype.load=function(e,t){var n=this.hls.config;c.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var r,i,o,a,s=this.getInternalLoader(t);if(s){var l=s.context;if(l&&l.url===e)return c.logger.trace("playlist request ongoing"),!1;c.logger.warn("aborting previous loader for type: "+t.type),s.abort()}switch(t.type){case g.MANIFEST:r=n.manifestLoadingMaxRetry,i=n.manifestLoadingTimeOut,o=n.manifestLoadingRetryDelay,a=n.manifestLoadingMaxRetryTimeout;break;case g.LEVEL:r=0,i=n.levelLoadingTimeOut;break;default:r=n.levelLoadingMaxRetry,i=n.levelLoadingTimeOut,o=n.levelLoadingRetryDelay,a=n.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var u={timeout:i,maxRetry:r,retryDelay:o,maxRetryDelay:a},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return c.logger.debug("Calling internal loader delegate for URL: "+e),s.load(t,u,l),!0},m.prototype.loadsuccess=function(e,t,n,r){if(void 0===r&&(r=null),n.isSidxRequest)return this._handleSidxRequest(e,n),void this._handlePlaylistLoaded(e,t,n,r);this.resetInternalLoader(n.type);var i=e.data;t.tload=y.now(),0===i.indexOf("#EXTM3U")?0<i.indexOf("#EXTINF:")||0<i.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(e,t,n,r):this._handleMasterPlaylist(e,t,n,r):this._handleManifestParsingError(e,n,"no EXTM3U delimiter",r)},m.prototype.loaderror=function(e,t,n){this._handleNetworkError(t,n=void 0===n?null:n,!1,e)},m.prototype.loadtimeout=function(e,t,n){this._handleNetworkError(t,n=void 0===n?null:n,!0)},m.prototype._handleMasterPlaylist=function(e,t,n,r){var i,o,a=this.hls,s=e.data,l=m.getResponseUrl(e,n),u=p.default.parseMasterPlaylist(s,l);u.length?(i=u.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),i=p.default.parseMasterPlaylistMedia(s,l,"AUDIO",i),s=p.default.parseMasterPlaylistMedia(s,l,"SUBTITLES"),i.length&&(o=!1,i.forEach(function(e){e.url||(o=!0)}),!1===o&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(c.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),i.unshift({type:"main",name:"main"}))),a.trigger(h.default.MANIFEST_LOADED,{levels:u,audioTracks:i,subtitles:s,url:l,stats:t,networkDetails:r})):this._handleManifestParsingError(e,n,"no level found in manifest",r)},m.prototype._handleTrackOrLevelPlaylist=function(e,t,n,r){var i=this.hls,o=n.id,a=n.level,s=n.type,l=m.getResponseUrl(e,n),u=f.isFinite(o)?o:0,c=f.isFinite(a)?a:u,d=m.mapContextToLevelType(n),u=p.default.parseLevelPlaylist(e.data,l,c,d,u);u.tload=t.tload,s===g.MANIFEST&&i.trigger(h.default.MANIFEST_LOADED,{levels:[{url:l,details:u}],audioTracks:[],url:l,stats:t,networkDetails:r}),t.tparsed=y.now(),u.needSidxRanges?(l=u.initSegment.url,this.load(l,{isSidxRequest:!0,type:s,level:a,levelDetails:u,id:o,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})):(n.levelDetails=u,this._handlePlaylistLoaded(e,t,n,r))},m.prototype._handleSidxRequest=function(e,t){var n,r=i.default.parseSegmentIndex(new Uint8Array(e.data));r&&(e=r.references,n=t.levelDetails,e.forEach(function(e,t){e=e.info,t=n.fragments[t];0===t.byteRange.length&&(t.rawByteRange=String(1+e.end-e.start)+"@"+String(e.start))}),n.initSegment.rawByteRange=String(r.moovEndOffset)+"@0")},m.prototype._handleManifestParsingError=function(e,t,n,r){this.hls.trigger(h.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:n,networkDetails:r})},m.prototype._handleNetworkError=function(e,t,n,r){var i,o;void 0===n&&(n=!1),void 0===r&&(r=null),c.logger.info("A network error occured while loading a "+e.type+"-type playlist");var a=this.getInternalLoader(e);switch(e.type){case g.MANIFEST:i=n?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case g.LEVEL:i=n?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case g.AUDIO_TRACK:i=n?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}a&&(a.abort(),this.resetInternalLoader(e.type));t={type:s.ErrorTypes.NETWORK_ERROR,details:i,fatal:o,url:a.url,loader:a,context:e,networkDetails:t};r&&(t.response=r),this.hls.trigger(h.default.ERROR,t)},m.prototype._handlePlaylistLoaded=function(e,t,n,r){var i=n.type,o=n.level,a=n.id,s=n.levelDetails;if(s.targetduration)if(m.canHaveQualityLevels(n.type))this.hls.trigger(h.default.LEVEL_LOADED,{details:s,level:o||0,id:a||0,stats:t,networkDetails:r});else switch(i){case g.AUDIO_TRACK:this.hls.trigger(h.default.AUDIO_TRACK_LOADED,{details:s,id:a,stats:t,networkDetails:r});break;case g.SUBTITLE_TRACK:this.hls.trigger(h.default.SUBTITLE_TRACK_LOADED,{details:s,id:a,stats:t,networkDetails:r})}else this._handleManifestParsingError(e,n,"invalid target duration",r)},m);function m(e){e=t.call(this,e,h.default.MANIFEST_LOADING,h.default.LEVEL_LOADING,h.default.AUDIO_TRACK_LOADING,h.default.SUBTITLE_TRACK_LOADING)||this;return e.loaders={},e}a.default=e}.call(this,l("./src/polyfills/number.js").Number)},"./src/observer.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,i=(o=n("./node_modules/eventemitter3/index.js").EventEmitter,i(a,o),a.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.emit.apply(this,[e,e].concat(t))},a);function a(){return null!==o&&o.apply(this,arguments)||this}t.Observer=i},"./src/polyfills/number.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n=n("./src/utils/get-self-scope.js").getSelfScope().Number;(t.Number=n).isFinite=n.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},"./src/remux/aac-helper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},i);function i(){}t.default=r},"./src/remux/mp4-generator.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Math.pow(2,32)-1,r=(d.init=function(){for(var e in d.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})d.types.hasOwnProperty(e)&&(d.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);d.HDLR_TYPES={video:t,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);d.STTS=d.STSC=d.STCO=i,d.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),d.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),d.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),d.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);d.FTYP=d.box(d.types.ftyp,t,i,t,n),d.DINF=d.box(d.types.dinf,d.box(d.types.dref,r))},d.box=function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,o=i;i--;)r+=n[i].byteLength;for((t=new Uint8Array(r))[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<o;i++)t.set(n[i],r),r+=n[i].byteLength;return t},d.hdlr=function(e){return d.box(d.types.hdlr,d.HDLR_TYPES[e])},d.mdat=function(e){return d.box(d.types.mdat,e)},d.mdhd=function(e,t){t*=e;var n=Math.floor(t/(1+o)),t=Math.floor(t%(1+o));return d.box(d.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,t>>24,t>>16&255,t>>8&255,255&t,85,196,0,0]))},d.mdia=function(e){return d.box(d.types.mdia,d.mdhd(e.timescale,e.duration),d.hdlr(e.type),d.minf(e))},d.mfhd=function(e){return d.box(d.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},d.minf=function(e){return"audio"===e.type?d.box(d.types.minf,d.box(d.types.smhd,d.SMHD),d.DINF,d.stbl(e)):d.box(d.types.minf,d.box(d.types.vmhd,d.VMHD),d.DINF,d.stbl(e))},d.moof=function(e,t,n){return d.box(d.types.moof,d.mfhd(e),d.traf(n,t))},d.moov=function(e){for(var t=e.length,n=[];t--;)n[t]=d.trak(e[t]);return d.box.apply(null,[d.types.moov,d.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(d.mvex(e)))},d.mvex=function(e){for(var t=e.length,n=[];t--;)n[t]=d.trex(e[t]);return d.box.apply(null,[d.types.mvex].concat(n))},d.mvhd=function(e,t){t*=e;var n=Math.floor(t/(1+o)),t=Math.floor(t%(1+o)),t=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,t>>24,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return d.box(d.types.mvhd,t)},d.sdtp=function(e){for(var t,n=e.samples||[],r=new Uint8Array(4+n.length),i=0;i<n.length;i++)t=n[i].flags,r[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return d.box(d.types.sdtp,r)},d.stbl=function(e){return d.box(d.types.stbl,d.stsd(e),d.box(d.types.stts,d.STTS),d.box(d.types.stsc,d.STSC),d.box(d.types.stsz,d.STSZ),d.box(d.types.stco,d.STCO))},d.avc1=function(e){for(var t,n,r=[],i=[],o=0;o<e.sps.length;o++)n=(t=e.sps[o]).byteLength,r.push(n>>>8&255),r.push(255&n),r=r.concat(Array.prototype.slice.call(t));for(o=0;o<e.pps.length;o++)n=(t=e.pps[o]).byteLength,i.push(n>>>8&255),i.push(255&n),i=i.concat(Array.prototype.slice.call(t));var a=d.box(d.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(i))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return d.box(d.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,d.box(d.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),d.box(d.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},d.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},d.mp4a=function(e){var t=e.samplerate;return d.box(d.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),d.box(d.types.esds,d.esds(e)))},d.mp3=function(e){var t=e.samplerate;return d.box(d.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},d.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?d.box(d.types.stsd,d.STSD,d.mp4a(e)):d.box(d.types.stsd,d.STSD,d.mp3(e)):d.box(d.types.stsd,d.STSD,d.avc1(e))},d.tkhd=function(e){var t=e.id,n=e.duration*e.timescale,r=e.width,i=e.height,e=Math.floor(n/(1+o)),n=Math.floor(n%(1+o));return d.box(d.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,i>>8&255,255&i,0,0]))},d.traf=function(e,t){var n=d.sdtp(e),r=e.id,i=Math.floor(t/(1+o)),t=Math.floor(t%(1+o));return d.box(d.types.traf,d.box(d.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),d.box(d.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,t>>24,t>>16&255,t>>8&255,255&t])),d.trun(e,n.length+16+20+8+16+8+8),n)},d.trak=function(e){return e.duration=e.duration||4294967295,d.box(d.types.trak,d.tkhd(e),d.mdia(e))},d.trex=function(e){e=e.id;return d.box(d.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},d.trun=function(e,t){var n,r,i,o,a,s=e.samples||[],l=s.length,e=12+16*l,u=new Uint8Array(e);for(u.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,(t+=8+e)>>>24&255,t>>>16&255,t>>>8&255,255&t],0),n=0;n<l;n++)r=(a=s[n]).duration,i=a.size,o=a.flags,a=a.cts,u.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,a>>>24&255,a>>>16&255,a>>>8&255,255&a],12+16*n);return d.box(d.types.trun,u)},d.initSegment=function(e){d.types||d.init();var t=d.moov(e);return(e=new Uint8Array(d.FTYP.byteLength+t.byteLength)).set(d.FTYP),e.set(t,d.FTYP.byteLength),e},d);function d(){}t.default=r},"./src/remux/mp4-remuxer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var F=n("./src/remux/aac-helper.js"),N=n("./src/remux/mp4-generator.js"),U=n("./src/events.js"),B=n("./src/errors.js"),Y=n("./src/utils/logger.js"),n=(r.prototype.destroy=function(){},r.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},r.prototype.resetInitSegment=function(){this.ISGenerated=!1},r.prototype.remux=function(e,t,n,r,i,o,a){var s,l,u,c,d;this.ISGenerated||this.generateIS(e,t,i),this.ISGenerated&&(d=e.samples.length,s=t.samples.length,u=l=i,d&&s&&(c=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale,l+=Math.max(0,c),u+=Math.max(0,-c)),d?(e.timescale||(Y.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i)),c=this.remuxAudio(e,l,o,a),s&&(d=void 0,c&&(d=c.endPTS-c.startPTS),t.timescale||(Y.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,u,o,d,a))):!s||(a=this.remuxVideo(t,u,o,0,a))&&e.codec&&this.remuxEmptyAudio(e,l,o,a)),n.samples.length&&this.remuxID3(n,i),r.samples.length&&this.remuxText(r,i),this.observer.trigger(U.default.FRAG_PARSED)},r.prototype.generateIS=function(e,t,n){var r,i,o=this.observer,a=e.samples,s=t.samples,l=this.typeSupported,u="audio/mp4",c={},d={tracks:c},f=void 0===this._initPTS;f&&(r=i=1/0),e.config&&a.length&&(e.timescale=e.samplerate,Y.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(u="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:N.default.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(r=i=a[0].pts-e.inputTimeScale*n)),t.sps&&t.pps&&s.length&&(e=t.inputTimeScale,t.timescale=e,c.video={container:"video/mp4",codec:t.codec,initSegment:N.default.initSegment([t]),metadata:{width:t.width,height:t.height}},f&&(r=Math.min(r,s[0].pts-e*n),i=Math.min(i,s[0].dts-e*n),this.observer.trigger(U.default.INIT_PTS_FOUND,{initPTS:r}))),Object.keys(c).length?(o.trigger(U.default.FRAG_PARSING_INIT_SEGMENT,d),this.ISGenerated=!0,f&&(this._initPTS=r,this._initDTS=i)):o.trigger(U.default.ERROR,{type:B.ErrorTypes.MEDIA_ERROR,details:B.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},r.prototype.remuxVideo=function(e,t,n,r,i){var o,a,s=8,l=e.timescale,u=e.samples,c=[],d=u.length,f=this._PTSNormalize,h=this._initPTS,p=this.nextAvcDts,y=this.isSafari;if(0!==d){y&&(n|=u.length&&p&&(i&&Math.abs(t-p/l)<.1||Math.abs(u[0].pts-p-h)<l/5)),n||(p=t*l),u.forEach(function(e){e.pts=f(e.pts-h,p),e.dts=f(e.dts-h,p)}),u.sort(function(e,t){var n=e.dts-t.dts,r=e.pts-t.pts;return n||r||e.id-t.id});var g=u.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(g<0){Y.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(g/90)+" ms to overcome this issue");for(var m=0;m<u.length;m++)u[m].dts+=g}var i=u[0],v=Math.max(i.dts,0),b=Math.max(i.pts,0),t=Math.round((v-p)/90);n&&t&&(1<t?Y.logger.log("AVC:"+t+" ms hole between fragments detected,filling it"):t<-1&&Y.logger.log("AVC:"+-t+" ms overlapping between fragments detected"),v=p,u[0].dts=v,b=Math.max(b-t,p),u[0].pts=b,Y.logger.log("Video/PTS/DTS adjusted: "+Math.round(b/90)+"/"+Math.round(v/90)+",delta:"+t+" ms")),i=u[u.length-1],n=Math.max(i.dts,0),t=Math.max(i.pts,0,n),y&&(o=Math.round((n-v)/(u.length-1)));for(var _=0,E=0,m=0;m<d;m++){for(var k=u[m],A=k.units,S=A.length,w=0,T=0;T<S;T++)w+=A[T].data.length;E+=w,_+=S,k.length=w,k.dts=y?v+m*o:Math.max(k.dts,v),k.pts=Math.max(k.pts,k.dts)}i=E+4*_+8;try{a=new Uint8Array(i)}catch(e){return void this.observer.trigger(U.default.ERROR,{type:B.ErrorTypes.MUX_ERROR,details:B.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:i,reason:"fail allocating video mdat "+i})}var P=new DataView(a.buffer);for(P.setUint32(0,i),a.set(N.default.types.mdat,4),m=0;m<d;m++){for(var O,L,R=u[m],C=R.units,D=0,x=void 0,T=0,S=C.length;T<S;T++){var I=C[T],M=I.data,I=I.data.byteLength;P.setUint32(s,I),s+=4,a.set(M,s),s+=I,D+=4+I}x=y?Math.max(0,o*Math.round((R.pts-R.dts)/o)):(m<d-1?o=u[m+1].dts-R.dts:(L=this.config,O=R.dts-u[0<m?m-1:m].dts,L.stretchShortVideoTrack?(L=L.maxBufferHole,Math.floor(L*l)<(L=(r?b+r*l:this.nextAudioPts)-R.pts)?((o=L-O)<0&&(o=O),Y.logger.log("It is approximately "+L/90+" ms to the next segment; using duration "+o/90+" ms for the last video frame.")):o=O):o=O),Math.round(R.pts-R.dts)),c.push({size:D,duration:o,cts:x,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:R.key?2:1,isNonSync:R.key?0:1}})}this.nextAvcDts=n+o;var j,n=e.dropped;e.len=0,e.nbNalu=0,e.dropped=0,c.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&((j=c[0].flags).dependsOn=2,j.isNonSync=0),e.samples=c,j=N.default.moof(e.sequenceNumber++,v,e),e.samples=[];n={data1:j,data2:a,startPTS:b/l,endPTS:(t+o)/l,startDTS:v/l,endDTS:this.nextAvcDts/l,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:n};return this.observer.trigger(U.default.FRAG_PARSING_DATA,n),n}},r.prototype.remuxAudio=function(e,t,n,r){var i,o,a,s,l,u=e.inputTimeScale,c=e.timescale,d=u/c,f=(e.isAAC?1024:1152)*d,h=this._PTSNormalize,p=this._initPTS,y=!e.isAAC&&this.typeSupported.mpeg,g=e.samples,m=[],v=this.nextAudioPts;if(n|=g.length&&v&&(r&&Math.abs(t-v/u)<.1||Math.abs(g[0].pts-v-p)<20*f),g.forEach(function(e){e.pts=e.dts=h(e.pts-p,t*u)}),0!==(g=g.filter(function(e){return 0<=e.pts})).length){if(n||(v=r?t*u:g[0].pts),e.isAAC)for(var b=this.config.maxAudioFramesDrift,_=0,E=v;_<g.length;){var k=g[_],A=(C=k.pts)-E,S=Math.abs(1e3*A/u);if(A<=-b*f)Y.logger.warn("Dropping 1 audio frame @ "+(E/u).toFixed(3)+"s due to "+Math.round(S)+" ms overlap."),g.splice(_,1),e.len-=k.unit.length;else if(b*f<=A&&S<1e4&&E){var w=Math.round(A/f);Y.logger.warn("Injecting "+w+" audio frame @ "+(E/u).toFixed(3)+"s due to "+Math.round(1e3*A/u)+" ms gap.");for(var T=0;T<w;T++){var P=Math.max(E,0);(o=F.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(Y.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),o=k.unit.subarray()),g.splice(_,0,{unit:o,pts:P,dts:P}),e.len+=o.length,E+=f,_++}k.pts=k.dts=E,E+=f,_++}else Math.abs(A),k.pts=k.dts=E,E+=f,_++}for(var T=0,O=g.length;T<O;T++){var L=g[T],R=L.unit,C=L.pts;if(void 0!==l)i.duration=Math.round((C-l)/d);else{var D=Math.round(1e3*(C-v)/u),x=0;if(n&&e.isAAC&&D){if(0<D&&D<1e4)x=Math.round((C-v)/f),Y.logger.log(D+" ms hole between AAC samples detected,filling it"),0<x&&((o=F.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o=R.subarray()),e.len+=x*o.length);else if(D<-12){Y.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(v/u).toFixed(3)+"s/"+(C/u).toFixed(3)+"s/"+-D+"ms"),e.len-=R.byteLength;continue}C=v}if(s=C,!(0<e.len))return;var D=y?e.len:e.len+8,I=y?0:8;try{a=new Uint8Array(D)}catch(e){return void this.observer.trigger(U.default.ERROR,{type:B.ErrorTypes.MUX_ERROR,details:B.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:D,reason:"fail allocating audio mdat "+D})}for(y||(new DataView(a.buffer).setUint32(0,D),a.set(N.default.types.mdat,4)),_=0;_<x;_++)(o=F.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(Y.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),o=R.subarray()),a.set(o,I),I+=o.byteLength,i={size:o.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},m.push(i)}a.set(R,I);D=R.byteLength;I+=D,m.push(i={size:D,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),l=C}var M=0,j=m.length;if(2<=j&&(M=m[j-2].duration,i.duration=M),j){this.nextAudioPts=v=l+d*M,e.len=0,e.samples=m,c=y?new Uint8Array:N.default.moof(e.sequenceNumber++,s/d,e),e.samples=[];r=s/u,M=v/u,j={data1:c,data2:a,startPTS:r,endPTS:M,startDTS:r,endDTS:M,type:"audio",hasAudio:!0,hasVideo:!1,nb:j};return this.observer.trigger(U.default.FRAG_PARSING_DATA,j),j}return null}},r.prototype.remuxEmptyAudio=function(e,t,n,r){var i=e.inputTimeScale,o=i/(e.samplerate||i),a=this.nextAudioPts,s=(void 0!==a?a:r.startDTS*i)+this._initDTS,i=r.endDTS*i+this._initDTS,l=1024*o,u=Math.ceil((i-s)/l),c=F.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(Y.logger.warn("remux empty Audio"),c){for(var d=[],f=0;f<u;f++){var h=s+f*l;d.push({unit:c,pts:h,dts:h}),e.len+=c.length}e.samples=d,this.remuxAudio(e,t,n)}else Y.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},r.prototype.remuxID3=function(e){var t,n=e.samples.length,r=e.inputTimeScale,i=this._initPTS,o=this._initDTS;if(n){for(var a=0;a<n;a++)(t=e.samples[a]).pts=(t.pts-i)/r,t.dts=(t.dts-o)/r;this.observer.trigger(U.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},r.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,n=e.samples.length,r=e.inputTimeScale,i=this._initPTS;if(n){for(var o=0;o<n;o++)(t=e.samples[o]).pts=(t.pts-i)/r;this.observer.trigger(U.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},r.prototype._PTSNormalize=function(e,t){var n;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=n;return e},r);function r(e,t,n,r){this.observer=e,this.config=t,this.typeSupported=n;n=navigator.userAgent;this.isSafari=r&&-1<r.indexOf("Apple")&&n&&!n.match("CriOS"),this.ISGenerated=!1}t.default=n},"./src/remux/passthrough-remuxer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n("./src/events.js"),n=(r.prototype.destroy=function(){},r.prototype.resetTimeStamp=function(){},r.prototype.resetInitSegment=function(){},r.prototype.remux=function(e,t,n,r,i,o,a,s){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(c.default.FRAG_PARSING_DATA,{data1:s,startPTS:i,startDTS:i,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(c.default.FRAG_PARSED)},r);function r(e){this.observer=e}t.default=n},"./src/task-loop.js":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,i=(o=n("./src/event-handler.js").default,i(a,o),a.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},a.prototype.hasInterval=function(){return!!this._tickInterval},a.prototype.hasNextTick=function(){return!!this._tickTimer},a.prototype.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},a.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),!(this._tickInterval=null))},a.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),!(this._tickTimer=null))},a.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},a.prototype.doTick=function(){},a);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e=o.apply(this,[e].concat(t))||this;return e._tickInterval=null,e._tickTimer=null,e._tickCallCount=0,e._boundTick=e.tick.bind(e),e}t.default=i},"./src/utils/attr-list.js":function(e,o,t){"use strict";!function(t){Object.defineProperty(o,"__esModule",{value:!0});var n=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,e=(r.prototype.decimalInteger=function(e){e=parseInt(this[e],10);return e>t.MAX_SAFE_INTEGER?1/0:e},r.prototype.hexadecimalInteger=function(e){if(this[e]){for(var t=(1&(t=(this[e]||"0x").slice(2)).length?"0":"")+t,n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null},r.prototype.hexadecimalIntegerAsNumber=function(e){e=parseInt(this[e],16);return e>t.MAX_SAFE_INTEGER?1/0:e},r.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},r.prototype.enumeratedString=function(e){return this[e]},r.prototype.decimalResolution=function(e){e=n.exec(this[e]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},r.parseAttrList=function(e){var t,n={};for(i.lastIndex=0;null!==(t=i.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n},r);function r(e){for(var t in e="string"==typeof e?r.parseAttrList(e):e)e.hasOwnProperty(t)&&(this[t]=e[t])}o.default=e}.call(this,t("./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={search:function(e,t){for(var n,r,i=0,o=e.length-1;i<=o;){var a=t(r=e[n=(i+o)/2|0]);if(0<a)i=1+n;else{if(!(a<0))return r;o=n-1}}return null}}},"./src/utils/buffer-helper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.isBuffered=function(e,t){try{if(e)for(var n=e.buffered,r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}catch(e){}return!1},i.bufferInfo=function(e,t,n){try{if(e){for(var r=e.buffered,i=[],o=void 0,o=0;o<r.length;o++)i.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(i,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},i.bufferedInfo=function(e,t,n){var r,i,o,a,s,l=[];for(e.sort(function(e,t){return e.start-t.start||t.end-e.end}),s=0;s<e.length;s++){var u,c=l.length;c?(u=l[c-1].end,e[s].start-u<n?e[s].end>u&&(l[c-1].end=e[s].end):l.push(e[s])):l.push(e[s])}for(r=s=0,i=o=t;s<l.length;s++){var d=l[s].start,f=l[s].end;if(d<=t+n&&t<f)i=d,r=(o=f)-t;else if(t+n<d){a=d;break}}return{len:r,start:i,end:o,nextStart:a}},i);function i(){}t.BufferHelper=r},"./src/utils/cea-608-parser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t=e;return r.hasOwnProperty(e)&&(t=r[e]),String.fromCharCode(t)}function s(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t}var r={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},l=15,i=100,o={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},f=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e],this.verboseLevel}},p=(w.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},w.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},w.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},w.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},w.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},w.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},w),y=(S.prototype.reset=function(){this.uchar=" ",this.penState.reset()},S.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},S.prototype.setPenState=function(e){this.penState.copy(e)},S.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},S.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},S.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},S),g=(A.prototype.equals=function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},A.prototype.copy=function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},A.prototype.isEmpty=function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},A.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(h.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(h.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},A.prototype.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},A.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},A.prototype.insertChar=function(e){144<=e&&this.backSpace();var t=a(e);this.pos>=i?h.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},A.prototype.clearFromPos=function(e){for(var t=e;t<i;t++)this.chars[t].reset()},A.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},A.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},A.prototype.getTextString=function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},A.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},A),m=(k.prototype.reset=function(){for(var e=0;e<l;e++)this.rows[e].clear();this.currRow=l-1},k.prototype.equals=function(e){for(var t=!0,n=0;n<l;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},k.prototype.copy=function(e){for(var t=0;t<l;t++)this.rows[t].copy(e.rows[t])},k.prototype.isEmpty=function(){for(var e=!0,t=0;t<l;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},k.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},k.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},k.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},k.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},k.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},k.prototype.setCursor=function(e){h.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},k.prototype.setPAC=function(e){h.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<l;n++)this.rows[n].clear();var r=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var o=i.rows[r].cueStartTime;if(o&&o<h.time)for(n=0;n<this.nrRollUpRows;n++)this.rows[t-this.nrRollUpRows+n+1].copy(i.rows[r+n])}}this.currRow=t;var a=this.rows[this.currRow];null!==e.indent&&(o=e.indent,o=Math.max(o-1,0),a.setCursor(e.indent),e.color=a.chars[o].penState.foreground);e={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(e)},k.prototype.setBkgData=function(e){h.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},k.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},k.prototype.rollUp=function(){var e;null!==this.nrRollUpRows?(h.log("TEXT",this.getDisplayText()),e=this.currRow+1-this.nrRollUpRows,(e=this.rows.splice(e,1)[0]).clear(),this.rows.splice(this.currRow,0,e),h.log("INFO","Rolling up")):h.log("DEBUG","roll_up but nrRollUpRows not set yet")},k.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],n="",r=0;r<l;r++){var i=this.rows[r].getTextString();i&&(e?t.push("Row "+(r+1)+": '"+i+"'"):t.push(i.trim()))}return n=0<t.length?e?"["+t.join(" | ")+"]":t.join("\n"):n},k.prototype.getTextAndFormat=function(){return this.rows},k),v=(E.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},E.prototype.getHandler=function(){return this.outputFilter},E.prototype.setHandler=function(e){this.outputFilter=e},E.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},E.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},E.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,h.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},E.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";h.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},E.prototype.ccRCL=function(){h.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},E.prototype.ccBS=function(){h.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},E.prototype.ccAOF=function(){},E.prototype.ccAON=function(){},E.prototype.ccDER=function(){h.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},E.prototype.ccRU=function(e){h.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},E.prototype.ccFON=function(){h.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},E.prototype.ccRDC=function(){h.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},E.prototype.ccTR=function(){h.log("INFO","TR"),this.setMode("MODE_TEXT")},E.prototype.ccRTD=function(){h.log("INFO","RTD"),this.setMode("MODE_TEXT")},E.prototype.ccEDM=function(){h.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},E.prototype.ccCR=function(){h.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},E.prototype.ccENM=function(){h.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},E.prototype.ccEOC=function(){var e;h.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode&&(e=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())),this.outputDataUpdate(!0)},E.prototype.ccTO=function(e){h.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},E.prototype.ccMIDROW=function(e){var t={flash:!1};t.underline=e%2==1,t.italics=46<=e,t.italics?t.foreground="white":(e=Math.floor(e/2)-16,t.foreground=["white","green","blue","cyan","red","yellow","magenta"][e]),h.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},E.prototype.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=h.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},E.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},E),b=(_.prototype.getHandler=function(e){return this.channels[e].getHandler()},_.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},_.prototype.addData=function(e,t){var n,r,i,o=!1;this.lastTime=e,h.setTime(e);for(var a=0;a<t.length;a+=2)r=127&t[a],i=127&t[a+1],0!=r||0!=i?(h.log("DATA","["+s([t[a],t[a+1]])+"] -> ("+s([r,i])+")"),(n=(n=(n=!(n=this.parseCmd(r,i))?this.parseMidrow(r,i):n)||this.parsePAC(r,i))||this.parseBackgroundAttributes(r,i))||(o=this.parseChars(r,i))&&(this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(o):h.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,h.log("WARNING","Couldn't parse cleaned data "+s([r,i])+" orig: "+s([t[a],t[a+1]])))):this.dataCounters.padding+=2},_.prototype.parseCmd=function(e,t){var n=null;if(!((20===e||28===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,h.log("DEBUG","Repeated command ("+s([e,t])+") is dropped"),!0;var r=this.channels[(n=20===e||23===e?1:2)-1];return 20===e||28===e?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},_.prototype.parseMidrow=function(e,t){var n;return(17===e||25===e)&&32<=t&&t<=47&&((n=17===e?1:2)!==this.currChNr?(h.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[n-1].ccMIDROW(t),h.log("DEBUG","MIDROW ("+s([e,t])+")"),!0))},_.prototype.parsePAC=function(e,t){if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);var n=e<=23?1:2,r=this.interpretPAC((64<=t&&t<=95?1==n?o:c:1==n?u:d)[e],t);return this.channels[n-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},_.prototype.interpretPAC=function(e,t){var n=t,e={color:null,italics:!1,indent:null,underline:!1,row:e};return e.underline=1==(1&(n=95<t?t-96:t-64)),n<=13?e.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(e.italics=!0,e.color="white"):e.indent=4*Math.floor((n-16)/2),e},_.prototype.parseChars=function(e,t){var n,r=null,i=null,o=null;return 17<=(o=25<=e?(r=2,e-8):(r=1,e))&&o<=19?(n=t,h.log("INFO","Special char '"+a(n=17===o?t+80:18===o?t+112:t+144)+"' in channel "+r),i=[n]):32<=e&&e<=127&&(i=0===t?[e]:[e,t]),i&&(t=s(i),h.log("DEBUG","Char codes =  "+t.join(",")),this.lastCmdA=null,this.lastCmdB=null),i},_.prototype.parseBackgroundAttributes=function(e,t){var n,r;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=f[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),this.channels[(e<24?1:2)-1].setBkgData(n),this.lastCmdA=null,!(this.lastCmdB=null))},_.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},_.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},_);function _(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new v(1,t),new v(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}function E(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}function k(){this.rows=[];for(var e=0;e<l;e++)this.rows.push(new g);this.currRow=l-1,this.nrRollUpRows=null,this.reset()}function A(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new y);this.pos=0,this.currPenState=new p}function S(e,t,n,r,i,o){this.uchar=e||" ",this.penState=new p(t,n,r,i,o)}function w(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}t.default=b},"./src/utils/codecs.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(e,t){t=r[t];return!!t&&!0===t[e.slice(0,4)]},t.isCodecSupportedInMp4=function(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=n("./src/utils/vttparser.js");t.newCue=function(e,t,n,r){for(var i,o,a,s,l,u=window.VTTCue||window.TextTrackCue,c=0;c<r.rows.length;c++)if(a=!0,s=0,l="",!(i=r.rows[c]).isEmpty()){for(var d=0;d<i.chars.length;d++)i.chars[d].uchar.match(/\s/)&&a?s++:(l+=i.chars[d].uchar,a=!1);(i.cueStartTime=t)===n&&(n+=1e-4),o=new u(t,n,f.fixLineBreaks(l.trim())),16<=s?s--:s++,navigator.userAgent.match(/Firefox\//)?o.line=c+1:o.line=7<c?c-2:c+1,o.align="left",o.position=Math.max(0,Math.min(100,s/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(o)}}},"./src/utils/discontinuities.js":function(e,t,d){"use strict";!function(r){Object.defineProperty(t,"__esModule",{value:!0});var n=d("./src/utils/binary-search.js"),i=d("./src/utils/logger.js");function o(e,t){for(var n=null,r=0;r<e.length;r+=1){var i=e[r];if(i&&i.cc===t){n=i;break}}return n}function a(e,t,n){var r=!1;return r=t&&t.details&&n&&(n.endCC>n.startCC||e&&e.cc<n.startCC)?!0:r}function s(e,t){e=e.fragments,t=t.fragments;if(t.length&&e.length){t=o(e,t[0].cc);if(t&&(!t||t.startPTS))return t;i.logger.log("No frag in previous level to align on")}else i.logger.log("No fragments to align")}function l(n,e){e.fragments.forEach(function(e){var t;e&&(t=e.start+n,e.start=e.startPTS=t,e.endPTS=t+e.duration)}),e.PTSKnown=!0}function u(e,t,n){!a(e,n,t)||(n=s(n.details,t))&&(i.logger.log("Adjusting PTS using last level due to CC increase within current level"),l(n.start,t))}function c(e,t){var n;t&&t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime&&(n=t.fragments[0].programDateTime,t=(e.fragments[0].programDateTime-n)/1e3+t.fragments[0].start,r.isFinite(t)&&(i.logger.log("adjusting PTS using programDateTime delta, sliding:"+t.toFixed(3)),l(t,e)))}t.findFirstFragWithCC=o,t.findFragWithCC=function(e,t){return n.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})},t.shouldAlignOnDiscontinuities=a,t.findDiscontinuousReferenceFrag=s,t.adjustPts=l,t.alignStream=function(e,t,n){u(e,n,t),!n.PTSKnown&&t&&c(n,t.details)},t.alignDiscontinuities=u,t.alignPDT=c}.call(this,d("./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("./src/utils/ewma.js"),n=(r.prototype.sample=function(e,t){t=8e3*t/(e=Math.max(e,this.minDelayMs_)),e/=1e3;this.fast_.sample(e,t),this.slow_.sample(e,t)},r.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},r.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},r.prototype.destroy=function(){},r);function r(e,t,n,r){this.hls=e,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(t),this.fast_=new i.default(n)}t.default=n},"./src/utils/ewma.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.prototype.sample=function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e},i.prototype.getTotalWeight=function(){return this.totalWeight_},i.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},i);function i(e){this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}t.default=r},"./src/utils/get-self-scope.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelfScope=function(){return"undefined"==typeof window?self:window}},"./src/utils/logger.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n=n("./src/utils/get-self-scope.js");function o(){}var r={trace:o,debug:o,log:o,warn:o,info:o,error:o},a=r,s=n.getSelfScope();function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach(function(e){var r,i;a[e]=t[e]?t[e].bind(t):(r=e,(i=s.console[r])?function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]&&(t[0]=(e=t[0],"["+r+"] > "+e)),i.apply(s.console,t)}:o)})}t.enableLogs=function(e){if(!0===e||"object"==typeof e){i(e,"debug","log","info","warn","error");try{a.log()}catch(e){a=r}}else a=r},t.logger=a},"./src/utils/mediakeys-helper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=r},"./src/utils/mediasource-helper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},"./src/utils/output-filter.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},i.prototype.newCue=function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},i);function i(e,t){this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}t.default=r},"./src/utils/texttrack-utils.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAddTrackEvent=function(e,t){var n=null;try{n=new window.Event("addtrack")}catch(e){(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)},t.clearCurrentCues=function(e){if(e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}},"./src/utils/time-ranges.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={toString:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}},"./src/utils/vttcue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var _="auto",E={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function k(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function A(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)e[n]=r[n]}return e}function e(e,t,n){var r=this,i=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),o={};i?r=document.createElement("custom"):o.enumerable=!0,r.hasBeenReset=!1;var a="",s=!1,l=e,u=t,c=n,d=null,f="",h=!0,p="auto",y="start",g=50,m="middle",v=50,b="middle";if(Object.defineProperty(r,"id",A({},o,{get:function(){return a},set:function(e){a=""+e}})),Object.defineProperty(r,"pauseOnExit",A({},o,{get:function(){return s},set:function(e){s=!!e}})),Object.defineProperty(r,"startTime",A({},o,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"endTime",A({},o,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"text",A({},o,{get:function(){return c},set:function(e){c=""+e,this.hasBeenReset=!0}})),Object.defineProperty(r,"region",A({},o,{get:function(){return d},set:function(e){d=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"vertical",A({},o,{get:function(){return f},set:function(e){e="string"==typeof(e=e)&&!!E[e.toLowerCase()]&&e.toLowerCase();if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"snapToLines",A({},o,{get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}})),Object.defineProperty(r,"line",A({},o,{get:function(){return p},set:function(e){if("number"!=typeof e&&e!==_)throw new SyntaxError("An invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"lineAlign",A({},o,{get:function(){return y},set:function(e){e=k(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"position",A({},o,{get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"positionAlign",A({},o,{get:function(){return m},set:function(e){e=k(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"size",A({},o,{get:function(){return v},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"align",A({},o,{get:function(){return b},set:function(e){e=k(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),r.displayState=void 0,i)return r}return e.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},e}()},"./src/utils/vttparser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("./src/utils/vttcue.js"),r=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function i(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new r,this.regionList=[]}function l(){this.values=Object.create(null)}function u(e,t,n,r){var i,o,a=r?e.split(r):[e];for(i in a)"string"!=typeof a[i]||2===(o=a[i].split(n)).length&&t(o[0],o[1])}l.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var c=new s.default(0,0,0),d="middle"===c.align?"middle":"center";function f(n,e,a){var r=n;function t(){var e=(e=n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/))?e[3]?t(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?t(e[1],e[2],0,e[4]):t(0,e[1],e[2],e[4]):null;function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}if(null===e)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),e}function i(){n=n.replace(/^\s+/,"")}if(i(),e.startTime=t(),i(),"--\x3e"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);n=n.substr(3),i(),e.endTime=t(),i(),function(e,t){var o=new l;u(e,function(e,t){switch(e){case"region":for(var n=a.length-1;0<=n;n--)if(a[n].id===t){o.set(e,a[n].region);break}break;case"vertical":o.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),i=r[0];o.integer(e,i),o.percent(e,i)&&o.set("snapToLines",!1),o.alt(e,i,["auto"]),2===r.length&&o.alt("lineAlign",r[1],["start",d,"end"]);break;case"position":r=t.split(","),o.percent(e,r[0]),2===r.length&&o.alt("positionAlign",r[1],["start",d,"end","line-left","line-right","auto"]);break;case"size":o.percent(e,t);break;case"align":o.alt(e,t,["start",d,"end","left","right"])}},/:/,/\s/),t.region=o.get("region",null),t.vertical=o.get("vertical","");e=o.get("line","auto");"auto"===e&&-1===c.line&&(e=-1),t.line=e,t.lineAlign=o.get("lineAlign","start"),t.snapToLines=o.get("snapToLines",!0),t.size=o.get("size",100),t.align=o.get("align",d);e=o.get("position","auto");"auto"===e&&50===c.position&&(e="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=e}(n,e)}function h(e){return e.replace(/<br(?: \/)?>/gi,"\n")}t.fixLineBreaks=h,i.prototype={parse:function(e){var r=this;function t(){for(var e=0,t=h(t=r.buffer);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var n=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,r.buffer=t.substr(e),n}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{var n=void 0;if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var i=(n=t()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");r.state="HEADER"}for(var o=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(o?o=!1:n=t(),r.state){case"HEADER":/:/.test(n)?u(n,function(e,t){},/:/):n||(r.state="ID");continue;case"NOTE":n||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){r.state="NOTE";break}if(!n)continue;if(r.cue=new s.default(0,0,""),r.state="CUE",-1===n.indexOf("--\x3e")){r.cue.id=n;continue}case"CUE":try{f(n,r.cue,r.regionList)}catch(e){r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var a=-1!==n.indexOf("--\x3e");if(!n||a&&(o=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=n;continue;case"BADCUE":n||(r.state="ID");continue}}}catch(e){"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.default=i},"./src/utils/webvtt-parser.js":function(e,t,n){"use strict";!function(g){Object.defineProperty(t,"__esModule",{value:!0});function m(e,t,n){return e.substr(n||0,t.length)===t}function i(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}var o=n("./src/utils/vttparser.js"),v=n("./src/demux/id3.js");t.default={parse:function(e,a,s,l,t,n){var u,e=v.utf8ArrayToStr(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),c="00:00.000",d=0,f=0,h=0,r=[],p=!0,y=new o.default;y.oncue=function(e){var t=s[l],n=s.ccOffset;t&&t.new&&(void 0!==f?n=s.ccOffset=t.start:function(e,t){var n=e[l],r=e[n.prevCC];if(!r||!r.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,n.new=!1;for(;r&&r.new;)e.ccOffset+=n.start-r.start,n.new=!1,r=e[(n=r).prevCC];e.presentationOffset=t}(s,h)),h&&(n=h-s.presentationOffset),e.startTime+=n-f,e.endTime+=n-f,e.id=i(e.startTime.toString())+i(e.endTime.toString())+i(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&r.push(e)},y.onparsingerror=function(e){u=e},y.onflush=function(){u&&n?n(u):t(r)},e.forEach(function(t){if(p){if(m(t,"X-TIMESTAMP-MAP=")){p=!1,t.substr(16).split(",").forEach(function(e){m(e,"LOCAL:")?c=e.substr(6):m(e,"MPEGTS:")&&(d=parseInt(e.substr(7)))});try{a+(9e4*s[l].start||0)<0&&(a+=8589934592),d-=a,e=c,n=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),o=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0,f=(g.isFinite(n)&&g.isFinite(r)&&g.isFinite(i)&&g.isFinite(o)?(n+=1e3*r,n+=6e4*i,n+=36e5*o):-1)/1e3,h=d/9e4,-1===f&&(u=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){u=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(p=!1)}var e,n,r,i,o;y.parse(t+"\n")}),y.flush()}}}.call(this,n("./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("./src/utils/logger.js"),l=window.performance,i=window.XMLHttpRequest,n=(r.prototype.destroy=function(){this.abort(),this.loader=null},r.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},r.prototype.load=function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:l.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},r.prototype.loadInternal=function(){var e=this.context,t=this.loader=new i,n=this.stats;n.tfirst=0,n.loaded=0;var r=this.xhrSetup;try{if(r)try{r(t,e.url)}catch(n){t.open("GET",e.url,!0),r(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(n){return void this.callbacks.onError({code:t.status,text:n.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},r.prototype.readystatechange=function(e){var t,n=e.currentTarget,r=n.readyState,i=this.stats,o=this.context,a=this.config;!i.aborted&&2<=r&&(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(l.now(),i.trequest)),4===r?200<=(t=n.status)&&t<300?(i.tload=Math.max(i.tfirst,l.now()),r=e=void 0,r="arraybuffer"===o.responseType?(e=n.response).byteLength:(e=n.responseText).length,i.loaded=i.total=r,e={url:n.responseURL,data:e},this.callbacks.onSuccess(e,i,o,n)):i.retry>=a.maxRetry||400<=t&&t<499?(s.logger.error(t+" while loading "+o.url),this.callbacks.onError({code:t,text:n.statusText},o,n)):(s.logger.warn(t+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++):this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout))},r.prototype.loadtimeout=function(){s.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},r.prototype.loadprogress=function(e){var t=e.currentTarget,n=this.stats;n.loaded=e.loaded,e.lengthComputable&&(n.total=e.total);e=this.callbacks.onProgress;e&&e(n,this.context,null,t)},r);function r(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}t.default=n}},i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s="./src/hls.js").default;function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r}())},function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var f,a,s,l,r,u,n,o,c,d,h,p,y,g,m,v,b,_,E,k,A,S,w,T,P,O,L,R,C,D,x,I,M,j,F,N,U,B,Y,G,V,H,K,$,z,W,q,X,Q=(c=(o=[]).concat,d=o.filter,h=o.slice,p=window.document,y={},g={},m={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},v=/^\s*<(\w+|!)[^>]*>/,b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,_=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,E=/^(?:body|html)$/i,k=/([A-Z])/g,A=["val","css","html","text","data","width","height","offset"],S=p.createElement("table"),Q=p.createElement("tr"),w={tr:p.createElement("tbody"),tbody:S,thead:S,tfoot:S,td:Q,th:Q,"*":p.createElement("div")},T=/complete|loaded|interactive/,P=/^[\w-]*$/,L=(O={}).toString,R={},C=p.createElement("div"),D={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},x=Array.isArray||function(e){return e instanceof Array},R.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r=e.parentNode,n=!r;return n&&(r=C).appendChild(e),t=~R.qsa(r,t).indexOf(e),n&&C.removeChild(e),t},u=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},n=function(n){return d.call(n,function(e,t){return n.indexOf(e)==t})},R.fragment=function(e,t,n){var r,i,o;return(r=b.test(e)?l(p.createElement(RegExp.$1)):r)||(e.replace&&(e=e.replace(_,"<$1></$2>")),(t=t===a?v.test(e)&&RegExp.$1:t)in w||(t="*"),(o=w[t]).innerHTML=""+e,r=l.each(h.call(o.childNodes),function(){o.removeChild(this)})),re(n)&&(i=l(r),l.each(n,function(e,t){-1<A.indexOf(e)?i[e](t):i.attr(e,t)})),r},R.Z=function(e,t){return new ue(e,t)},R.isZ=function(e){return e instanceof R.Z},R.init=function(e,t){var n,r;if(!e)return R.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&v.test(e))n=R.fragment(e,RegExp.$1,t),e=null;else{if(t!==a)return l(t).find(e);n=R.qsa(p,e)}else{if(Z(e))return l(p).ready(e);if(R.isZ(e))return e;if(x(e))r=e,n=d.call(r,function(e){return null!=e});else if(ne(e))n=[e],e=null;else if(v.test(e))n=R.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==a)return l(t).find(e);n=R.qsa(p,e)}}return R.Z(n,e)},(l=function(e,t){return R.init(e,t)}).extend=function(t){var n,e=h.call(arguments,1);return"boolean"==typeof t&&(n=t,t=e.shift()),e.forEach(function(e){!function e(t,n,r){for(s in n)r&&(re(n[s])||x(n[s]))?(re(n[s])&&!re(t[s])&&(t[s]={}),x(n[s])&&!x(t[s])&&(t[s]=[]),e(t[s],n[s],r)):n[s]!==a&&(t[s]=n[s])}(t,e,n)}),t},R.qsa=function(e,t){var n,r="#"==t[0],i=!r&&"."==t[0],o=r||i?t.slice(1):t,a=P.test(o);return e.getElementById&&a&&r?(n=e.getElementById(o))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:h.call(a&&!r&&e.getElementsByClassName?i?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},l.contains=p.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t=t&&t.parentNode;)if(t===e)return!0;return!1},l.type=J,l.isFunction=Z,l.isWindow=ee,l.isArray=x,l.isPlainObject=re,l.isEmptyObject=function(e){for(var t in e)return!1;return!0},l.inArray=function(e,t,n){return o.indexOf.call(t,e,n)},l.camelCase=u,l.trim=function(e){return null==e?"":String.prototype.trim.call(e)},l.uuid=0,l.support={},l.expr={},l.noop=function(){},l.map=function(e,t){var n,r,i,o,a=[];if(ie(e))for(r=0;r<e.length;r++)null!=(n=t(e[r],r))&&a.push(n);else for(i in e)null!=(n=t(e[i],i))&&a.push(n);return 0<(o=a).length?l.fn.concat.apply([],o):o},l.each=function(e,t){var n,r;if(ie(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(r in e)if(!1===t.call(e[r],r,e[r]))return e;return e},l.grep=function(e,t){return d.call(e,t)},window.JSON&&(l.parseJSON=JSON.parse),l.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),l.fn={constructor:R.Z,length:0,forEach:o.forEach,reduce:o.reduce,push:o.push,sort:o.sort,splice:o.splice,indexOf:o.indexOf,concat:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=R.isZ(e=arguments[n])?e.toArray():e;return c.apply(R.isZ(this)?this.toArray():this,t)},map:function(n){return l(l.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return l(h.apply(this,arguments))},ready:function(e){return T.test(p.readyState)&&p.body?e(l):p.addEventListener("DOMContentLoaded",function(){e(l)},!1),this},get:function(e){return e===a?h.call(this):this[0<=e?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(n){return o.every.call(this,function(e,t){return!1!==n.call(e,t,e)}),this},filter:function(t){return Z(t)?this.not(this.not(t)):l(d.call(this,function(e){return R.matches(e,t)}))},add:function(e,t){return l(n(this.concat(l(e,t))))},is:function(e){return 0<this.length&&R.matches(this[0],e)},not:function(t){var n,r=[];return Z(t)&&t.call!==a?this.each(function(e){t.call(this,e)||r.push(this)}):(n="string"==typeof t?this.filter(t):ie(t)&&Z(t.item)?h.call(t):l(t),this.forEach(function(e){n.indexOf(e)<0&&r.push(e)})),l(r)},has:function(e){return this.filter(function(){return ne(e)?l.contains(this,e):l(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!ne(e)?e:l(e)},last:function(){var e=this[this.length-1];return e&&!ne(e)?e:l(e)},find:function(e){var n=this;return e?"object"==i(e)?l(e).filter(function(){var t=this;return o.some.call(n,function(e){return l.contains(e,t)})}):1==this.length?l(R.qsa(this[0],e)):this.map(function(){return R.qsa(this,e)}):l()},closest:function(e,t){var n=this[0],r=!1;for("object"==i(e)&&(r=l(e));n&&!(r?0<=r.indexOf(n):R.matches(n,e));)n=n!==t&&!te(n)&&n.parentNode;return l(n)},parents:function(e){for(var t=[],n=this;0<n.length;)n=l.map(n,function(e){return(e=e.parentNode)&&!te(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return ce(t,e)},parent:function(e){return ce(n(this.pluck("parentNode")),e)},children:function(e){return ce(this.map(function(){return le(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||h.call(this.childNodes)})},siblings:function(e){return ce(this.map(function(e,t){return d.call(le(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return l.map(this,function(e){return e[t]})},show:function(){return this.each(function(){var e,t,n;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,y[e]||(t=p.createElement(e),p.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),y[e]=n="none"==n?"block":n),y[e]))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var n,r,i=Z(t);return this[0]&&!i&&(n=l(t).get(0),r=n.parentNode||1<this.length),this.each(function(e){l(this).wrapAll(i?t.call(this,e):r?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){l(this[0]).before(e=l(e));for(var t;(t=e.children()).length;)e=t.first();l(e).append(this)}return this},wrapInner:function(r){var i=Z(r);return this.each(function(e){var t=l(this),n=t.contents(),e=i?r.call(this,e):r;n.length?n.wrapAll(e):t.append(e)})},unwrap:function(){return this.parent().each(function(){l(this).replaceWith(l(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=l(this);(t===a?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(e){return l(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return l(this.pluck("nextElementSibling")).filter(e||"*")},html:function(n){return 0 in arguments?this.each(function(e){var t=this.innerHTML;l(this).empty().append(de(this,n,e,t))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){e=de(this,t,e,this.textContent);this.textContent=null==e?"":""+e}):0 in this?this[0].textContent:null},attr:function(t,n){var e;return"string"!=typeof t||1 in arguments?this.each(function(e){if(1===this.nodeType)if(ne(t))for(s in t)fe(this,s,t[s]);else fe(this,t,de(this,n,e,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(e=this[0].getAttribute(t))&&t in this[0]?this[0][t]:e:a},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){fe(this,e)},this)})},prop:function(t,n){return t=D[t]||t,1 in arguments?this.each(function(e){this[t]=de(this,n,e,this[t])}):this[0]&&this[0][t]},data:function(e,t){var n="data-"+e.replace(k,"-$1").toLowerCase(),n=1 in arguments?this.attr(n,t):this.attr(n);return null!==n?pe(n):a},val:function(t){return 0 in arguments?this.each(function(e){this.value=de(this,t,e,this.value)}):this[0]&&(this[0].multiple?l(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(r){if(r)return this.each(function(e){var t=l(this),n=de(this,r,e,t.offset()),e=t.offsetParent().offset(),e={top:n.top-e.top,left:n.left-e.left};"static"==t.css("position")&&(e.position="relative"),t.css(e)});if(!this.length)return null;if(!l.contains(p.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,t){if(arguments.length<2){var n,r=this[0];if(!r)return;if(n=getComputedStyle(r,""),"string"==typeof e)return r.style[u(e)]||n.getPropertyValue(e);if(x(e)){var i={};return l.each(e,function(e,t){i[t]=r.style[u(t)]||n.getPropertyValue(t)}),i}}var o="";if("string"==J(e))t||0===t?o=oe(e)+":"+se(e,t):this.each(function(){this.style.removeProperty(oe(e))});else for(s in e)e[s]||0===e[s]?o+=oe(s)+":"+se(s,e[s])+";":this.each(function(){this.style.removeProperty(oe(s))});return this.each(function(){this.style.cssText+=";"+o})},index:function(e){return e?this.indexOf(l(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&o.some.call(this,function(e){return this.test(he(e))},ae(e))},addClass:function(n){return n?this.each(function(e){var t;"className"in this&&(r=[],t=he(this),de(this,n,e,t).split(/\s+/g).forEach(function(e){l(this).hasClass(e)||r.push(e)},this),r.length&&he(this,t+(t?" ":"")+r.join(" ")))}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===a)return he(this,"");r=he(this),de(this,t,e,r).split(/\s+/g).forEach(function(e){r=r.replace(ae(e)," ")}),he(this,r.trim())}})},toggleClass:function(n,r){return n?this.each(function(e){var t=l(this);de(this,n,e,he(this)).split(/\s+/g).forEach(function(e){(r===a?!t.hasClass(e):r)?t.addClass(e):t.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===a?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===a?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),r=E.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(l(e).css("margin-top"))||0,n.left-=parseFloat(l(e).css("margin-left"))||0,r.top+=parseFloat(l(t[0]).css("border-top-width"))||0,r.left+=parseFloat(l(t[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||p.body;e&&!E.test(e.nodeName)&&"static"==l(e).css("position");)e=e.offsetParent;return e})}},l.fn.detach=l.fn.remove,["width","height"].forEach(function(r){var i=r.replace(/./,function(e){return e[0].toUpperCase()});l.fn[r]=function(t){var e,n=this[0];return t===a?ee(n)?n["inner"+i]:te(n)?n.documentElement["scroll"+i]:(e=this.offset())&&e[r]:this.each(function(e){(n=l(this)).css(r,de(this,t,e,n[r]()))})}}),["after","prepend","before","append"].forEach(function(t,a){var s=a%2;l.fn[t]=function(){var t,r,i=l.map(arguments,function(e){return"object"==(t=J(e))||"array"==t||null==e?e:R.fragment(e)}),o=1<this.length;return i.length<1?this:this.each(function(e,t){r=s?t:t.parentNode,t=0==a?t.nextSibling:1==a?t.firstChild:2==a?t:null;var n=l.contains(p.documentElement,r);i.forEach(function(e){if(o)e=e.cloneNode(!0);else if(!r)return l(e).remove();r.insertBefore(e,t),n&&function e(t,n){n(t);for(var r=0,i=t.childNodes.length;r<i;r++)e(t.childNodes[r],n)}(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},l.fn[s?t+"To":"insert"+(a?"Before":"After")]=function(e){return l(e)[t](this),this}}),R.Z.prototype=ue.prototype=l.fn,R.uniq=n,R.deserializeValue=pe,l.zepto=R,l);function J(e){return null==e?String(e):O[L.call(e)]||"object"}function Z(e){return"function"==J(e)}function ee(e){return null!=e&&e==e.window}function te(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function ne(e){return"object"==J(e)}function re(e){return ne(e)&&!ee(e)&&Object.getPrototypeOf(e)==Object.prototype}function ie(e){return"number"==typeof e.length}function oe(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function ae(e){return e in g?g[e]:g[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function se(e,t){return"number"!=typeof t||m[oe(e)]?t:t+"px"}function le(e){return"children"in e?h.call(e.children):l.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function ue(e,t){for(var n=e?e.length:0,r=0;r<n;r++)this[r]=e[r];this.length=n,this.selector=t||""}function ce(e,t){return null==t?l(e):l(e).filter(t)}function de(e,t,n,r){return Z(t)?t.call(e,n,r):t}function fe(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function he(e,t){var n=e.className||"",r=n&&n.baseVal!==a;return t===a?r?n.baseVal:n:void(r?n.baseVal=t:e.className=t)}function pe(t){try{return t&&("true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?l.parseJSON(t):t))}catch(e){return t}}function ye(e){return((e=I(e)).width()||e.height())&&"none"!==e.css("display")}function ge(e,t){e=e.replace(/=#\]/g,'="#"]');var n,r,i=U.exec(e);return i&&i[2]in N&&(n=N[i[2]],r=i[3],e=i[1],r)&&(i=Number(r),r=isNaN(i)?r.replace(/^["']|["']$/g,""):i),t(e,n,r)}function me(){$=null,W.last&&(W.el.trigger("longTap"),W={})}function ve(){$&&clearTimeout($),$=null}function be(){V&&clearTimeout(V),H&&clearTimeout(H),K&&clearTimeout(K),$&&clearTimeout($),V=H=K=$=null,W={}}function _e(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function Ee(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}function ke(e){var o=[["resolve","done",q.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",q.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",q.Callbacks({memory:1})]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ke(function(i){q.each(o,function(e,n){var r=q.isFunction(t[e])&&t[e];s[n[1]](function(){var e,t=r&&r.apply(this,arguments);t&&q.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):(e=this===a?i.promise():this,t=r?[t]:arguments,i[n[0]+"With"](e,t))})}),t=null}).promise()},promise:function(e){return null!=e?q.extend(e,a):a}},s={};return q.each(o,function(e,t){var n=t[2],r=t[3];a[t[1]]=n.add,r&&n.add(function(){i=r},o[1^e][2].disable,o[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s}window.Zepto=Q,void 0===window.$&&(window.$=Q),function(c){function d(e){return e._zid||(e._zid=t++)}function a(e,t,n,r){var i,o;return(t=f(t)).ns&&(o=t.ns,i=new RegExp("(?:^| )"+o.replace(" "," .* ?")+"(?: |$)")),(k[d(e)]||[]).filter(function(e){return!(!e||t.e&&e.e!=t.e||t.ns&&!i.test(e.ns)||n&&d(e.fn)!==d(n)||r&&e.sel!=r)})}function f(e){e=(""+e).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function h(e,t){return e.del&&!n&&e.e in r||!!t}function p(e){return A[e]||n&&r[e]||e}function u(i,e,t,o,a,s,l){var n=d(i),u=k[n]||(k[n]=[]);e.split(/\s/).forEach(function(e){if("ready"==e)return c(document).ready(t);var n=f(e);n.fn=t,n.sel=a,n.e in A&&(t=function(e){var t=e.relatedTarget;return!t||t!==this&&!c.contains(this,t)?n.fn.apply(this,arguments):void 0});var r=(n.del=s)||t;n.proxy=function(e){if(!(e=g(e)).isImmediatePropagationStopped()){e.data=o;var t=r.apply(i,e._args==b?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},n.i=u.length,u.push(n),"addEventListener"in i&&i.addEventListener(p(n.e),n.proxy,h(n,l))})}function y(t,e,n,r,i){var o=d(t);(e||"").split(/\s/).forEach(function(e){a(t,e,n,r).forEach(function(e){delete k[o][e.i],"removeEventListener"in t&&t.removeEventListener(p(e.e),e.proxy,h(e,i))})})}function g(r,i){return!i&&r.isDefaultPrevented||(i=i||r,c.each(e,function(e,t){var n=i[e];r[e]=function(){return this[t]=s,n&&n.apply(i,arguments)},r[t]=S}),(i.defaultPrevented!==b?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(r.isDefaultPrevented=s)),r}function m(e){var t,n={originalEvent:e};for(t in e)i.test(t)||e[t]===b||(n[t]=e[t]);return g(n,e)}function v(e){return"string"==typeof e}var b,t=1,_=Array.prototype.slice,E=c.isFunction,k={},o={},n="onfocusin"in window,r={focus:"focusin",blur:"focusout"},A={mouseenter:"mouseover",mouseleave:"mouseout"};o.click=o.mousedown=o.mouseup=o.mousemove="MouseEvents",c.event={add:u,remove:y},c.proxy=function(e,t){var n=2 in arguments&&_.call(arguments,2);if(E(e)){function r(){return e.apply(t,n?n.concat(_.call(arguments)):arguments)}return r._zid=d(e),r}if(v(t))return n?(n.unshift(e[t],e),c.proxy.apply(null,n)):c.proxy(e[t],e);throw new TypeError("expected function")},c.fn.bind=function(e,t,n){return this.on(e,t,n)},c.fn.unbind=function(e,t){return this.off(e,t)},c.fn.one=function(e,t,n,r){return this.on(e,t,n,r,1)};var s=function(){return!0},S=function(){return!1},i=/^([A-Z]|returnValue$|layer[XY]$)/,e={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};c.fn.delegate=function(e,t,n){return this.on(t,e,n)},c.fn.undelegate=function(e,t,n){return this.off(t,e,n)},c.fn.live=function(e,t){return c(document.body).delegate(this.selector,e,t),this},c.fn.die=function(e,t){return c(document.body).undelegate(this.selector,e,t),this},c.fn.on=function(t,i,n,o,a){var s,l,r=this;return t&&!v(t)?(c.each(t,function(e,t){r.on(e,i,n,t,a)}),r):(v(i)||E(o)||!1===o||(o=n,n=i,i=b),o!==b&&!1!==n||(o=n,n=b),!1===o&&(o=S),r.each(function(e,r){a&&(s=function(e){return y(r,e.type,o),o.apply(this,arguments)}),u(r,t,o,n,i,(l=i?function(e){var t,n=c(e.target).closest(i,r).get(0);return n&&n!==r?(t=c.extend(m(e),{currentTarget:n,liveFired:r}),(s||o).apply(n,[t].concat(_.call(arguments,1)))):void 0}:l)||s)}))},c.fn.off=function(e,n,t){var r=this;return e&&!v(e)?(c.each(e,function(e,t){r.off(e,n,t)}),r):(v(n)||E(t)||!1===t||(t=n,n=b),!1===t&&(t=S),r.each(function(){y(this,e,t,n)}))},c.fn.trigger=function(e,t){return(e=v(e)||c.isPlainObject(e)?c.Event(e):g(e))._args=t,this.each(function(){e.type in r&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):c(this).triggerHandler(e,t)})},c.fn.triggerHandler=function(n,r){var i,o;return this.each(function(e,t){(i=m(v(n)?c.Event(n):n))._args=r,i.target=t,c.each(a(t,n.type||n),function(e,t){return o=t.proxy(i),!i.isImmediatePropagationStopped()&&void 0})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){c.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),c.Event=function(e,t){v(e)||(e=(t=e).type);var n=document.createEvent(o[e]||"Events"),r=!0;if(t)for(var i in t)"bubbles"==i?r=!!t[i]:n[i]=t[i];return n.initEvent(e,r,!0),g(n)}}(Q),function(f){function h(e,t,n,r){return e.global?(t=t||E,n=n,r=r,n=f.Event(n),f(t).trigger(n,r),!n.isDefaultPrevented()):void 0}function p(e,t){var n=t.context;return!1!==t.beforeSend.call(n,e,t)&&!1!==h(t,n,"ajaxBeforeSend",[e,t])&&void h(t,n,"ajaxSend",[e,t])}function y(e,t,n,r){var i=n.context,o="success";n.success.call(i,e,o,t),r&&r.resolveWith(i,[e,o,t]),h(n,i,"ajaxSuccess",[t,n,e]),a(o,t,n)}function g(e,t,n,r,i){var o=r.context;r.error.call(o,n,t,e),i&&i.rejectWith(o,[n,t,e]),h(r,o,"ajaxError",[n,r,e||t]),a(t,n,r)}function a(e,t,n){var r=n.context;n.complete.call(r,t,e),h(n,r,"ajaxComplete",[t,n]),(n=n).global&&!--f.active&&h(n,null,"ajaxStop")}function m(){}function v(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function s(e,t,n,r){return f.isFunction(t)&&(r=n,n=t,t=void 0),f.isFunction(n)||(r=n,n=void 0),{url:e,data:t,success:n,dataType:r}}var b,_,c=0,E=window.document,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,k=/^(?:text|application)\/javascript/i,A=/^(?:text|application)\/xml/i,S="application/json",w=/^\s*$/,T=E.createElement("a");T.href=window.location.href,f.active=0,f.ajaxJSONP=function(n,r){if(!("type"in n))return f.ajax(n);function e(e){f(s).triggerHandler("error",e||"abort")}var i,o,t=n.jsonpCallback,a=(f.isFunction(t)?t():t)||"jsonp"+ ++c,s=E.createElement("script"),l=window[a],u={abort:e};return r&&r.promise(u),f(s).on("load error",function(e,t){clearTimeout(o),f(s).off().remove(),"error"!=e.type&&i?y(i[0],u,n,r):g(null,t||"error",u,n,r),window[a]=l,i&&f.isFunction(l)&&l(i[0]),l=i=void 0}),!1===p(u,n)?e("abort"):(window[a]=function(){i=arguments},s.src=n.url.replace(/\?(.+)=\?/,"?$1="+a),E.head.appendChild(s),0<n.timeout&&(o=setTimeout(function(){e("timeout")},n.timeout))),u},f.ajaxSettings={type:"GET",beforeSend:m,success:m,error:m,complete:m,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:S,xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},f.ajax=function(e){var t,n=f.extend({},e||{}),r=f.Deferred&&f.Deferred();for(b in f.ajaxSettings)void 0===n[b]&&(n[b]=f.ajaxSettings[b]);(t=n).global&&0==f.active++&&h(t,null,"ajaxStart"),n.crossDomain||((o=E.createElement("a")).href=n.url,o.href=o.href,n.crossDomain=T.protocol+"//"+T.host!=o.protocol+"//"+o.host),n.url||(n.url=window.location.toString()),-1<(o=n.url.indexOf("#"))&&(n.url=n.url.slice(0,o)),(o=n).processData&&o.data&&"string"!=f.type(o.data)&&(o.data=f.param(o.data,o.traditional)),!o.data||o.type&&"GET"!=o.type.toUpperCase()||(o.url=v(o.url,o.data),o.data=void 0);var i=n.dataType,o=/\?.+=\?/.test(n.url);if(o&&(i="jsonp"),!1!==n.cache&&(e&&!0===e.cache||"script"!=i&&"jsonp"!=i)||(n.url=v(n.url,"_="+Date.now())),"jsonp"==i)return o||(n.url=v(n.url,n.jsonp?n.jsonp+"=?":!1===n.jsonp?"":"callback=?")),f.ajaxJSONP(n,r);function a(e,t){l[e.toLowerCase()]=[e,t]}var s,o=n.accepts[i],l={},u=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,c=n.xhr(),d=c.setRequestHeader;if(r&&r.promise(c),n.crossDomain||a("X-Requested-With","XMLHttpRequest"),a("Accept",o||"*/*"),(o=n.mimeType||o)&&(-1<o.indexOf(",")&&(o=o.split(",",2)[0]),c.overrideMimeType&&c.overrideMimeType(o)),(n.contentType||!1!==n.contentType&&n.data&&"GET"!=n.type.toUpperCase())&&a("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(_ in n.headers)a(_,n.headers[_]);if(c.setRequestHeader=a,!(c.onreadystatechange=function(){if(4==c.readyState){c.onreadystatechange=m,clearTimeout(s);var t=!1;if(200<=c.status&&c.status<300||304==c.status||0==c.status&&"file:"==u){i=i||((e=(e=n.mimeType||c.getResponseHeader("content-type"))&&e.split(";",2)[0])&&("text/html"==e?"html":e==S?"json":k.test(e)?"script":A.test(e)&&"xml")||"text"),e=c.responseText;try{"script"==i?(0,eval)(e):"xml"==i?e=c.responseXML:"json"==i&&(e=w.test(e)?null:f.parseJSON(e))}catch(e){t=e}t?g(t,"parsererror",c,n,r):y(e,c,n,r)}else g(c.statusText||null,c.status?"error":"abort",c,n,r)}var e})===p(c,n))return c.abort(),g(null,"abort",c,n,r),c;if(n.xhrFields)for(_ in n.xhrFields)c[_]=n.xhrFields[_];o=!("async"in n)||n.async;for(_ in c.open(n.type,n.url,o,n.username,n.password),l)d.apply(c,l[_]);return 0<n.timeout&&(s=setTimeout(function(){c.onreadystatechange=m,c.abort(),g(null,"timeout",c,n,r)},n.timeout)),c.send(n.data||null),c},f.get=function(){return f.ajax(s.apply(null,arguments))},f.post=function(){var e=s.apply(null,arguments);return e.type="POST",f.ajax(e)},f.getJSON=function(){var e=s.apply(null,arguments);return e.dataType="json",f.ajax(e)},f.fn.load=function(e,t,n){if(!this.length)return this;var r,i=this,o=e.split(/\s/),n=s(e,t,n),a=n.success;return 1<o.length&&(n.url=o[0],r=o[1]),n.success=function(e){i.html(r?f("<div>").html(e.replace(l,"")).find(r):e),a&&a.apply(i,arguments)},f.ajax(n),this};var r=encodeURIComponent;f.param=function(e,t){var n=[];return n.add=function(e,t){null==(t=f.isFunction(t)?t():t)&&(t=""),this.push(r(e)+"="+r(t))},function n(r,e,i,o){var a,s=f.isArray(e),l=f.isPlainObject(e);f.each(e,function(e,t){a=f.type(t),o&&(e=i?o:o+"["+(l||"object"==a||"array"==a?e:"")+"]"),!o&&s?r.add(t.name,t.value):"array"==a||!i&&"object"==a?n(r,t,i,e):r.add(e,t)})}(n,e,t),n.join("&").replace(/%20/g,"+")}}(Q),(f=Q).Callbacks=function(r){r=f.extend({},r);function n(e){for(t=r.memory&&e,i=!0,l=a||0,a=0,s=u.length,o=!0;u&&l<s;++l)if(!1===u[l].apply(e[0],e[1])&&r.stopOnFalse){t=!1;break}o=!1,u&&(c?c.length&&n(c.shift()):t?u.length=0:d.disable())}var t,i,o,a,s,l,u=[],c=!r.once&&[],d={add:function(){var e;return u&&(e=u.length,function n(e){f.each(e,function(e,t){"function"==typeof t?r.unique&&d.has(t)||u.push(t):t&&t.length&&"string"!=typeof t&&n(t)})}(arguments),o?s=u.length:t&&(a=e,n(t))),this},remove:function(){return u&&f.each(arguments,function(e,t){for(var n;-1<(n=f.inArray(t,u,n));)u.splice(n,1),o&&(n<=s&&--s,n<=l&&--l)}),this},has:function(e){return!(!u||!(e?-1<f.inArray(e,u):u.length))},empty:function(){return s=u.length=0,this},disable:function(){return u=c=t=void 0,this},disabled:function(){return!u},lock:function(){return c=void 0,t||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!u||i&&!c||(t=[e,(t=t||[]).slice?t.slice():t],o?c.push(t):n(t)),this},fire:function(){return d.fireWith(this,arguments)},fired:function(){return!!i}};return d},q=Q,X=Array.prototype.slice,q.when=function(e){function t(t,n,r){return function(e){n[t]=this,r[t]=1<arguments.length?X.call(arguments):e,r===i?u.notifyWith(n,r):--l||u.resolveWith(n,r)}}var i,n,r,o=X.call(arguments),a=o.length,s=0,l=1!==a||e&&q.isFunction(e.promise)?a:0,u=1===l?e:ke();if(1<a)for(i=new Array(a),n=new Array(a),r=new Array(a);s<a;++s)o[s]&&q.isFunction(o[s].promise)?o[s].promise().done(t(s,r,o)).fail(u.reject).progress(t(s,n,i)):--l;return l||u.resolveWith(r,o),u.promise()},q.Deferred=ke,W={},(G=Q)(document).ready(function(){var t,n,r,i,o=0,a=0;"MSGesture"in window&&((z=new MSGesture).target=document.body),G(document).bind("MSGestureEnd",function(e){e=1<e.velocityX?"Right":e.velocityX<-1?"Left":1<e.velocityY?"Down":e.velocityY<-1?"Up":null;e&&(W&&W.el&&W.el.trigger("swipe"),W&&W.el&&W.el.trigger("swipe"+e))}).on("touchstart MSPointerDown pointerdown",function(e){(i=Ee(e,"down"))&&!_e(e)||(r=i?e:e.touches[0],e.touches&&1===e.touches.length&&W.x2&&(W.x2=void 0,W.y2=void 0),t=Date.now(),n=t-(W.last||t),W.el=G("tagName"in r.target?r.target:r.target.parentNode),V&&clearTimeout(V),W.x1=r.pageX,W.y1=r.pageY,0<n&&n<=250&&(W.isDoubleTap=!0),W.last=t,$=setTimeout(me,750),z&&i&&z.addPointer(e.pointerId))}).on("touchmove MSPointerMove pointermove",function(e){(i=Ee(e,"move"))&&!_e(e)||(r=i?e:e.touches[0],ve(),W.x2=r.pageX,W.y2=r.pageY,o+=Math.abs(W.x1-W.x2),a+=Math.abs(W.y1-W.y2))}).on("touchend MSPointerUp pointerup",function(e){(i=Ee(e,"up"))&&!_e(e)||(ve(),W.x2&&30<Math.abs(W.x1-W.x2)||W.y2&&30<Math.abs(W.y1-W.y2)?K=setTimeout(function(){var e,t,n,r;W&&W.el&&W.el.trigger("swipe"),W&&W.el&&W.el.trigger("swipe"+(e=W.x1,t=W.x2,n=W.y1,r=W.y2,Math.abs(e-t)>=Math.abs(n-r)?0<e-t?"Left":"Right":0<n-r?"Up":"Down")),W={}},0):"last"in W&&(o<30&&a<30?H=setTimeout(function(){var e=G.Event("tap");e.cancelTouch=be,W.el&&W.el.trigger(e),W.isDoubleTap?(W.el&&W.el.trigger("doubleTap"),W={}):V=setTimeout(function(){V=null,W.el&&W.el.trigger("singleTap"),W={}},250)},0):W={}),o=a=0)}).on("touchcancel MSPointerCancel pointercancel",be),G(window).on("scroll",be)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){G.fn[t]=function(e){return this.on(t,e)}}),M=(I=Q).zepto,j=M.qsa,F=M.matches,N=I.expr[":"]={visible:function(){return ye(this)?this:void 0},hidden:function(){return ye(this)?void 0:this},selected:function(){return this.selected?this:void 0},checked:function(){return this.checked?this:void 0},parent:function(){return this.parentNode},first:function(e){return 0===e?this:void 0},last:function(e,t){return e===t.length-1?this:void 0},eq:function(e,t,n){return e===n?this:void 0},contains:function(e,t,n){return-1<I(this).text().indexOf(n)?this:void 0},has:function(e,t,n){return M.qsa(this,n).length?this:void 0}},U=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),B=/^\s*>/,Y="Zepto"+ +new Date,M.qsa=function(o,a){return ge(a,function(e,n,r){try{var t;!e&&n?e="*":B.test(e)&&(t=I(o).addClass(Y),e="."+Y+" "+e);var i=j(o,e)}catch(e){throw console.error("error performing selector: %o",a),e}finally{t&&t.removeClass(Y)}return n?M.uniq(I.map(i,function(e,t){return n.call(e,t,i,r)})):i})},M.matches=function(r,e){return ge(e,function(e,t,n){return!(e&&!F(r,e)||t&&t.call(r,null,n)!==r)})},function(){try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e){try{return t(e)}catch(e){return null}}}}(),e.exports=Q},function(e,t,n){"use strict";var i=n(6);function l(){}var u={},o=["REJECTED"],a=["FULFILLED"],r=["PENDING"];function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,e!==l&&h(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(t,n,r){i(function(){var e;try{e=n(r)}catch(e){return u.reject(t,e)}e===t?u.reject(t,new TypeError("Cannot resolve promise with itself")):u.resolve(t,e)})}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(t,e){var n=!1;function r(e){n||(n=!0,u.reject(t,e))}function i(e){n||(n=!0,u.resolve(t,e))}var o=p(function(){e(i,r)});"error"===o.status&&r(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(e.exports=s).prototype.finally=function(t){if("function"!=typeof t)return this;var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(l);return this.state!==r?d(n,this.state===a?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){u.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){u.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},u.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return u.reject(e,n.value);n=n.value;if(n)h(e,n);else{e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},u.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},s.resolve=function(e){return e instanceof this?e:u.resolve(new this(l),e)},s.reject=function(e){var t=new this(l);return u.reject(t,e)},s.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var o=new Array(r),a=0,t=-1,s=new this(l);++t<r;)!function(e,t){n.resolve(e).then(function(e){o[t]=e,++a!==r||i||(i=!0,u.resolve(s,o))},function(e){i||(i=!0,u.reject(s,e))})}(e[t],t);return s},s.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,i=-1,o=new this(l);++i<t;)r=e[i],this.resolve(r).then(function(e){n||(n=!0,u.resolve(o,e))},function(e){n||(n=!0,u.reject(o,e))});return o}},function(e,t){var n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var r,o;window,e.exports=(o={},i.m=r=[function(e,t){e.exports=function(o){var a=[];return a.toString=function(){return this.map(function(i){var e=function(){var e=i[1]||"",t=i[3];if(!t)return e;if(o&&"function"==typeof btoa){var n="/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */",r=t.sources.map(function(e){return"/*# sourceURL="+t.sourceRoot+e+" */"});return[e].concat(r).concat([n]).join("\n")}return[e].join("\n")}();return i[2]?"@media "+i[2]+"{"+e+"}":e}).join("")},a.i=function(e,t){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(n[i]=!0)}for(r=0;r<e.length;r++){var o=e[r];"number"==typeof o[0]&&n[o[0]]||(t&&!o[2]?o[2]=t:t&&(o[2]="("+o[2]+") and ("+t+")"),a.push(o))}},a}},function(e,t,r){var n,i,l={},o=function(){return i=void 0===i?function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments):i},a=(n={},function(e,t){if("function"==typeof e)return e();if(void 0===n[e]){t=function(e,t){return(t||document).querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}),s=null,u=0,c=[],d=r(58);function f(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=l[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(v(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(v(r.parts[o],t));l[r.id]={id:r.id,refs:1,parts:a}}}}function h(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],o={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(o):n.push(r[a]={id:a,parts:[o]})}return n}function p(e,t){var n=a(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=c[c.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),c.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");e=a(e.insertAt.before,n);n.insertBefore(t,e)}}function y(e){null!==e.parentNode&&(e.parentNode.removeChild(e),0<=(e=c.indexOf(e))&&c.splice(e,1))}function g(e){var t,n=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce&&(t=r.nc)&&(e.attrs.nonce=t),m(n,e.attrs),p(e,n),n}function m(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function v(t,e){var n,r,i,o,a;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}return i=e.singleton?(a=u++,n=s=s||g(e),r=E.bind(null,n,a,!1),E.bind(null,n,a,!0)):t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=e,a=document.createElement("link"),void 0===o.attrs.type&&(o.attrs.type="text/css"),o.attrs.rel="stylesheet",m(a,o.attrs),p(o,a),n=a,r=function(e,t,n){var r=n.css,i=n.sourceMap,n=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||n)&&(r=d(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");i=new Blob([r],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(i),r&&URL.revokeObjectURL(r)}.bind(null,n,e),function(){y(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),r=function(e,t){var n=t.css,t=t.media;if(t&&e.setAttribute("media",t),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),function(){y(n)}),r(t),function(e){e?e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap||r(t=e):i()}}e.exports=function(e,a){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(a=a||{}).attrs="object"==typeof a.attrs?a.attrs:{},a.singleton||"boolean"==typeof a.singleton||(a.singleton=o()),a.insertInto||(a.insertInto="head"),a.insertAt||(a.insertAt="bottom");var s=h(e,a);return f(s,a),function(e){for(var t,n=[],r=0;r<s.length;r++){var i=s[r];(t=l[i.id]).refs--,n.push(t)}for(e&&f(h(e,a),a),r=0;r<n.length;r++)if(0===(t=n[r]).refs){for(var o=0;o<t.parts.length;o++)t.parts[o]();delete l[t.id]}}};var b,_=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function E(e,t,n,r){var n=n?"":r.css;e.styleSheet?e.styleSheet.cssText=_(t,n):(r=document.createTextNode(n),(n=e.childNodes)[t]&&e.removeChild(n[t]),n.length?e.insertBefore(r,n[t]):e.appendChild(r))}},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e){!function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.options=e||{}}e.exports=(n(i,[{key:"name",get:function(){return this.constructor.name}},{key:"tagName",get:function(){return this.options.tagName||"div"}},{key:"attributes",get:function(){return{class:this.options.className}}}]),n(i,[{key:"attr",value:function(e,t){if(void 0===t)return this.element.getAttribute(e);this.element.setAttribute(e,t)}},{key:"show",value:function(){this.removeClass("ad_runner_ui_hide")}},{key:"hide",value:function(){this.addClass("ad_runner_ui_hide")}},{key:"on",value:function(e,t){this.element.addEventListener(e,t)}},{key:"off",value:function(e,t){this.element.removeEventListener(e,t)}},{key:"html",value:function(e){this.element.innerHTML=e}},{key:"style",value:function(e,t){this.element.style[e]=t}},{key:"appendChild",value:function(e){this.element.appendChild(e.element||e)}},{key:"hasClass",value:function(e){return this.element.classList?this.element.classList.contains(e):new RegExp("(^|\\s)"+e+"($|\\s)").test(this.element.className)}},{key:"addClass",value:function(e){this.element.classList?this.element.classList.add(e):this.hasClass(this.element,e)||(this.element.className=(this.element.className+" "+e).trim())}},{key:"removeClass",value:function(t){this.element.classList?this.element.classList.remove(t):this.element.className=this.element.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")}},{key:"render",value:function(){var n=this;this.element=this.options.element||document.createElement(this.tagName),Object.keys(this.attributes).forEach(function(e){var t=n.attributes[e];void 0!==t&&n.element.setAttribute(e,t)})}},{key:"remove",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null}}]),i)},function(e,t,n){var r=n(5).DEFAULT_MAX_VOLUME;function i(e,t){return-1<String(e).toUpperCase().indexOf(String(t).toUpperCase())}function o(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n}e.exports={contentVolumeToAdVolume:function(e){return e?e/100*r:0},convertToSecond:function(e){e=isNaN(e)?e.split(":"):e;return 60*+e[0]*60+60*+e[1]+ +e[2]},isImaAd:function(e){return!i(e.system.name,"celtra")&&(i(e.system.name,"google")||i(e.system.version,"google"))},isFacebookAd:function(e){return i(e.system.name,"facebook")||i(e.system.version,"facebook")},isAsiaSmartAd:function(e){return e.vastAdTagURI&&i(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||i(e.system.name,"smart")||i(e.system.name,"wootag")},formatTime:function(e,t){if(!isFinite(e))return"--:--";e*=1e3;var n=(e=parseInt(e/1e3))%60,r=(e=parseInt(e/60))%60,i=(e=parseInt(e/60))%24,o=parseInt(e/24),e="";return o&&0<o&&(e+=o+":",i<1&&(e+="00:")),(i&&0<i||t)&&(e+=("0"+i).slice(-2)+":"),e+=("0"+r).slice(-2)+":",(e+=("0"+n).slice(-2)).trim()},createPromiseDefer:o,createTimeoutPromise:function(e){var t=o(),n=setTimeout(t.resolve,e);return t.promise.cancel=function(){return clearTimeout(n)},t.promise},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i.test(navigator.userAgent)}}},function(e,t,n){"use strict";var r=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdViewableImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoProgress","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError","AdClickBackground","AdClickThruVpaid"];r.forEach(function(e){r[e]=e}),Object.freeze(r),e.exports=r},function(e,t){e.exports={AD_POSITION:{preroll:"pre-roll",midroll:"mid-roll",postroll:"post-roll"},AD_DONE_REASON:{timeout:"timeout",error:"error",ended:"ended",skipped:"skipped"},COUNT_DOWN_DURATION:5,PRELOAD_DURATION:7,DEFAULT_MIDROLL_START_TIME:10,DEFAULT_SKIP_TIMEOUT:3,DEFAULT_AD_START_TIMEOUT:10,DEFAULT_NON_LINEAR_DURATION:15,DEFAULT_MAX_VOLUME:.75}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"===n(e)&&null!==e}function c(e){return void 0===e}r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,o,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(c(n=this._events[e]))return!1;if(l(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(u(n))for(i=Array.prototype.slice.call(arguments,1),r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i);return!0},r.prototype.on=r.prototype.addListener=function(e,t){var n;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(n=c(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,i,o;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||l(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(n)){for(o=i;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.exports=r},function(e,t,n){e.exports={VastPlayer:n(20),VAST:n(12),EventEmitter:n(6)}},function(e,t,n){"use strict";var r=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];r.forEach(function(e){this[e.toUpperCase()]=e},r),Object.freeze(r),e.exports=r},function(e,t,n){"use strict";var r=n(37),i=document.createElement("video");n(14),t.isDesktop=!/Android|Silk|Mobile|PlayBook/.test(r.navigator.userAgent),t.canPlay=function(e){switch(i.canPlayType(e)){case"probably":return 2;case"maybe":return 1;default:return 0}},Object.freeze(t)},function(e,t,n){"use strict";function i(n,e,r){e.on(n,function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];r.emit.apply(r,[n].concat(e))})}function r(t,n,r){r.forEach(function(e){0<n.listeners(e).length&&i(e,t,n)}),n.on("newListener",function(e){-1<r.indexOf(e)&&n.listeners(e).length<1&&i(e,t,n)})}function o(e){this.events=e.slice(),this.__private__={target:null,source:null}}o.prototype.from=function(e){return this.__private__.source=e,this.__private__.target&&r(e,this.__private__.target,this.events),this},o.prototype.to=function(e){return this.__private__.target=e,this.__private__.source&&r(this.__private__.source,e,this.events),this},e.exports=o},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n,r){!function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.adContainerElement=e,this.videoContent=t,this.logger=n.logger,this.onAdStarted=n.onAdStarted,this.onAdStopped=n.onAdStopped,this.onAdLoaded=n.onAdLoaded,this.options=r,this.logger.debug(this.name,"initializing")}e.exports=(n(i,[{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!1}},{key:"viewDetailLink",get:function(){return""}}]),n(i,[{key:"loadAd",value:function(e){throw new Error("this must be overridden")}},{key:"initUserAction",value:function(){throw new Error("this must be overridden")}},{key:"canRun",value:function(e){throw new Error("this must be overridden")}},{key:"start",value:function(){throw new Error("this must be overridden")}},{key:"stop",value:function(){throw new Error("this must be overridden")}},{key:"pause",value:function(){throw new Error("this must be overridden")}},{key:"resume",value:function(){throw new Error("this must be overridden")}},{key:"cancel",value:function(){throw new Error("this must be overridden")}},{key:"viewDetail",value:function(){throw new Error("this must be overridden")}},{key:"setVolume",value:function(e){throw new Error("this must be overridden")}},{key:"setAdData",value:function(e){this.adData=e}},{key:"getVolume",value:function(){throw new Error("this must be overridden")}},{key:"isPaused",value:function(){throw new Error("this must be overridden")}},{key:"getRemainingTime",value:function(){throw new Error("this must be overridden")}},{key:"getDuration",value:function(){throw new Error("this must be overridden")}},{key:"getSkipOffset",value:function(){throw new Error("this must be overridden")}},{key:"resize",value:function(e,t,n){}},{key:"destroy",value:function(){throw new Error("this must be overridden")}}]),i)},function(e,t,n){e.exports=n(21)},function(e,t,n){"use strict";e.exports=function(){return Array.prototype.slice.call(arguments).reduce(function(e,n){return Object.keys(n||{}).reduce(function(e,t){return e[t]=n[t],e},e)},{})}},function(e,t){var n={JAVASCRIPT:"application/javascript",FLASH:"application/x-shockwave-flash"};Object.freeze(n),e.exports=n},function(e,t,n){"use strict";var r=n(39),i=n(8);function o(t,e){var n=this;r.call(this,Math.floor(t.duration||0),e),this.video=t,[i.PLAYING,i.PAUSE,i.TIMEUPDATE].forEach(function(e){return t.addEventListener(e,function(){return n.tick()},!1)})}(o.prototype=Object.create(r.prototype))._getState=function(){return{playing:!this.video.paused,currentTime:this.video.currentTime}},e.exports=o},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function f(){}var o=n(46),a=n(52),h=n(53),p=(n(3).createPromiseDefer,[o,a,h]),a=(i(y,[{key:"name",get:function(){return"Player"}}]),i(y,[{key:"initUserAction",value:function(){this.players.forEach(function(e){return e.initUserAction()})}},{key:"load",value:function(e){return this.adData=e,this.adCancelled=!1,this.adStarted=!1,this.lastError=null,this.loadPromise=this._loadAd(),this.loadPromise}},{key:"start",value:function(){this._playAd()}},{key:"stop",value:function(){this.currentPlayer.stop()}},{key:"skip",value:function(){this.currentPlayer.skip()}},{key:"cancel",value:function(){this.adCancelled=!0,this.currentPlayer&&this.currentPlayer.cancel()}},{key:"pause",value:function(){this.currentPlayer.pause()}},{key:"resume",value:function(){this.currentPlayer.resume()}},{key:"destroy",value:function(){this.players.forEach(function(e){return e.destroy()})}},{key:"resize",value:function(t,n,r){this.players.forEach(function(e){return e.resize(t,n,r)})}},{key:"setVolume",value:function(e){this.adVolume=e,this.currentPlayer&&this.currentPlayer.setVolume(e)}},{key:"getCurrentPlayer",value:function(){return this.currentPlayer}},{key:"isPlayingLinearAd",value:function(){return this.currentPlayer instanceof o?this.currentPlayer.currentAd&&this.currentPlayer.currentAd.isLinear():!(this.currentPlayer instanceof h)}},{key:"isGoogleNonLinearAd",value:function(){return this.currentPlayer instanceof o&&this.currentPlayer.currentAd&&!this.currentPlayer.currentAd.isLinear()}},{key:"_onAdStarted",value:function(){this.adStarted=!0,this.props.onAdStarted()}},{key:"_onAdStopped",value:function(e,t,n,r){r=r||this.adData;this.adStarted||n?this.props.onAdStopped(e,t,r):(this.lastError=e,this._playAd(this.adIndex+1))}},{key:"_onAdSkipped",value:function(){this.props.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.props.onAdLoaded()}},{key:"_loadAd",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(this.logger.debug(this.name,"_loadAd | adIndex",n," | adData",this.adData.ads),this.adCancelled)return Promise.resolve();var e=this.adData.ads[n];if(this.currentPlayer=null,!e)return 0<n&&this.logger.debug(this.name,"no ad left to load"),Promise.resolve();this.logger.debug(this.name,"loading ad item ".concat(n+1,"/").concat(this.adData.ads.length),e);var r=this._getPlayerForAd(e);return r?r.loadAd(e,this.adData).then(function(){return t.logger.debug(t.name,"ad loaded"),{player:r,adIndex:n}}).catch(function(e){return t.logger.error(t.name,"error while loading ad, falling back to next item:",e),t._loadAd(n+1)}):(this.logger.debug(this.name,"no player to play this ad, trying next item",e),this._loadAd(n+1))}},{key:"_playAd",value:function(){var e,n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.adCancelled||(this.loadPromise?(e=this.loadPromise,delete this.loadPromise):e=this._loadAd(t),e.then(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.player,e=e.adIndex;n.adCancelled||(t?(n.adIndex=e,(n.currentPlayer=t).setAdData(n.adData),t.setVolume(n.adVolume),t.start()):n._onAdStopped(n.lastError||new Error("Cannot run ad"),null,!0))}))}},{key:"_getPlayerForAd",value:function(t){return this.players.filter(function(e){return e.canRun(t)})[0]}}]),y);function y(e){var t=this,n=e.linearAdContainer,r=e.nonLinearAdContainer,i=e.contentPlayer,o=e.logger,a=e.onAdStarted,s=e.onAdStopped,l=e.onAdSkipped,u=e.onAdLoaded,c=e.onResetState,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e){if(!(e instanceof y))throw new TypeError("Cannot call a class as a function")}(this),this.logger=o,this.props={onAdStarted:a,onAdStopped:s,onAdSkipped:l,onAdLoaded:u||f,onResetState:c||f},this.loadPromise=null,this.currentPlayer=null,this.adData=null,this.adStarted=!1,this.adCancelled=!1,this.adVolume=1,this.lastError=null,this.players=p.map(function(e){return new e(e===h?r:n,i,{logger:o,onAdStarted:t._onAdStarted.bind(t),onAdStopped:t._onAdStopped.bind(t),onAdSkipped:t._onAdSkipped.bind(t),onAdLoaded:t._onAdLoaded.bind(t)},d)})}e.exports=a},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),u=n(3).formatTime;function c(e){var t;if(function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=i(c).call(this,e))||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).render(),"string"!=typeof e.options.template)throw new Error("options.template is required");return e}n(62),e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,l),a(c,[{key:"attributes",get:function(){return{class:this.options.className||"ad_runner_ui_countdown"}}}]),a(c,[{key:"update",value:function(e){this._setRemainingTime(e)}},{key:"_setRemainingTime",value:function(e){e=this.options.formatTime?u(e):Math.round(e);this.element.textContent=this.options.template.replace("%s",e)}}]),c)},function(e,t,n){e.exports={Runner:n(19),Player:n(16),VAST:n(7).VAST}},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=n(7).VAST,a=n(16),s=n(60),l=n(61),u=n(87),c=n(3),d=c.contentVolumeToAdVolume,f=c.convertToSecond,h=c.createPromiseDefer,p=c.createTimeoutPromise,y=n(5),g=y.AD_POSITION,m=y.AD_DONE_REASON,c=y.DEFAULT_AD_START_TIMEOUT,n=y.DEFAULT_MIDROLL_START_TIME,v=1,b=2,_=3,E=4,k={startTimeout:c,skipTimeout:y.DEFAULT_SKIP_TIMEOUT,countdownPlay:!0,defaultMidrollStartTime:n,getPoster:function(){},showSlideBlack:!1,removeAdmarkOnError:!0,autoPlayAdBreaks:!0,autoPlay:!1,mute:!1},n=(i(A,[{key:"name",get:function(){return"Runner"}},{key:"logger",get:function(){return this.plugin.getLogger()}},{key:"viewDetailLink",get:function(){var e=this.player.getCurrentPlayer();return e&&e.viewDetailLink}}]),i(A,[{key:"onContentProgress",value:function(e){this.scheduler.onContentProgress(e)}},{key:"onContentEnded",value:function(){this.scheduler.onContentEnded(),this.adMark.removeMarkItems()}},{key:"onUserAction",value:function(){this.player.initUserAction()}},{key:"onAdsDataLoaded",value:function(e){var t=this;this.logger.debug(this.name,"onAdsDataLoaded",e),this._normalizeAdsData(e),this.scheduler.populateAdsData(e),this.plugin.getContentMetadata().then(function(e){t.scheduler&&t.scheduler.dataLoadingDeferred.promise.then(function(){t.adMark.render(e.duration,t.scheduler.midrollAds)})})}},{key:"destroy",value:function(){this.player.destroy(),this.player=null,this.scheduler=null,this.adUi.remove(),this.adMark.remove()}},{key:"resize",value:function(e,t,n){this.player.resize(e,t,n)}},{key:"pauseAd",value:function(){this.player.pause()}},{key:"resumeAd",value:function(){this.player.resume()}},{key:"stopAd",value:function(){this.player.stop()}},{key:"showPosterAndPlayIcon",value:function(){var e=this.adUi.skipButton,t=e.poster,n=e.playIcon;!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?(e.loadPoster(),t.show(),n.show()):(t.hide(),n.hide())}},{key:"_onResetState",value:function(){this.state=v,this.adsLoaded=!1}},{key:"_preloadAd",value:function(e){this.adsLoaded||this._loadAd(e)}},{key:"_prepareAd",value:function(e,t){this.options.countdownPlay&&this.adsLoaded&&(this.adUi.countdownToPlay.show(),this.adUi.countdownToPlay.update(t))}},{key:"_beforePlayAd",value:function(e,t){var n=this;this.adUi.countdownToPlay.hide(),e||!this.adsLoaded?setTimeout(function(){n.adsLoaded&&(n.options.showSlideBlack?(n.plugin.pauseForAd(),n.logger.debug(n.name,"Showing black screen"),n.adUi.slideBlack.show(),n.adUi.slideBlack.fadeIn(),setTimeout(function(){t()},2e3)):t())},1e3):t()}},{key:"_loadAd",value:function(e){this.state===v&&(this.adsLoaded=!1,this.state=b,this.adDeferred=h(),this.logger.debug(this.name,"loading ad",e),this.player.load(e))}},{key:"_playAd",value:function(e,t){var n=this;return this._loadAd(e),this.logger.debug(this.name,"play ad",e),this.state=_,this.adMetadata=t,this.adUi.onAdWillStart(),this.plugin.onAdWillStart&&this.plugin.onAdWillStart(),this.adTimeoutPromise=p(1e3*this.options.startTimeout),this.adTimeoutPromise.then(function(){n.logger.debug(n.name,"cannot start ad within ".concat(n.options.startTimeout,"s, cancelling...")),n.player&&n.player.cancel(),n._onAdStopped(null,m.timeout,e)}),this.player.setVolume(d(this.plugin.getContentVolume())),this.player.start(),this.adDeferred.promise}},{key:"_onAdStarted",value:function(){var e=this;this._mayPauseContent();var t=this.player.getCurrentPlayer();this.state=E,this.adTimeoutPromise.cancel(),this.adUi.slideBlack.fadeOut(),setTimeout(function(){e.adUi.slideBlack.hide()},400),this.adUi.setPlayer(t),this.adUi.onAdStarted(this.adMetadata),this.plugin.onAdStarted&&this.plugin.onAdStarted(),this.logger.debug(this.name,"ad started by player:",t.name),this.player.isPlayingLinearAd()||(this.state=v,this.adDeferred.resolve(),this._mayResumeContent())}},{key:"_onAdStopped",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:m.ended,n=2<arguments.length?arguments[2]:void 0;e&&(t=m.error),this.player.isGoogleNonLinearAd()&&this.plugin.hideLinearAdContainer&&this.plugin.hideLinearAdContainer(),e&&!this.options.removeAdmarkOnError||!n._completeAd||n._completeAd(),this.state,this.adTimeoutPromise.cancel(),this.adUi.onAdStopped(),this.plugin.onAdStopped&&this.plugin.onAdStopped(t),this._mayResumeContent(),this.logger.debug(this.name,"ad stopped:",t,e||""),this.adUi.slideBlack.hide(),this.state=v,this.adsLoaded=!1,this.adDeferred.resolve()}},{key:"_onAdSkipped",value:function(){this.plugin.onAdSkipped&&this.plugin.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.adsLoaded=!0}},{key:"_mayPauseContent",value:function(){this.player.isPlayingLinearAd()?this.plugin.pauseForAd():this.player.isGoogleNonLinearAd()&&(this.plugin.showLinearAdContainer&&this.plugin.showLinearAdContainer(),this.adUi.onAdStopped())}},{key:"_mayResumeContent",value:function(){this.adMetadata.order===this.adMetadata.total&&this.plugin.resumeAfterAd()}},{key:"_normalizeAdsData",value:function(e){var t=this;e.forEach(function(e){e.ads=o.pojoFromXML(e.server.tag).ads,delete e.server,Object.assign(e,t._buildAdOption(e))})}},{key:"_buildAdOption",value:function(e){e={position:e.position,skipoffset:e.skipoffset?f(e.skipoffset):-1,startTime:e.startTime?f(e.startTime):0};return e.position!==g.midroll||e.startTime||(this.logger.warn(this.name,"no startTime specified on mid-roll ad, will use default startTime:",this.options.defaultMidrollStartTime),e.startTime=this.options.defaultMidrollStartTime),e}},{key:"_normalizeOption",value:function(){return Object.assign({},k,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{getPoster:this.plugin.getPoster&&this.plugin.getPoster.bind(this.plugin)})}}]),A);function A(e,t){!function(e){if(!(e instanceof A))throw new TypeError("Cannot call a class as a function")}(this),this.plugin=e,this.options=this._normalizeOption(t);t=e.getAdContainers(),e=e.getContentPlayer();this.player=new a({linearAdContainer:t.linear,nonLinearAdContainer:t.nonLinear,contentPlayer:e,logger:this.logger,onAdStarted:this._onAdStarted.bind(this),onAdStopped:this._onAdStopped.bind(this),onAdSkipped:this._onAdSkipped.bind(this),onAdLoaded:this._onAdLoaded.bind(this),onResetState:this._onResetState.bind(this)},this.options),this.scheduler=new s({logger:this.logger,prepareAd:this._prepareAd.bind(this),beforePlayAd:this._beforePlayAd.bind(this),preloadAd:this._preloadAd.bind(this),loadAd:this._loadAd.bind(this),playAd:this._playAd.bind(this)}),this.adUi=new l(this.options,t),this.adMark=new u(t.adMark),this.state=v,this.adsLoaded=!1,this.adDeferred=null}e.exports=n},function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(6),r=n(12),l=n(35),u=n(40),c=n(4),d=n(10),f=n(43),o=n(44),a=n(9),h=n(45);function p(e){return e}function y(){return new Error("VASTPlayer not ready.")}function g(n){return function(){var e=this,t=this.__private__.player;return this.ready?(t[n]?t[n].apply(t,arguments):Promise.resolve()).then(function(){return e}):Promise.reject(y())}}function m(t){return{get:function(){if(!this.ready)throw y();return this.__private__.player[t]},set:function(e){if(!this.ready)throw y();return this.__private__.player[t]=e}}}function v(e,t){return-1<String(e).toUpperCase().indexOf(String(t).toUpperCase())}function b(e,t){var n=this;i.call(this),this.__private__={container:e,config:function e(){for(var t,n,r,i={},o=arguments.length,a=0;a<o;a++)for(n in t=arguments[a]||{})r=t[n],void 0===i[n]&&(i[n]=r),"object"===s(r)&&(i[n]=e(i[n],r));return i}(t,{vast:{resolveWrappers:!0,maxRedirects:5},tracking:{mapper:p},width:480,height:270}),vast:null,ready:!1,player:null,isVPAID:!1,vpaidVendor:null,video:o()};var r=this;this.on(c.AdClickThru,function(e,t,n){e=e||r.viewDetailLink;n&&e&&(this.__private__.player.alreadyEmitViewable||(this.__private__.player.alreadyEmitViewable=!0,this.__private__.player.emit(c.AdViewableImpression)),window.open(e));e=r.vast.get("ads[0].creatives[0].videoClicks.clickTrackings");e&&0<e.length&&e.map(function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.send(null)})}),this.on(c.AdClickBackground,function(){var e=r.__private__.player;e.video&&a.isDesktop&&(e.video.paused?n.resumeAd():n.pauseAd())})}b.prototype=Object.create(i.prototype),Object.defineProperties(b.prototype,{container:{get:function(){return this.__private__.container}},config:{get:function(){return this.__private__.config}},vast:{get:function(){return this.__private__.vast}},ready:{get:function(){return this.__private__.ready}},paused:{get:function(){return this.__private__.video.paused}},video:{set:function(e){return this.__private__.video=e}},isVPAID:{get:function(){return this.__private__.isVPAID}},isAsiaSmartAd:{get:function(){return(e=this.vast.ads[0]).vastAdTagURI&&v(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||v(e.system.name,"smart")||v(e.system.name,"wootag");var e}},vpaidVendor:{get:function(){return this.__private__.vpaidVendor}},viewDetailLink:{get:function(){return this.vast&&this.vast.get("ads[0].creatives[0].videoClicks.clickThrough")}},adRemainingTime:m("adRemainingTime"),adDuration:m("adDuration"),adVolume:m("adVolume")}),b.prototype.load=function(e){var s=this,t=this.config.vast;return("string"==typeof e?r.fetch(e,t):new r(e).resolveWrappers()).then(function(n){var e=function(){var e=n.filter("ads[0].creatives[0].mediaFiles",l.canPlayMediaFile),t=n.filter("ads[0].creatives[0].mediaFiles",u.canPlayMediaFile);if(0<t.length)return s.__private__.isVPAID=!1,s.__private__.vpaidVendor=null,{player:new u(s.container,s.__private__.video,s.config),mediaFiles:t};if(0<e.length)return s.__private__.isVPAID=!0,s.__private__.vpaidVendor=h.getVpaidVendor(e),{player:new l(s.container,s.__private__.video,s.config,s),mediaFiles:e};throw new Error("There are no playable <MediaFile>s.")}(),t=e.player,r=e.mediaFiles,i={adParameters:n.get("ads[0].creatives[0].parameters"),progressEvents:n.get("ads[0].creatives[0].trackingEvents").filter(function(e){return"progress"==e.event})},o=[].concat(n.map("ads[0].impressions",function(e){return{event:"impression",uri:e.uri}}),n.map("ads[0].viewableImpressions",function(e){return{event:"viewableImpression",uri:e.uri}}),n.map("ads[0].errors",function(e){return{event:"error",uri:e}}),n.get("ads[0].creatives[0].trackingEvents"),n.map("ads[0].creatives[0].videoClicks.clickTrackings",function(e){return{event:"clickThrough",uri:e}})),e=new d(c),a=new f(o,s.config.tracking.mapper);return e.from(t).to(s),s.__private__.vast=n,s.__private__.player=t,s.isAsiaSmartAd&&(t.adDuration=n.ads[0].creatives[0].duration),t.load(r,i).then(function(){a.track(t)})}).then(function(){return s.__private__.ready=!0,s.emit("ready"),s}).catch(function(e){throw s.emit("error",e),e})},b.prototype.startAd=g("startAd"),b.prototype.stopAd=g("stopAd"),b.prototype.skipAd=g("skipAd"),b.prototype.pauseAd=g("pauseAd"),b.prototype.resumeAd=g("resumeAd"),b.prototype.init=function(){var e=this.__private__.video,t=this.__private__.container;return e.init(t)},b.vpaidSWFLocation="https://ajax.cdnjs.com/ajax/libs/videojs-vast-vpaid/2.0.2/VPAIDFlash.swf",e.exports=b},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(22),r=n(23),a=n(24),s=n(13),l=n(25),u=Array.prototype.push,c=n(26),d={inline:function(e){a({description:null,survey:null},e)},wrapper:function(){}},f={linear:function(e){a({trackingEvents:[],parameters:null,videoClicks:null},e),(e.mediaFiles||[]).forEach(function(e){a({id:null,bitrate:null,scalable:null,maintainAspectRatio:null,apiFramework:null},e)})},companions:function(e){e.companions.forEach(function(e){a({expandedWidth:null,expandedHeight:null,apiFramework:null,trackingEvents:[],clickThrough:null,altText:null,parameters:null},e)})},nonLinear:function(e){a({trackingEvents:[]},e),e.ads.forEach(function(e){a({id:null,expandedWidth:null,expandedHeight:null,scalable:null,maintainAspectRatio:null,minSuggestedDuration:null,apiFramework:null,clickThrough:null,parameters:null},e)})}},h=["ads.celtra.com"];function p(){}function y(t,e){var n=t.indexOf("redirectUrl=");if(-1<n&&h.some(function(e){return-1<t.indexOf(e)})){var r=t.slice(n+"redirectUrl=".length);return t=t.slice(0,n),o.get(t,e).catch(p).then(function(){return o.get(r,e)})}return o.get(t,e)}function g(e){r(e,this,!0),this.ads.forEach(function(e){a({system:{version:null},errors:[]},e),e.creatives.forEach(function(e){a({id:null,sequence:null,adID:null},e),f[e.type](e)}),d[e.type](e)}),this.__private__={wrappers:[],inlines:[]}}Object.defineProperties(g.prototype,{wrappers:{get:function(){var e=this.__private__.wrappers;return e.length=0,u.apply(e,this.filter("ads",function(e){return"wrapper"===e.type})),e}},inlines:{get:function(){var e=this.__private__.inlines;return e.length=0,u.apply(e,this.filter("ads",function(e){return"inline"===e.type})),e}}}),g.prototype.get=function(e){return((e||"").match(/[^\[\]\.]+/g)||[]).reduce(function(e,t){return e?e[t]:void 0},this)},g.prototype.set=function(r,e){var t=function(){for(var e,t=/[^\[\]\.]+/g,n=[];e=t.exec(r);)n.push({token:e[0],type:function e(t,n){switch(t.input.charAt(n)){case".":return Object;case"[":return Array;case"]":return e(t,n+1);default:return null}}(e,e.index+e[0].length)});return n}(),n=t.pop(),t=t.reduce(function(e,t){return e[t.token]||(e[t.token]=new t.type)},this);if(!r)throw new Error("prop must be specified.");return t[n.token]=e},g.prototype.map=function(e,t){var n=this.get(e)||[],r=n.length,i=[];if(!(n instanceof Array))return i;for(var o=0;o<r;o++)i.push(t.call(this,n[o],o,n));return i},g.prototype.filter=function(e,t){var n=this.get(e)||[],r=n.length,i=[];if(!(n instanceof Array))return i;for(var o=0;o<r;o++)t.call(this,n[o],o,n)&&i.push(n[o]);return i},g.prototype.find=function(e,t){var n=this.get(e)||[],r=n.length;if(n instanceof Array)for(var i=0;i<r;i++)if(t.call(this,n[i],i,n))return n[i]},g.prototype.toPOJO=function(){var e=JSON.parse(JSON.stringify(this));return delete e.__private__,e},g.prototype.copy=function(){return new this.constructor(this.toPOJO())},g.prototype.resolveWrappers=function(){var t=isNaN(arguments[0])?1/0:arguments[0],e="function"==typeof arguments[0]?arguments[0]:arguments[1],n=this.constructor,o=this;return 0===t?Promise.reject(new Error("Too many redirects were made.")):l(Promise.all(this.map("wrappers",function(t){return Promise.resolve(y(t.vastAdTagURI,{withCredentials:!0})).then(function(e){return{wrapper:t,response:n.pojoFromXML(e.data).ads}})})).then(function(e){var r=e.map(function(e){return e.wrapper}),i=e.map(function(e){return e.response});return new n(s(o.toPOJO(),{ads:o.map("ads",function(e){var t=r.indexOf(e),n=r[t],t=i[t];return t?t.map(function(e,t){var n,r={linear:(n=e.creatives).filter(i("linear")),companions:n.filter(i("companions")),nonLinear:n.filter(i("nonLinear"))};function i(t){return function(e){return e.type===t}}return a(e.impressions,t.impressions),a(e.viewableImpressions,t.viewableImpressions),a(e.errors,t.errors),t.creatives.forEach(function(e){a(r[e.type].shift()||{},e)}),u.apply(t.creatives,"wrapper"!==t.type?[]:["linear","companions","nonLinear"].reduce(function(e,t){return e.concat(r[t])},[])),t}.bind(null,n)):[e]}).reduce(function(e,t){return e.concat(t)})}))}).then(function(e){return 0<e.get("wrappers.length")?e.resolveWrappers(t-1):e}),e)},g.prototype.toXML=function(){var e=this.validate();if(!e.valid)throw new Error("VAST is invalid: "+e.reasons.join(", "));return c(this)},g.prototype.validate=function(){var t=this,n=[],r={inline:function(r){var i={linear:function(e){s(e,{exists:["duration"],atLeastOne:["mediaFiles"]})},companions:function(n){t.get(n("companions")).forEach(function(e,t){s(function(e){return n("companions["+t+"]."+e)},{exists:[],atLeastOne:["resources"]})})},nonLinear:function(n){t.get(n("ads")).forEach(function(e,t){s(function(e){return n("ads["+t+"]."+e)},{exists:[],atLeastOne:["resources"]})})}};s(r,{exists:["title"],atLeastOne:["creatives"]}),t.get(r("creatives")).forEach(function(e,t){function n(e){return r("creatives["+t+"]."+e)}s(n,{exists:["type"],atLeastOne:[]}),(i[e.type]||p)(n)})},wrapper:function(e){s(e,{exists:["vastAdTagURI"],atLeastOne:[]})}};function i(e,t){e||n.push(t)}function o(e){i(t.get(e),e+" is required")}function a(e){i(0<t.get(e+".length"),e+" must contain at least one value")}function s(e,t){t.exists.map(e).forEach(o),t.atLeastOne.map(e).forEach(a)}return s(function(e){return e},{exists:[],atLeastOne:["ads"]}),this.get("ads").forEach(function(e,t){function n(e){return"ads["+t+"]."+e}s(n,{exists:["type","system.name"],atLeastOne:["impressions"]}),(r[e.type]||p)(n)}),{valid:0===n.length,reasons:0===n.length?null:n}},g.pojoFromXML=n(29),g.fetch=function(e){var t="object"===i(arguments[1])&&arguments[1]||{},n="function"==typeof arguments[2]?arguments[2]:arguments[1],r=this;return l(Promise.resolve(y(e,{headers:t.headers||{}})).then(function(e){e=new r(r.pojoFromXML(e.data));return t.resolveWrappers?e.resolveWrappers(t.maxRedirects):e}),n)},e.exports=g},function(e,t){e.exports={get:function(r){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e.withCredentials,o=e.headers;return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",r),n.withCredentials=Boolean(i),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e({data:n.responseText}):t(new Error("Unexpected status code:",n.status)))},o&&Object.keys(o).forEach(function(e){n.setRequestHeader(e,o[e])}),n.send()})}}},function(e,t,n){"use strict";function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=Array.prototype.push;e.exports=function n(e){var r,i,t,o,a="object"===l(arguments[1])?arguments[1]:null,s="boolean"==typeof arguments[1]?arguments[1]:arguments[2];return Object(e)!==e?e:e instanceof Array?(t=e,o=a||[],u.apply(o,s?t.map(function(e){return n(e,null,!0)}):t),o):(r=e,a=a,i=s,Object.keys(r).reduce(function(e,t){return e[t]=i?n(r[t],null,!0):r[t],e},a||{}))}},function(e,t,n){"use strict";var i=Array.prototype.push;function o(e){return Object(e)===e}function a(e){return e instanceof Array}e.exports=function n(r,t){return[r,t].every(a)?(i.apply(t,r.filter(function(e){return t.indexOf(e)<0})),t):Object.keys(r).reduce(function(e,t){return[r[t],e[t]].every(o)&&n(r[t],e[t]),t in e||(e[t]=r[t]),e},t)}},function(e,t,n){"use strict";e.exports=function(e,t){return"function"!=typeof t||e.then(function(e){t(null,e)},function(e){t(e)}),e}},function(e,t,n){"use strict";var r=n(27),i=n(28),o={linear:function(e){return{tag:"Linear",children:[{tag:"Duration",value:r(e.duration)},a(e.trackingEvents),l(e)].concat(e.videoClicks?[{tag:"VideoClicks",children:[{tag:"ClickThrough",value:e.videoClicks.clickThrough,cdata:!0}].concat(e.videoClicks.clickTrackings.map(function(e){return{tag:"ClickTracking",value:e,cdata:!0}}),e.videoClicks.customClicks.map(function(e){return{tag:"CustomClick",attributes:{id:e.id},value:e.uri,cdata:!0}}))}]:[],[{tag:"MediaFiles",children:e.mediaFiles.map(function(e){return{tag:"MediaFile",attributes:{id:e.id,width:e.width,height:e.height,bitrate:e.bitrate,type:e.type,delivery:e.delivery,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,apiFramework:e.apiFramework},value:e.uri,cdata:!0}})}])}},companions:function(e){return{tag:"CompanionAds",children:e.companions.map(function(e){return{tag:"Companion",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,apiFramework:e.apiFramework},children:s(e.resources).concat([a(e.trackingEvents),{tag:"CompanionClickThrough",value:e.clickThrough,cdata:!0},{tag:"AltText",value:e.altText},l(e)])}})}},nonLinear:function(e){return{tag:"NonLinearAds",children:e.ads.map(function(e){return{tag:"NonLinear",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,minSuggestedDuration:r(e.minSuggestedDuration),apiFramework:e.apiFramework},children:s(e.resources).concat([{tag:"NonLinearClickThrough",value:e.clickThrough,cdata:!0},l(e)])}}).concat([a(e.trackingEvents)])}}};function a(e){return{tag:"TrackingEvents",children:e.map(function(e){return{tag:"Tracking",attributes:{event:e.event},value:e.uri,cdata:!0}})}}function s(e){return e.map(function(e){return{tag:function(){switch(e.type){case"static":return"StaticResource";case"iframe":return"IFrameResource";case"html":return"HTMLResource"}}(),attributes:{creativeType:e.creativeType},value:e.data,cdata:!0}})}function l(e){return{tag:"AdParameters",value:e.parameters}}e.exports=function(e){return i({tag:"VAST",attributes:{version:e.get("version")},children:e.map("ads",function(e){return{tag:"Ad",attributes:{id:e.id},children:[{tag:function(){switch(e.type){case"inline":return"InLine";case"wrapper":return"Wrapper"}}(),children:[{tag:"AdSystem",attributes:{version:e.system.version},value:e.system.name},{tag:"AdTitle",value:e.title},{tag:"Description",value:e.description},{tag:"Survey",value:e.survey,cdata:!0},{tag:"VASTAdTagURI",value:e.vastAdTagURI,cdata:!0}].concat(e.errors.map(function(e){return{tag:"Error",value:e,cdata:!0}}),e.impressions.map(function(e){return{tag:"Impression",value:e.uri,cdata:!0,attributes:{id:e.id}}}),[{tag:"ViewableImpression",children:e.viewableImpressions.map(function(e){return{tag:"Viewable",value:e.uri,cdata:!0,attributes:{id:e.id}}})}],[{tag:"Creatives",children:e.creatives.map(function(e){return{tag:"Creative",attributes:{id:e.id,sequence:e.sequence,AdID:e.adID},children:[(t=e.type,o[t](e))]};var t}),required:!0}])}]}})},!0)}},function(e,t,n){"use strict";function r(e){return(9<e?"":"0")+e.toString()}e.exports=function(e){return Number(e)!==e?null:[Math.floor(e/60/60),Math.floor(e/60%60),Math.floor(e%60%60)].map(r).join(":")}},function(e,t,n){"use strict";function c(e){return null!=e}function d(e){return void 0!==e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}e.exports=function(e,t){return['<?xml version="1.0" encoding="UTF-8"?>'].concat(function n(e,r,i){var t=e.tag,o=e.attributes||{},a=Object.keys(o),s=e.children||[],l=e.value,u=0<s.length,s=a.every(function(e){return c(o[e])})&&0<a.length,a=c(l)||u||s,l=function(e){for(var t="";e--;)t+=" ";return t}(r),s="<"+t+Object.keys(o).reduce(function(e,t){return i&&!c(o[t])?e:e+" "+t+'="'+d(o[t])+'"'},"")+">",t="</"+t+">";return!i||a||e.required?u?[l+s].concat(e.children.reduce(function(e,t){return e.concat(n(t,r+4,i))},[]),[l+t]):[l+s+((s=e).cdata?(void 0!==(e=s.value)?function(e){for(var t,n,r=[],i=/]]>/g,o=0;t=i.exec(e);)n=t.index+2,r.push(t.input.substring(o,n)),o=n;return r.push(e.substring(o,e.length)),r}(String(e)):[""]).reduce(function(e,t){return e+"<![CDATA["+t+"]]>"},""):d(s.value))+t]:[]}(e,0,t)).join("\n")}},function(e,t,n){"use strict";var r=n(30),a=n(31),s=n(32),u=n(13),i=n(33),c=n(34),d={linear:function(e){var t=h(e.find("Duration")),n=h(e.find("Linear")),r=e.find("Tracking"),i=h(e.find("AdParameters")),o=e.find("VideoClicks")[0],e=e.find("MediaFile");return{type:"linear",skipOffset:n.attributes.skipoffset,duration:a(t.value)||void 0,trackingEvents:r.map(function(e){var t={event:e.attributes.event,uri:e.value};return"progress"===e.attributes.event&&(t.offset=a(e.attributes.offset)),t}),parameters:i.value,videoClicks:o&&(r=h(o.find("ClickThrough")),i=o.find("ClickTracking"),o=o.find("CustomClick"),{clickThrough:r.value,clickTrackings:i.map(function(e){return e.value}),customClicks:o.map(function(e){return{id:e.attributes.id,uri:e.value}})}),mediaFiles:e.map(function(e){var t=e.attributes;return{id:t.id,delivery:t.delivery,type:t.type,uri:e.value,bitrate:c(t.bitrate),width:c(t.width),height:c(t.height),scalable:s(t.scalable),maintainAspectRatio:s(t.maintainAspectRatio),apiFramework:t.apiFramework}})}},companions:function(e){return{type:"companions",companions:e.find("Companion").map(function(e){var t=e.find("Tracking"),n=h(e.find("CompanionClickThrough")),r=h(e.find("StaticResource")),i=h(e.find("AltText")),o=h(e.find("AdParameters"));return{id:e.attributes.id,width:c(e.attributes.width),height:c(e.attributes.height),expandedWidth:c(e.attributes.expandedWidth),expandedHeight:c(e.attributes.expandedHeight),apiFramework:e.attributes.apiFramework,resources:e.find("URL").map(function(e){return{data:e.value}}),staticResource:r.value,trackingEvents:t.map(function(e){return{event:e.attributes.event,uri:e.value}}),clickThrough:n.value,altText:i.value,parameters:o.value}})}},nonLinear:function(e){var t=e.find("NonLinear"),e=e.find("Tracking");return{type:"nonLinear",ads:t.map(function(e){var t=h(e.find("NonLinearClickThrough")),n=h(e.find("StaticResource")),r=h(e.find("AdParameters"));return{id:e.attributes.id,width:e.attributes.width,height:e.attributes.height,expandedWidth:c(e.attributes.expandedWidth),expandedHeight:c(e.attributes.expandedHeight),scalable:s(e.attributes.scalable),maintainAspectRatio:s(e.attributes.maintainAspectRatio),minSuggestedDuration:a(e.attributes.minSuggestedDuration)||void 0,apiFramework:e.attributes.apiFramework,resources:n.value,clickThrough:t.value,parameters:r.value}}),trackingEvents:e.map(function(e){return{event:e.attributes.event,uri:e.value}})}}},f={inline:function(e){var t=h(e.find("AdTitle")),n=h(e.find("Description")),e=h(e.find("Survey"));return{type:"inline",title:t.value,description:n.value,survey:e.value}},wrapper:function(e){return{type:"wrapper",vastAdTagURI:h(e.find("VASTAdTagURI")).value}}};function h(e){return e[0]||{attributes:{}}}e.exports=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"VAST",n=r(e);if(!n(t)[0])throw new Error("["+e+"] is not a valid VAST document.");return i({version:h(n(t)).attributes.version,ads:n("Ad").map(function(e){var t=h(e.find("Wrapper,InLine")).tag.toLowerCase(),n=h(e.find("AdSystem")),r=h(e.find("AdTitle")),i=h(e.find("Description")),o=e.find("Error"),a=e.find("Impression"),s=e.find("ViewableImpression Viewable"),l=e.find("Creative").filter(function(e){return e.children().length});return u({id:e.attributes.id,system:{name:n.value,version:n.attributes.version},advertiser:{title:r.value,description:i.value},errors:o.map(function(e){return e.value}),impressions:a.map(function(e){return{uri:e.value,id:e.attributes.id}}),viewableImpressions:s.map(function(e){return{uri:e.value,id:e.attributes.id}}),creatives:l.map(function(e){var t=function(){switch(h(e.find("Linear,CompanionAds,NonLinearAds")).tag){case"Linear":return"linear";case"CompanionAds":return"companions";case"NonLinearAds":return"nonLinear"}}();return u({id:e.attributes.id,sequence:c(e.attributes.sequence),adID:e.attributes.AdID},d[t](e))})},f[t](e))})},!0)}},function(e,t,n){"use strict";var r=Array.prototype.map,i=Array.prototype.filter,o=Array.prototype.reduce,a=new DOMParser;function s(t){var e=0<t.childElementCount;return{tag:t.tagName,value:e?null:t.textContent,attributes:o.call(t.attributes,function(e,t){return e[t.name]=t.value,e},{}),find:function(e){return l(t.querySelectorAll(e))},children:function(){return i.call(t.childNodes,function(e){return e instanceof Element}).map(s)}}}function l(e){return r.call(e,s)}e.exports=function(e){var t=a.parseFromString(e,"application/xml");return function(e){return l(t.querySelectorAll(e))}}},function(e,t,n){"use strict";e.exports=function(e){e=(e||"").match(/^(\d\d):(\d\d):(\d\d)$/);return e&&e.slice(1,4).map(parseFloat).reduce(function(e,t,n){return e+t*Math.pow(60,Math.abs(n-2))},0)}},function(e,t,n){"use strict";e.exports=function(e){switch((e||"").toLowerCase()){case"true":return!0;case"false":return!1}}},function(e,t,n){"use strict";e.exports=function n(r,i){return Object(r)!==r?r:Object.keys(r).reduce(function(e,t){return i&&r[t]instanceof Array?e[t]=r[t].filter(function(e){return void 0!==e}).map(function(e){return n(e,!0)}):i&&r[t]instanceof Object?e[t]=n(r[t],!0):void 0!==r[t]&&(e[t]=r[t]),e},{})}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){if(/string|number|boolean/.test(r(e)))return isNaN(e)?void 0:Number(e)}},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,n,r){return(s="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,r){var i,e=u(e,t);if(e){if((i=Object.getOwnPropertyDescriptor(e,t)).set)return i.set.call(r,n),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(r,t)){if(!i.writable)return!1;i.value=n,Object.defineProperty(r,t,i)}else n=n,(t=t)in(r=r)?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n;return!0})(e,t,n,r)}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=u(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=n(36),p=n(4),f=n(14),y=n(8),g=n(9).isDesktop,m=n(38),v=n(15),b=n(10);function _(e,t,n){return e.addEventListener(t,n,!1)}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)})(h,d),i(h,[{key:"adVolume",get:function(){return l(c(h.prototype),"adVolume",this)},set:function(n){(function(e,t){if(!s(e,"adVolume",n,t||e))throw new Error("failed to set property")})(c(h.prototype),this),this.video.muted=0===n}}],[{key:"canPlayMediaFile",value:function(e){return(e.type===f.JAVASCRIPT||"application/x-javascript"===e.type)&&"VPAID"===e.apiFramework}}]),i(h,[{key:"load",value:function(e,c){var d=this,f=e[0].uri,h=e[0].bitrate;return new Promise(function(r,i){var t,n,o,a=document.createElement("iframe"),e=document.createElement("script"),s=d.video,l=null;function u(e){d.container.removeChild(a),d.adVolume=0,d.video.clean&&d.video.clean(),d.video=null,d.frame=null,d.api=null,e&&i(e)}a.src="about:blank",a.setAttribute("scrolling","no"),a.style.width="100%",a.style.height="100%",a.style.display="block",a.style.opacity="0",a.style.border="none",d.container.appendChild(a),a.contentWindow.document.open(),a.contentWindow.document.close(),a.contentWindow.document.body.style.margin="0",d.frame=a,e.src=f,e.onload=function(){var e=a.contentWindow.getVPAIDAd(),t=a.contentWindow.document.body,n=d.vpaidVersion=new m(e.handshakeVersion("2.0"));if(2<n.major)return i(new Error("VPAID version "+n+" is not supported."));a.contentWindow.addEventListener("resize",function(){var e=a.getBoundingClientRect();d.resizeAd(e.width,e.height,"normal")},!1),p.forEach(function(n){if(d.parent.isAsiaSmartAd||n!==p.AdStarted)return e.subscribe(function(){for(var e=new Array(arguments.length),t=arguments.length;t--;)e[t]=arguments[t];return d.emit.apply(d,[n].concat(e))},n)}),d.once(p.AdLoaded,function(){a.style.opacity="1",d.api=e,r(d)}),d.once(p.AdError,function(e){u(new Error(e))}),d.once(p.AdStopped,u),d.parent.isAsiaSmartAd&&(d.once(p.AdStopped,function(e){d.emit(p.AdSkipped)}),d.once(p.AdVideoStart,function(e){var t=a.contentWindow.document.querySelector(".sas-container").querySelector("iframe").contentWindow.document.querySelector("video");d.video=t,d.parent.video=t})),e.initAd(d.config.width,d.config.height,"normal",h,{AdParameters:c.adParameters},{slot:t,videoSlot:s,videoSlotCanAutoPlay:g})},e.onerror=function(){u(new Error("Failed to load MediaFile ["+f+"]."))},t=s,n=y.PLAYING,o=function(){d.emit(p.AdStarted)},_(t,n,function e(){return t.removeEventListener(n,e,!1),o.apply(this,arguments)}),_(s,y.TIMEUPDATE,function(){var e;!((e=d.container.getBoundingClientRect()).top||e.height/2<=window.innerHeight-e.top&&e.bottom>=e.height/2)||d.alreadyEmitViewable?l=null:(l=l||s.currentTime,2<=s.currentTime-l&&(d.alreadyEmitViewable=!0,d.emit(p.AdViewableImpression)))}),_(s,y.LOADEDMETADATA,function(){var e=new v(s,c.progressEvents);new b([p.AdVideoProgress]).from(e).to(d)}),a.contentWindow.document.body.appendChild(s),a.contentWindow.document.body.appendChild(e)})}}]),d=h;function h(e,t,n,r){var i;return function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this),i=this,(e=!(e=c(h).call(this,e))||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i):e).frame=null,e.video=t,e.config=n,e.parent=r,e}e.exports=d},function(e,t,n){"use strict";var r=n(6),i=n(4);function o(t,a){return function(){var e=arguments,n=this.api,r=this;function i(){return new Error("Ad has not been loaded.")}function o(){return n[t].apply(n,e)}if(a)return new Promise(function(e,t){return n?(r.once(a,function(){e(r)}),o()):t(i())});if(!n)throw i();return o()}}function a(e){r.call(this),this.container=e,this.api=null,this.vpaidVersion=null}a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{adLinear:{get:o("getAdLinear")},adWidth:{get:o("getAdWidth")},adHeight:{get:o("getAdHeight")},adExpanded:{get:o("getAdExpanded")},adSkippableState:{get:o("getAdSkippableState")},adRemainingTime:{get:o("getAdRemainingTime")},adDuration:{get:o("getAdDuration"),set:function(e){}},adVolume:{get:o("getAdVolume"),set:o("setAdVolume")},adCompanions:{get:o("getAdCompanions")},adIcons:{get:o("getAdIcons")}}),a.prototype.load=function(){throw new Error("VPAID subclass must implement load() method.")},a.prototype.resizeAd=o("resizeAd",i.AdSizeChange),a.prototype.startAd=o("startAd",i.AdStarted),a.prototype.stopAd=o("stopAd",i.AdStopped),a.prototype.pauseAd=o("pauseAd",i.AdPaused),a.prototype.resumeAd=o("resumeAd",i.AdPlaying),a.prototype.expandAd=o("expandAd",i.AdExpandedChange),a.prototype.collapseAd=o("collapseAd",i.AdExpandedChange),a.prototype.skipAd=function(){o("skipAd",i.AdSkipped).call(this),this.stopAd()},e.exports=a},function(e,t){e.exports=window},function(e,t,n){"use strict";function r(e){var t=e.split(".").map(parseFloat);this.string=e,this.major=t[0],this.minor=t[1],this.patch=t[2],Object.freeze(this)}r.prototype.toString=function(){return this.string},e.exports=r},function(e,t,n){"use strict";var r=n(6),a=n(4);function s(e,t,n){e!==a.AdVideoProgress?t.fired[e]||(t.emit(e),t.fired[e]=!0):t.emit(e,n)}function i(e,t){r.apply(this,arguments),this.duration=e,this.progressEvents=t.sort(function(e,t){return e.offset<t.offset}),this.seconds=Array.apply([],new Array(e)).map(function(){return!1}),this.fired=[a.AdVideoStart,a.AdVideoFirstQuartile,a.AdVideoMidpoint,a.AdVideoThirdQuartile,a.AdVideoComplete].reduce(function(e,t){return e[t]=!1,e},{})}(i.prototype=Object.create(r.prototype)).tick=function(){var t=this,n=this.seconds,e=this._getState(),r=Math.round(e.currentTime)-1,i=[1,2,3,4].map(function(e){return Math.floor(this.duration/4*e)},this);function o(e){e=i[e-1];return e&&0!=e&&n.slice(0,e).every(function(e){return!0===e})}e.playing&&(s(a.AdVideoStart,this),-1<r&&(this.seconds[r]=!0)),o(1)&&s(a.AdVideoFirstQuartile,this),o(2)&&s(a.AdVideoMidpoint,this),o(3)&&s(a.AdVideoThirdQuartile,this),o(4)&&s(a.AdVideoComplete,this),this.progressEvents.length&&this._popMatchProgressEvents(e.currentTime).forEach(function(e){return s(a.AdVideoProgress,t,e)})},i.prototype._popMatchProgressEvents=function(e){for(var t=this.progressEvents,n=t.length-1;-1<n&&e>t[n].offset;)--n;return t.splice(n+1)},i.prototype._getState=function(){throw Error("this method must be overridden")},e.exports=i},function(e,t,n){"use strict";var r=n(6),c=n(9).canPlay,d=n(41),f=n(4),h=n(8),p=n(15),y=n(10);function g(e,t,n){return e.addEventListener(t,n,!1)}function m(t,n,r){return g(t,n,function e(){return t.removeEventListener(n,e,!1),r.apply(this,arguments)})}function i(e,t){function n(){return new Error("The <video> has not been loaded.")}return function(){if(this.video)return e.apply(this,arguments);if(t)return Promise.reject(n());throw n()}}function o(){return this.container.removeChild(this.video),this.video.clean(),this.video=null,this.alreadyEmitViewable=!1,Promise.resolve(this)}function a(e,t,n){r.call(this),this.container=e,this.video=t,this.config=n,this.__private__={hasPlayed:!1}}a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{adRemainingTime:{get:i(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:i(function(){return this.video.duration})},adVolume:{get:i(function(){return this.video.volume}),set:i(function(e){this.video.muted=0===e,this.video.volume=e})}}),a.prototype.load=function(s,l){var u=this;return new Promise(function(t,n){var r,e,i=u.video,o=(o=s,r={width:u.config.width,height:u.config.height}.width,o=(e=o.map(function(e){return{mediaFile:e,playability:"video/3gpp"!==e.type&&c(e.type)}}).filter(function(e){return 0<e.playability}).sort(d("-playability","-mediaFile.bitrate"))).map(function(e){return Math.abs(r-e.mediaFile.width)}),!(o=e[o.indexOf(Math.min.apply(Math,o))])||o.playability<1?null:o.mediaFile),a=null;if(!o)return n(new Error("There are no playable <MediaFile>s."));i.src=o.uri,m(i,h.LOADEDMETADATA,function(){var e=new p(i,l.progressEvents);new y(f).from(e).to(u),t(u),u.emit(f.AdLoaded),g(i,h.DURATIONCHANGE,function(){u.emit(f.AdDurationChange)}),g(i,h.VOLUMECHANGE,function(){u.emit(f.AdVolumeChange)})}),m(i,h.ERROR,function(){var e=i.error;u.emit(f.AdError,e.message),n(e)}),m(i,h.PLAYING,function(){u.__private__.hasPlayed=!0,u.emit(f.AdImpression)}),m(i,h.ENDED,function(){u.stopAd()}),g(i,h.TIMEUPDATE,function(){var e;!((e=u.container.getBoundingClientRect()).top||e.height/2<=window.innerHeight-e.top&&e.bottom>=e.height/2)||u.alreadyEmitViewable?a=null:(a=a||i.currentTime,2<=i.currentTime-a&&(u.alreadyEmitViewable=!0,u.emit(f.AdViewableImpression)))}),g(i,"click",function(){u.emit(f.AdClickBackground,null,null,!0)}),u.container.appendChild(i)})},a.prototype.startAd=i(function(){var n=this,r=this.video;return this.__private__.hasPlayed?Promise.reject(new Error("The advertisement has already been started.")):new Promise(function(e,t){return m(r,h.PLAYING,function(){e(n),n.alreadyPlayAd=!0,n.emit(f.AdStarted)}),r.play().catch(t)})},!0),a.prototype.stopAd=i(function(){return this.emit(f.AdStopped),o.call(this)},!0),a.prototype.skipAd=i(function(){return this.emit(f.AdSkipped),o.call(this)},!0),a.prototype.pauseAd=i(function(){var t=this,n=this.video;return this.video.paused?Promise.resolve(this):new Promise(function(e){return m(n,h.PAUSE,function(){e(t),t.emit(f.AdPaused)}),n.pause()})},!0),a.prototype.resumeAd=i(function(){var t=this,n=this.video;return this.__private__.hasPlayed?this.video.paused?new Promise(function(e){return m(n,h.PLAY,function(){e(t),t.emit(f.AdPlaying)}),n.play()}):Promise.resolve(this):Promise.reject(new Error("The ad has not been started yet."))},!0),a.canPlayMediaFile=function(e){return Boolean(document.createElement("video").canPlayType(e.type))},e.exports=a},function(e,t,n){var a=n(42),r=function(t){return function(e){return typeof e===t}},s=function(r,e){var i=1,o=e||function(e,t){return t};return"-"===r[0]&&(i=-1,r=r.substr(1)),function(e,t){var n,e=o(r,a.get(e,r)),t=o(r,a.get(t,r));return e<t&&(n=-1),t<e&&(n=1),(n=e===t?0:n)*i}};e.exports=function(){var e=Array.prototype.slice.call(arguments),o=e.filter(r("string")),a=e.filter(r("function"))[0];return function(e,t){for(var n=o.length,r=0,i=0;0===r&&i<n;)r=s(o[i],a)(e,t),i++;return r}}},function(t,n,e){var r,i;!function(e){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e():(r=[],void 0===(i="function"==typeof(i=e)?i.apply(n,r):i)||(t.exports=i))}(function(){"use strict";var t=Object.prototype.toString,n=Object.prototype.hasOwnProperty;function o(e){if(!e)return 1;if(l(e)&&0===e.length)return 1;for(var t in e)if(n.call(e,t))return;return 1}function r(e){return t.call(e)}function a(e){return"number"==typeof e||"[object Number]"===r(e)}function s(e){return"string"==typeof e||"[object String]"===r(e)}function l(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===r(e)}function u(e){var t=parseInt(e);return t.toString()===e?t:e}function c(e,t,n,r){if(o(t=a(t)?[t]:t))return e;if(s(t))return c(e,t.split("."),n,r);var i=u(t[0]);if(1!==t.length)return void 0===e[i]&&(a(i)?e[i]=[]:e[i]={}),c(e[i],t.slice(1),n,r);t=e[i];return void 0!==t&&r||(e[i]=n),t}var d={ensureExists:function(e,t,n){return c(e,t,n,!0)},set:c,insert:function(e,t,n,r){var i=d.get(e,t);r=~~r,l(i)||d.set(e,t,i=[]),i.splice(r,0,n)},empty:function(e,t){return o(t)?e:o(e)?void 0:(n=d.get(e,t))?s(n)?d.set(e,t,""):"[object Boolean]"===r(n)?d.set(e,t,!1):a(n)?d.set(e,t,0):l(n)?void(n.length=0):d.set(e,t,null):e;var n},push:function(e,t){var n=d.get(e,t);l(n)||d.set(e,t,n=[]),n.push.apply(n,Array.prototype.slice.call(arguments,2))},coalesce:function(e,t,n){for(var r,i=0,o=t.length;i<o;i++)if(void 0!==(r=d.get(e,t[i])))return r;return n},get:function(e,t,n){if(o(t=a(t)?[t]:t))return e;if(o(e))return n;if(s(t))return d.get(e,t.split("."),n);var r=u(t[0]);return 1===t.length?void 0===e[r]?n:e[r]:d.get(e[r],t.slice(1),n)},del:function e(t,n){if(a(n)&&(n=[n]),!o(t)){if(o(n))return t;if(s(n))return e(t,n.split("."));var r=u(n[0]),i=t[r];if(1===n.length)void 0!==i&&(l(t)?t.splice(r,1):delete t[r]);else if(void 0!==t[r])return e(t[r],n.slice(1));return t}}};return d})},function(e,t,n){"use strict";var r=n(4);function a(e){return e}function s(e,t){(e||[]).forEach(function(e){(new Image).src=t(e)})}function i(e,t){this.pixels=e.reduce(function(e,t){return t&&(e[t.event]||(e[t.event]=[])).push(t.uri),e},{}),this.__private__={mapper:t||a}}i.prototype.track=function(e){var i=this.pixels,o=this.__private__.mapper,t=e.adVolume;function n(e,t,n){function r(e){return o((t||a)(e))}return function(){n&&!n()||s(i[e],r)}}e.on(r.AdSkipped,n("skip")),e.on(r.AdStarted,n("creativeView")),e.on(r.AdVolumeChange,n("unmute",null,function(){return 0===t&&0<e.adVolume})),e.on(r.AdVolumeChange,n("mute",null,function(){return 0<t&&0===e.adVolume})),e.on(r.AdImpression,n("impression")),e.on(r.AdViewableImpression,function(){n("viewableImpression"),n("impression")}),e.on(r.AdVideoStart,n("start")),e.on(r.AdVideoFirstQuartile,n("firstQuartile")),e.on(r.AdVideoMidpoint,n("midpoint")),e.on(r.AdVideoThirdQuartile,n("thirdQuartile")),e.on(r.AdVideoProgress,function(e){s([e.uri],o||a)}),e.on(r.AdVideoComplete,n("complete")),e.on(r.AdUserAcceptInvitation,n("acceptInvitationLinear")),e.on(r.AdUserMinimize,n("collapse")),e.on(r.AdUserClose,n("closeLinear")),e.on(r.AdPaused,n("pause")),e.on(r.AdResumed,n("resume")),e.on(r.AdPlaying,n("resume")),e.on(r.AdError,n("error",function(e){return e.replace(/\[ERRORCODE\]/g,901)})),e.on(r.AdVolumeChange,function(){t=e.adVolume})},e.exports=i},function(e,t){e.exports=function(){var r=document.createElement("video"),i=[],t=!1,o=r.addEventListener,a=r.removeEventListener,e=r.play,n=Array.prototype.map.call(r.attributes,function(e){return e.name});return r.init=function(e){return t?Promise.resolve():(t=!0,r.parentNode||e.appendChild(r),Promise.resolve().then(function(){return r.load()}).catch(function(e){return console.log("Error while initializing video",e)}))},r.clean=function(){i.forEach(function(e){a.call(r,e.type,e.listener,e.options)}),i=[],r.load(),s()},r.addEventListener=function(e,t,n){return i.push({type:e,listener:t,options:n}),o.call(r,e,t,n)},r.removeEventListener=function(e,t,n){return a.call(r,e,t,n)},r.play=function(){return t=!0,e.call(r)},s(),r;function s(){Array.prototype.forEach.call(r.attributes,function(e){-1===n.indexOf(e.name)&&r.removeAttribute(e.name)}),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),r.setAttribute("preload","auto"),r.style.display="block",r.style.width="100%",r.style.height="100%",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.backgroundColor="#000",r.style.objectFit="contain"}}},function(e,t){e.exports={getVpaidVendor:function(e){return/moatads\.com/.test(e[0].uri)?"MOAT":null}}},function(e,t,n){e.exports=n(47)},function(e,t,n){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var u=n(48),c=n(50),d=n(11),f=n(3),h=f.isImaAd,p=f.createPromiseDefer,y=n(51),g=n(5).DEFAULT_MAX_VOLUME;function m(e,t,n,r){var i,o;return function(e){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this),o=this,r=s(m).call(this,e,t,n,r),(i=!r||"object"!==a(r)&&"function"!=typeof r?l(o):r)._onAdsManagerLoaded=i._onAdsManagerLoaded.bind(l(l(i))),i._onAdEvent=i._onAdEvent.bind(l(l(i))),i._onAdErrorEvent=i._onAdErrorEvent.bind(l(l(i))),i.adDisplayContainer=null,i.adsLoader=null,i.adsManager=null,i.adOption=null,i.currentAd=null,i.volume=i.videoContent.muted?0:i.videoContent.volume*g,i.paused=!1,i.destroyed=!1,i.loadDeferred=null,i.startAdRequested=!1,i.cancelledAdRequested=!1,i.initUserActionHappened=!1,u.load().then(function(){return i._init()}).catch(function(e){i.destroyed||i.logger.error(i.name,"cannot load SDK",e)}),i}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(m,d),i(m,[{key:"name",get:function(){return"GoogleImaPlayer"}},{key:"videoContentWidth",get:function(){return this.videoContent.offsetWidth}},{key:"videoContentHeight",get:function(){return this.videoContent.offsetHeight}},{key:"videoContentVolume",get:function(){return this.videoContent.muted?0:this.videoContent.volume}},{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!0}},{key:"isGoogleImaAd",get:function(){return!0}}]),i(m,[{key:"initUserAction",value:function(){!this.initUserActionHappened&&this.adDisplayContainer&&(this.initUserActionHappened=!0,this.adDisplayContainer.initialize(),this.adDisplayContainer.initialized=!0,this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){var n=this;this.adOption=t,this.tracker=new c(e),this.loadDeferred=p();var r=e.vastAdTagURI;return u.isReady().then(function(){return n._requestAds(r)}).then(function(){return n.loadDeferred.promise})}},{key:"canRun",value:function(e){return h(e)}},{key:"start",value:function(){return this.startAdRequested=!1,this.cancelledAdRequested=!1,this.paused=!1,this.destroyed?this._onAdStopped(new Error("cannot play ad since adsManager was destroyed")):this.adsManager?(this.initUserAction(),void this.adsManager.start()):(this.startAdRequested=!0,void this.logger.debug(this.name,"cannot play ad since adsManager is not loaded yet, try to play on load event"))}},{key:"stop",value:function(){this.adsManager&&this.adsManager.stop()}},{key:"skip",value:function(){this.stop()}},{key:"pause",value:function(){this.adsManager&&this.adsManager.pause()}},{key:"resume",value:function(){this.adsManager&&this.adsManager.resume()}},{key:"cancel",value:function(){this.adsManager?this.adsManager.stop():this.cancelledAdRequested=!0}},{key:"setVolume",value:function(e){this.logger.debug(this.name,"setVolume | volume ",e),this.volume=e,this.adsManager&&this.adsManager.setVolume(e)}},{key:"getVolume",value:function(){return this.volume}},{key:"isPaused",value:function(){return this.paused}},{key:"getRemainingTime",value:function(){return this.adsManager.getRemainingTime()}},{key:"getDuration",value:function(){return this.currentAd?this.currentAd.getDuration():0}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.currentAd&&this.currentAd.getSkipTimeOffset()),this.adOption?this.adOption.skipoffset:-1}},{key:"resize",value:function(){this.adsManager&&this.adsManager.resize(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL)}},{key:"destroy",value:function(){this.destroyed=!0,this._destroyAdsManager(),this._destroyAdDisplayContainer(),this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){this.destroyed||(this.element=document.createElement("div"),this.element.style.width="100%",this.element.style.height="100%",this.element.style.position="absolute",this.element.style.zIndex=1,this.element.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.element.setAttribute("data-player",this.name),this.adContainerElement.appendChild(this.element),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setDisableFlashAds(!0),this.adDisplayContainer=new google.ima.AdDisplayContainer(this.element,this.videoContent),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.getSettings().setPlayerType("zplayer-ima"),this.adsLoader.getSettings().setPlayerVersion(y.version),this.adsLoader.getSettings().setAutoPlayAdBreaks(this.options.autoPlayAdBreaks),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1),this._hide())}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_requestAds",value:function(e){this.logger.debug(this.name,"_requestAds | adTagUrl",e);var t=new google.ima.AdsRequest;t.adTagUrl=e,t.linearAdSlotWidth=this.videoContentWidth,t.linearAdSlotHeight=this.videoContentHeight,t.nonLinearAdSlotWidth=this.videoContentWidth,t.nonLinearAdSlotHeight=this.videoContentHeight,t.forceNonLinearFullSlot=!0,t.setAdWillAutoPlay(this.options.autoPlay),t.setAdWillPlayMuted(this.options.mute),this.adsLoader.requestAds(t)}},{key:"_onAdsManagerLoaded",value:function(e){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.adsManager=e.getAdsManager(this.videoContent,t),this.setVolume(this.volume),this.adsManager.init(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL),this._startAdsManager(this.adsManager)}},{key:"_startAdsManager",value:function(e){e.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1,this);var t,n=[google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.ALL_ADS_COMPLETED];for(t in n)e.addEventListener(n[t],this._onAdEvent,!1,this);this.cancelledAdRequested?this.cancel():this.startAdRequested&&this.start()}},{key:"_onAdEvent",value:function(e){var t=this;this.logger.debug(this.name,"Ad event:",e.type),this.tracker.onAdEvent(e);var n,r=e.getAd();switch(e.type){case google.ima.AdEvent.Type.LOADED:this.onAdLoaded(),this.loadDeferred.resolve(),this.loadDeferred=null,r.isLinear()||(this.element.style.backgroundColor="transparent");break;case google.ima.AdEvent.Type.STARTED:this.currentAd=r,this._onAdStarted(),r.isLinear()||(n=-1===r.g.duration?15:r.g.duration,setTimeout(function(){t.adsManager&&t.adsManager.stop(),t._onAdStopped()},1e3*n));break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this._onAdStopped();break;case google.ima.AdEvent.Type.PAUSED:this._onAdPausedEvent();break;case google.ima.AdEvent.Type.RESUMED:this._onAdResumedEvent()}}},{key:"_onAdErrorEvent",value:function(e){e=e.getError();this.loadDeferred?this.loadDeferred.reject(e):(this.logger.error(this.name,"Ad error:",e.toString()),this._onAdStopped(e))}},{key:"_onAdPausedEvent",value:function(){this.paused=!0}},{key:"_onAdResumedEvent",value:function(){this.paused=!1}},{key:"_onAdStarted",value:function(){this._show(),this.onAdStarted()}},{key:"_onAdStopped",value:function(e){this._hide(),this._destroyAdsManager(),this.onAdStopped(e)}},{key:"_destroyAdsManager",value:function(){this.adsManager&&(this.adsManager.destroy(),this.adsManager=null)}},{key:"_destroyAdDisplayContainer",value:function(){this.adDisplayContainer&&(this.adDisplayContainer.destroy(),this.adDisplayContainer=null)}}]),m)},function(e,t,n){var r,i=n(49);e.exports={load:function(){return r=r||new Promise(function(t,n){i(function(e){e?t():n(new Error("failed to load IMA SDK"))},!0,6e3)})},isReady:function(){return r}}},function(e,t){e.exports=function(t,e,n){function r(e){o.clearTimeout(s),"function"==typeof t&&t(e)}var i,o=window,a=document,s=null;o.google&&o.google.ima?r(!0):(i=!0===e?"https:":"",e=a.getElementsByTagName("script")[0],(a=a.createElement("script")).src=i+"//imasdk.googleapis.com/js/sdkloader/ima3.js",a.async=!0,"function"==typeof t&&(a.onload=function(){r(!0)}),e.parentNode.insertBefore(a,e),n&&(s=o.setTimeout(function(){r(!1)},n)))}},function(e,t){function n(e){!function(e){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.impressionEvents=[].concat(e.impressions||[],e.viewableImpressions||[]),this.trackingEvents=e.creatives[0].trackingEvents,e.creatives[0].videoClicks&&(this.clickTrackingUri=e.creatives[0].videoClicks.clickTrackings[0])}e.exports=(function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,[{key:"onAdEvent",value:function(e){var t=this;switch(e.type){case google.ima.AdEvent.Type.IMPRESSION:this.impressionEvents.forEach(function(e){return t._fireEvent(e.uri)});break;case google.ima.AdEvent.Type.STARTED:this._trackEvent("start"),this._trackEvent("creativeView");break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this._trackEvent("firstQuartile");break;case google.ima.AdEvent.Type.MIDPOINT:this._trackEvent("midpoint");break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this._trackEvent("thirdQuartile");break;case google.ima.AdEvent.Type.COMPLETE:this._trackEvent("complete");break;case google.ima.AdEvent.Type.PAUSED:this._trackEvent("pause");break;case google.ima.AdEvent.Type.RESUMED:this._trackEvent("resume");break;case google.ima.AdEvent.Type.SKIPPED:this._trackEvent("skip");break;case google.ima.AdEvent.Type.USER_CLOSE:this._trackEvent("close");break;case google.ima.AdEvent.Type.CLICK:this.clickTrackingUri&&this._fireEvent(this.clickTrackingUri)}}},{key:"_trackEvent",value:function(t){var n=this;this.trackingEvents.filter(function(e){return e.event===t}).forEach(function(e){return n._fireEvent(e.uri)})}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),n)},function(e){e.exports={name:"@zplayer/ad-runner",version:"1.0.25",description:"Generic ad runner library for media player",main:"dist/ad-runner.min.js",author:"ZTE folks",publishConfig:{registry:"https://nexus-repo.zapps.vn/repository/zjs-repo/"},scripts:{dev:"webpack-dev-server --progress --mode development --config webpack.config.js",watch:"webpack --progress --watch --mode development --output-filename=[name].min.js --config webpack.config.js",build:"webpack -p --progress --mode production --config webpack.config.js","build-demo":"webpack --progress --mode development --config webpack.config.js",lint:"eslint *.js src/"},devDependencies:{"@zjs/vast-player":"1.3.62","@babel/core":"^7.1.2","@babel/preset-env":"^7.1.0","babel-loader":"^8.0.4","clean-webpack-plugin":"0.1.19","css-loader":"1.0.0",eslint:"^5.4.0","eslint-plugin-import":"^2.15.0","generate-changelog":"^1.7.1","html-webpack-plugin":"3.2.0","node-sass":"4.13.0","sass-loader":"7.1.0","style-loader":"0.23.0",webpack:"4.17.2","webpack-cli":"3.1.0","webpack-dev-server":"3.1.8","webpack-merge":"4.1.4"}}},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var u=n(7).VastPlayer,c=n(11),d=n(3),f=d.isImaAd,h=d.isFacebookAd,p=d.isAsiaSmartAd,y=n(5).AD_DONE_REASON;function g(e,t,n,r){var i;return function(e){if(!(e instanceof g))throw new TypeError("Cannot call a class as a function")}(this),i=this,(r=!(r=a(g).call(this,e,t,n,r))||"object"!==o(r)&&"function"!=typeof r?l(i):r).adOption=null,r.loadPromise=null,r.initUserActionHappened=!1,r.onAdSkipped=n.onAdSkipped,r._onAdError=r._onAdError.bind(l(l(r))),r._init(),r}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(g,c),i(g,[{key:"name",get:function(){return"VastLinearPlayer"}},{key:"canClickThrough",get:function(){return this.player.isVPAID&&"MOAT"!==this.player.vpaidVendor}},{key:"isFacebookAd",get:function(){return h(this.ad)}},{key:"isAsiaSmartAd",get:function(){return p(this.ad)}},{key:"viewDetailLink",get:function(){return this.player&&this.player.viewDetailLink}}]),i(g,[{key:"canRun",value:function(e){return!f(e)&&"linear"===e.creatives[0].type}},{key:"initUserAction",value:function(){this.initUserActionHappened||(this.initUserActionHappened=!0,this.player.init(),this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){return this.ad=e,this.adOption=t,this.loadPromise=this.player.load({ads:[e]}),this.loadPromise}},{key:"start",value:function(){var e=this;this.loadPromise.then(function(){return e.player.startAd()}).catch(this._onAdError)}},{key:"stop",value:function(){var e=this;this.loadPromise.then(function(){return e.player.stopAd()}).catch(this._onAdError)}},{key:"skip",value:function(){var e=this;this.loadPromise.then(function(){return e.player.skipAd()}).catch(this._onAdError)}},{key:"pause",value:function(){var e=this;return this.loadPromise.then(function(){return e.player.pauseAd()}).catch(this._onAdError)}},{key:"resume",value:function(){var e=this;return this.loadPromise.then(function(){return e.player.resumeAd()}).catch(this._onAdError)}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){var t=this;this.loadPromise.then(function(){if(t.player.isVPAID)try{t.player.__private__.video.click(),t.resume()}catch(e){t.logger.error(t.name,"error while simulate click on VPAID ad",e)}else t.player.emit("AdClickThru",null,null,!0)}).catch(this._onAdError)}},{key:"setVolume",value:function(e){var t=this;this.loadPromise.then(function(){t.player.adVolume=e})}},{key:"getVolume",value:function(){return this.loadPromise?this.player.adVolume:0}},{key:"isPaused",value:function(){return this.player.paused}},{key:"getRemainingTime",value:function(){if(this.isAsiaSmartAd){var e=this.getDuration();return 0<e?e-this.getAdCurrentTime():e}return this.player&&this.player.adRemainingTime}},{key:"getDuration",value:function(){return this.player&&this.player.adDuration}},{key:"getAdCurrentTime",value:function(){return Math.floor(this.player.__private__.video.currentTime)}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.adOption.skipoffset),this.adOption?this.adOption.skipoffset:-1}},{key:"destroy",value:function(){this.loadPromise&&this.ad&&this.stop(),this.player=null,this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){var e=this,t=document.createElement("div"),n=new u(t,{width:e.videoContent.offsetWidth,height:e.videoContent.offsetHeight});t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.zIndex=1,t.setAttribute("data-player",this.name),n.on("AdStarted",function(){return e._onAdStartedEvent()}),n.on("AdStopped",function(){return e._onAdStoppedEvent()}),n.on("AdSkipped",function(){return e._onAdSkippedEvent()}),n.on("AdLoaded",function(){return e._onAdLoadedEvent()}),e.adContainerElement.appendChild(t),e.element=t,e.player=n,e._hide()}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_onAdLoadedEvent",value:function(){this.onAdLoaded()}},{key:"_onAdStartedEvent",value:function(){if(this._show(),this.onAdStarted(),this.isFacebookAd)try{this.player.__private__.player.frame.contentDocument.querySelector("#an_skip_button").style.display="none"}catch(e){this.logger.warn(this.name,"failed to remove FB skip button",e)}}},{key:"_onAdStoppedEvent",value:function(e,t){this.loadPromise=null,this._hide(),this.onAdStopped(e,t)}},{key:"_onAdSkippedEvent",value:function(){this.onAdSkipped(),this._onAdStoppedEvent(null,y.skipped)}},{key:"_onAdError",value:function(e){this._onAdStoppedEvent(e)}}]),g)},function(e,t,n){e.exports=n(54)},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(11),u=n(3).isImaAd,c=n(55),d=n(59),f=n(5).DEFAULT_NON_LINEAR_DURATION;function h(e,t,n,r){var i;return function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this),i=this,(r=!(r=a(h).call(this,e,t,n,r))||"object"!==o(r)&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i):r).ad=null,r.adOption=null,r.imgUrl=null,r.adTimer=null,r}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(h,l),i(h,[{key:"name",get:function(){return"VastNonLinearPlayer"}},{key:"selfControl",get:function(){return!0}},{key:"viewDetailLink",get:function(){return this.ad.creatives[0].ads[0].clickThrough}}]),i(h,[{key:"canRun",value:function(e){return!u(e)&&"nonLinear"===e.creatives[0].type}},{key:"initUserAction",value:function(){}},{key:"loadAd",value:function(e,t){this.ad=e,this.adOption=t,this.imgUrl=null;e=e.creatives[0].ads[0].resources;return e&&this._isValidImageAd(e)?(this.imgUrl=e,this.onAdLoaded(),Promise.resolve()):Promise.reject(new Error("no playable non-linear file"))}},{key:"start",value:function(){this.adTimer&&this.stop();var e=this.ad.creatives[0],t=parseInt(e.ads[0].width),e=parseInt(e.ads[0].height);return this.tracker=new d(this.ad),this.adUi=new c(this,this.videoContent.offsetWidth,this.videoContent.offsetHeight),this.adUi.setImage(this.imgUrl,t,e),this.adContainerElement.appendChild(this.adUi.element),this._onAdStartedEvent(),Promise.resolve()}},{key:"stop",value:function(){this._onAdStoppedEvent()}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){try{var e=this.viewDetailLink;e&&window.open(e,"_blank")}catch(e){this.logger.error(this.name,"error while showing detail of ad",e)}}},{key:"setVolume",value:function(){}},{key:"getRemainingTime",value:function(){}},{key:"getDuration",value:function(){}},{key:"destroy",value:function(){this._stopAdTimer(),this.adUi&&this.adUi.remove(),this.logger.debug(this.name,"destroyed")}},{key:"_isValidImageAd",value:function(e){return!/\.swf/.test(e)}},{key:"_startAdTimer",value:function(){var e=this;this.adTimer=setTimeout(function(){return e.stop()},1e3*(this.adOption.duration||f))}},{key:"_stopAdTimer",value:function(){clearTimeout(this.adTimer),delete this.adTimer}},{key:"_onAdStartedEvent",value:function(){this._startAdTimer(),this.adUi.show(),this.tracker.onAdStarted(),this.onAdStarted()}},{key:"_onAdStoppedEvent",value:function(){this._stopAdTimer(),this.adUi.remove(),this.tracker.onAdStopped(),this.onAdStopped(null,null,!0,this.adData)}}]),h)},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n(56);var l=n(2);function u(e,t,n){var r,i;return function(e){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this),r=this,(i=!(i=a(u).call(this,{className:"ad_runner_non_linear_ad_ui"}))||"object"!==o(i)&&"function"!=typeof i?s(r):i).player=e,i.maxWidth=t,i.maxHeight=n,i._onCloseButtonClickEvent=i._onCloseButtonClickEvent.bind(s(s(i))),i._onImageClickEvent=i._onImageClickEvent.bind(s(s(i))),i.render(),i._registerEvents(),i}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,l),function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(u.prototype,[{key:"render",value:function(){r(a(u.prototype),"render",this).call(this),this.closeButton=new l({tagName:"span"}),this.closeButton.render(),this.closeButton.html("[x]"),this.closeButton.attr("title","Đóng quảng cáo"),this.appendChild(this.closeButton),this.image=new l({tagName:"img"}),this.image.render(),this.appendChild(this.image)}},{key:"remove",value:function(){this._unregisterEvents(),r(a(u.prototype),"remove",this).call(this)}},{key:"setImage",value:function(e,t,n){(t>this.maxWidth||n>this.maxHeight)&&(this.image.attr("width","auto"),this.image.attr("height","auto"),n<t?this.image.style("max-width","".concat(this.maxWidth-40,"px")):this.image.style("max-height","".concat(this.maxHeight-40,"px"))),this.image.attr("src",e)}},{key:"_registerEvents",value:function(){this.closeButton.on("click",this._onCloseButtonClickEvent),this.image.on("click",this._onImageClickEvent)}},{key:"_unregisterEvents",value:function(){this.closeButton.off("click",this._onCloseButtonClickEvent),this.image.off("click",this._onImageClickEvent)}},{key:"_onCloseButtonClickEvent",value:function(e){e.stopPropagation(),this.player.stop()}},{key:"_onImageClickEvent",value:function(e){e.stopPropagation(),this.player.viewDetail()}}]),u)},function(e,t,n){var r=n(57);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_non_linear_ad_ui span{position:absolute;top:0;right:0;color:#f9754d;cursor:pointer;padding:2px;font-weight:bold;background-color:white}.ad_runner_non_linear_ad_ui img{cursor:pointer}\n",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var t=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(t)?e:(t=0===t.indexOf("//")?t:0===t.indexOf("/")?n+t:r+t.replace(/^\.\//,""),"url("+JSON.stringify(t)+")")})}},function(e,t){var n=["start","creativeView"],r=["close"];function i(e){!function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.impressionEvents=[].concat(e.impressions||[],e.viewableImpressions||[]),this.trackingEvents=e.creatives[0].trackingEvents}e.exports=(function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(i.prototype,[{key:"onAdStarted",value:function(){var t=this;this.impressionEvents.forEach(function(e){return t._fireEvent(e.uri)}),this._trackEvents(n)}},{key:"onAdStopped",value:function(){this._trackEvents(r)}},{key:"_trackEvents",value:function(t){var n=this;this.trackingEvents.filter(function(e){return-1<t.indexOf(e.event)}).forEach(function(e){return n._fireEvent(e.uri)})}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),i)},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=n(5),a=o.AD_POSITION,s=o.PRELOAD_DURATION,l=o.COUNT_DOWN_DURATION,u=n(3).createPromiseDefer;function c(e){return e.ads[0]&&"nonLinear"!==e.ads[0].creatives[0].type}function d(e){var t=e.prepareAd,n=e.beforePlayAd,r=e.preloadAd,i=e.loadAd,o=e.playAd,e=e.logger;!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this),this.props={prepareAd:t,beforePlayAd:n,preloadAd:r,loadAd:i,playAd:o,logger:e},this._reset(),this.dataLoadingDeferred=u()}e.exports=(i(d,[{key:"name",get:function(){return"Scheduler"}},{key:"logger",get:function(){return this.props.logger}}]),i(d,[{key:"populateAdsData",value:function(e){var t=this;e.forEach(function(e){return e.position===a.preroll?t.prerollAds.push(e):e.position===a.postroll?t.postrollAds.push(e):void t.midrollAds.push(e)}),this.midrollAds.sort(function(e,t){return t.startTime>e.startTime?1:-1}),this.prerollAds.length&&this.props.loadAd(this.prerollAds[0]),this.dataLoadingDeferred.resolve()}},{key:"onContentProgress",value:function(e){var t=this;if(this.ignoredFirstFrame){if(!this.state)return this._setState("preroll"),void this.dataLoadingDeferred.promise.then(function(){t._playAds(t.prerollAds).then(function(){t._setState("midroll")})});if("midroll"===this.state){if(!this.midrollAds.length)return this._setState("postroll");var n=e.current<0?e.total:e.current,r=this._getAdsPriorTime(this.midrollAds,n),e=this._getAdsPriorTime(this.midrollAds,n+s);e.length&&this.props.preloadAd(e[0]),r.length?(this.midrollAds.splice(this.midrollAds.length-r.length,r.length),this.props.beforePlayAd(c(r[0]),function(){t._playAds(r)})):(e=this._getAdsPriorTime(this.midrollAds,n+l)).length&&(n=e[0].startTime-n,this.props.prepareAd(e[0],n))}}else this.ignoredFirstFrame=!0}},{key:"onContentEnded",value:function(){this.midrollAds.length&&this.logger.warn(this.name,"cannot play these mid-roll ads because start time is too late",this.midrollAds),this._playAds(this.postrollAds),this._reset()}},{key:"_reset",value:function(){this.ignoredFirstFrame=!1,this._setState(null),this.prerollAds=[],this.midrollAds=[],this.postrollAds=[]}},{key:"_setState",value:function(e){this.logger.info(this.name,"state changed from ".concat(this.state," to ").concat(e)),this.state=e}},{key:"_playAds",value:function(e){var t=this,n=[],r=[];return e.forEach(function(e){(c(e)?n:r).push(e)}),this._playAd(n).then(function(){return t._playAd(r)})}},{key:"_playAd",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=e[n];if(r){var i={order:n+1,total:e.length};return this.props.playAd(r,i).catch(function(e){t.logger.error(t.name,"error while playing ad",e)}).then(function(){return t._playAd(e,n+1)})}return Promise.resolve()}},{key:"_getAdsPriorTime",value:function(e,t){for(var n=e.length-1;-1<n&&t>e[n].startTime;)--n;return e.slice(n+1).reverse()}}]),d)},function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=n(2),d=n(17),f=n(64),h=n(3),p=n(79),y=n(82);n(85);function g(e,t){var n,r;return function(e){if(!(e instanceof g))throw new TypeError("Cannot call a class as a function")}(this),n=this,(r=!(r=o(g).call(this))||"object"!==i(r)&&"function"!=typeof r?u(n):r).options=e,r.adContainers=t,r.$adContainer=new c({element:t.linear}),r.$adContainer.render(),r.adPlayer=null,r.adPaused=!1,r.adVolume=0,r.adVolumeCached=1,r.mouseEntered=!1,r._onClick=r._onClick.bind(u(u(r))),r._onMouseEnter=r._onMouseEnter.bind(u(u(r))),r._onMouseLeave=r._onMouseLeave.bind(u(u(r))),r._onSkipBtnClick=r._onSkipBtnClick.bind(u(u(r))),r._onViewDetailBtnClick=r._onViewDetailBtnClick.bind(u(u(r))),r.render(),r._registerEvents(),r.control.hide(),h.isMobile()&&(r.addClass("is_mobile"),r.$adContainer.off("mouseenter",r._onMouseEnter),r.$adContainer.off("mouseleave",r._onMouseLeave)),r}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(g,c),s(g,[{key:"name",get:function(){return"ad_runner_ui"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(g,[{key:"render",value:function(){return r(o(g.prototype),"render",this).call(this),this.hide(),this.$uiLoading=new c({className:"ad_runner_ui_loading"}),this.$uiLoading.render(),this.$uiLoading.element.textContent="Đang tải quảng cáo...",this.$uiLoading.hide(),this.$uiViewDetail=new c({className:"ad_runner_ui_viewdetail"}),this.$uiViewDetail.render(),this.$uiViewDetail.element.textContent="Xem chi tiết quảng cáo",this.$uiAdIndex=new c({className:"ad_runner_ui_adindex"}),this.$uiAdIndex.render(),this.$uiAdIndex.hide(),this.countdownToPlay=new d({template:"Quảng cáo hiển thị sau %ss",className:"ad_runner_ui_countdown_to_play"}),this.countdownToPlay.hide(),this.skipButton=new p({getPoster:this.options.getPoster}),this.control=new f(this),this.slideBlack=new y(this),this.appendChild(this.$uiViewDetail),this.appendChild(this.$uiAdIndex),this.appendChild(this.skipButton),this.appendChild(this.control),this.$adContainer.appendChild(this),this.adContainers.notification.appendChild(this.countdownToPlay.element),this.adContainers.notification.appendChild(this.$uiLoading.element),this.adContainers.notification.appendChild(this.slideBlack.element),this}},{key:"remove",value:function(){this._unregisterEvents(),this._stopSkipTimer(),this._stopProgressTimer(),this.skipButton.remove(),this.countdownToPlay.remove(),this.control.remove(),this.$uiLoading.remove(),this.slideBlack.remove(),r(o(g.prototype),"remove",this).call(this)}},{key:"setPlayer",value:function(e){this.adPlayer=e}},{key:"togglePlayPause",value:function(){this.adPlayer.isPaused()?(this.adPlayer.resume(),this._onPauseStateChanged(!1)):(this.adPlayer.pause(),this._onPauseStateChanged(!0))}},{key:"toggleMute",value:function(){var e=this.adPlayer.getVolume(),t=e?0:this.adVolumeCached;this.adPlayer.setVolume(t),this._onVolumeChanged(t),this.adVolumeCached=e}},{key:"onAdWillStart",value:function(){this.show(),this.$uiLoading.show(),this.$uiViewDetail.hide(),this.$uiAdIndex.hide(),this.skipButton.hide(),this.skipButton.loadPoster(),this.countdownToPlay.hide()}},{key:"onAdStarted",value:function(e){if(this.adPlayer.selfControl)return this.$uiLoading.hide(),void this.hide();this.adPlayer.canClickThrough?this.addClass("click-through"):this.removeClass("click-through"),this.adPlayer.isFacebookAd?this.addClass("facebook-ad"):this.removeClass("facebook-ad"),this.adPlayer.isGoogleImaAd?this.addClass("google-ima-ad"):this.removeClass("google-ima-ad"),this.$uiLoading.hide(),this.$uiViewDetail.show(),e&&1<e.total&&(this.$uiAdIndex.show(),this.$uiAdIndex.html("Quảng cáo ".concat(e.order," / ").concat(e.total))),this._startProgressTimer(),-1<this.adPlayer.getSkipOffset()&&(this.skipButton.show(),this.skipButton.update(this._getTimeToSkip()||5),this._startSkipTimer()),this._onVolumeChanged(this.adPlayer.getVolume())}},{key:"onAdStopped",value:function(){this._stopSkipTimer(),this._stopProgressTimer(),this.$uiLoading.hide(),this.hide()}},{key:"_registerEvents",value:function(){this.on("click",this._onClick),this.$adContainer.on("mouseenter",this._onMouseEnter),this.$adContainer.on("mouseleave",this._onMouseLeave),this.skipButton.on("click",this._onSkipBtnClick),this.$uiViewDetail.on("click",this._onViewDetailBtnClick)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClick),this.$adContainer.off("mouseenter",this._onMouseEnter),this.$adContainer.off("mouseleave",this._onMouseLeave),this.skipButton.off("click",this._onSkipBtnClick),this.$uiViewDetail.off("click",this._onViewDetailBtnClick)}},{key:"_startProgressTimer",value:function(){var n=this;this.progressTimer=setInterval(function(){var e={duration:n.adPlayer.getDuration(),remaining:n.adPlayer.getRemainingTime(),paused:n.adPlayer.isPaused()};n.control.onProgress(e);var t=n.adPlayer.getVolume();e.paused!==n.adPaused&&n._onPauseStateChanged(e.paused),t!==n.adVolume&&n._onVolumeChanged(t)},1e3)}},{key:"_stopProgressTimer",value:function(){clearInterval(this.progressTimer),this.progressTimer=null}},{key:"_startSkipTimer",value:function(){var t=this;this._stopSkipTimer();var n=this._getTimeToSkip();this.skipTimer=setInterval(function(){var e=t._getTimeToSkip();t.adPlayer.isPaused()||--n,e<=0||e-n>t.options.skipTimeout?(t.skipButton.skipOn(),t._stopSkipTimer()):t.skipButton.update(e)},1e3)}},{key:"_stopSkipTimer",value:function(){this.skipTimer&&(clearInterval(this.skipTimer),this.skipTimer=null)}},{key:"_getTimeToSkip",value:function(){var e=this.adPlayer.getSkipOffset()+this.adPlayer.getRemainingTime()-this.adPlayer.getDuration();return e<0?5:e}},{key:"_onSkipBtnClick",value:function(e){var t=this;e.stopPropagation(),function(r,e,t){var i=1<arguments.length&&void 0!==e?e:400,o=2<arguments.length?t:void 0;r.style.opacity||(r.style.opacity=1);var a=null;window.requestAnimationFrame(function e(t){var n=t-(a=a||t),t=parseFloat(1-n/i,2);r.style.opacity=t<0?0:t,i<n?"function"==typeof o&&o():window.requestAnimationFrame(e)})}(this.adPlayer.element,300,function(){t.adPlayer.skip(),t.adPlayer.element.style.opacity=null})}},{key:"_onViewDetailBtnClick",value:function(e){e.stopPropagation(),this.adPlayer.viewDetail()}},{key:"_onClick",value:function(){this.togglePlayPause()}},{key:"_onMouseEnter",value:function(){this.mouseEntered=!0,this.adPaused||this.control.show()}},{key:"_onMouseLeave",value:function(){this.mouseEntered=!1,this.adPaused||this.control.hide()}},{key:"_onPauseStateChanged",value:function(e){this.adPaused=e,this.control.onPauseStateChanged(e,this.mouseEntered)}},{key:"_onVolumeChanged",value:function(e){this.adVolume=e,this.control.onMuteStateChanged(0===e)}}]),g)},function(e,t,n){var r=n(63);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_countdown{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(2),c=n(65),d=n(68),f=n(71),h=n(74);function p(e){var t,n;return function(e){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}(this),t=this,(n=!(n=o(p).call(this))||"object"!==r(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):n).adUi=e,n.render(),n}n(77),e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,u),s(p,[{key:"name",get:function(){return"ad_runner_ui_control"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(p,[{key:"show",value:function(){this.playpause.show(),this.volume.show(),this.timer.show(),this.removeClass("minimized"),this.adUi.addClass("has_control")}},{key:"hide",value:function(){this.playpause.hide(),this.volume.hide(),this.timer.hide(),this.addClass("minimized"),this.adUi.removeClass("has_control")}},{key:"remove",value:function(){this.timeline.remove(),this.playpause.remove(),this.volume.remove(),this.timer.remove(),i(o(p.prototype),"remove",this).call(this)}},{key:"render",value:function(){i(o(p.prototype),"render",this).call(this),this.timeline=new c,this.playpause=new d(this.adUi),this.timer=new h,this.volume=new f(this.adUi),this.appendChild(this.timeline),this.appendChild(this.playpause),this.appendChild(this.timer),this.appendChild(this.volume)}},{key:"onProgress",value:function(e){e.paused||(this.timeline.setPosition((e.duration-e.remaining)/e.duration*100),this.timer.update(e))}},{key:"onPauseStateChanged",value:function(e,t){e?this.show():t||this.hide(),this.playpause.onPauseStateChanged(e)}},{key:"onMuteStateChanged",value:function(e){this.volume.onMuteStateChanged(e)}}]),p)},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(2);function c(){var e,t;return function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=o(c).call(this))||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t).render(),t}n(66),e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(c,u),s(c,[{key:"name",get:function(){return"ad_runner_ui_timeline"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(c,[{key:"render",value:function(){i(o(c.prototype),"render",this).call(this),this.$uiProgress=new u,this.$uiProgress.render(),this.appendChild(this.$uiProgress)}},{key:"setPosition",value:function(e){e<=100&&this.$uiProgress.style("width","".concat(e,"%"))}}]),c)},function(e,t,n){var r=n(67);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_timeline{bottom:0;height:4px;left:0;position:absolute;width:100%}.ad_runner_ui_timeline>div{-webkit-transition:width 1s linear;-moz-transition:width 1s linear;-o-transition:width 1s linear;transition:width 1s linear;background-color:#ffff00;height:100%;width:0%}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=n(2);n(69);var d='<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z"></path></svg>';function f(e){var t,n;return function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this),t=this,(n=!(n=o(f).call(this))||"object"!==r(n)&&"function"!=typeof n?u(t):n).adUi=e,n._onClickEvent=n._onClickEvent.bind(u(u(n))),n.render(),n._registerEvents(),n}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(f,c),s(f,[{key:"name",get:function(){return"ad_runner_ui_playpause"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(f,[{key:"render",value:function(){i(o(f.prototype),"render",this).call(this),this.html(d)}},{key:"remove",value:function(){this._unregisterEvents(),i(o(f.prototype),"remove",this).call(this)}},{key:"onPauseStateChanged",value:function(e){e?this.html('<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z"></path></svg>'):this.html(d)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.togglePlayPause()}}]),f)},function(e,t,n){var r=n(70);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_playpause{width:35px;height:35px;float:left;margin-left:5px}.ad_runner_ui_playpause:hover{cursor:pointer}.ad_runner_ui_playpause>svg{fill:#f5f5f5}.ad_runner_ui_playpause:hover>svg,.ad_runner_ui_playpause:active>svg{fill:#ffffff}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=n(2);n(72);var d='<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z M19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"></path></svg>';function f(e){var t,n;return function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this),t=this,(n=!(n=o(f).call(this))||"object"!==r(n)&&"function"!=typeof n?u(t):n)._onClickEvent=n._onClickEvent.bind(u(u(n))),n.adUi=e,n.render(),n._registerEvents(),n}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(f,c),s(f,[{key:"name",get:function(){return"ad_runner_ui_volume"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(f,[{key:"render",value:function(){i(o(f.prototype),"render",this).call(this),this.html(d)}},{key:"remove",value:function(){this._unregisterEvents(),i(o(f.prototype),"remove",this).call(this)}},{key:"onMuteStateChanged",value:function(e){e?this.html('<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="m16.98686,9.984l0,4.219l-2.109,-2.109l2.109,-2.11zm-7.734,-0.984l16.734,16.734l-1.266,1.266l-2.063,-2.063c-1.078,0.844 -2.297,1.5 -3.656,1.828l0,-2.063c0.844,-0.234 1.594,-0.656 2.25,-1.172l-4.266,-4.266l0,6.75l-5.016,-5.016l-3.984,0l0,-6l4.734,0l-4.734,-4.734l1.267,-1.264zm14.718,9c0,-3.188 -2.063,-5.859 -4.969,-6.703l0,-2.063c4.031,0.891 6.984,4.5 6.984,8.766c0,1.5 -0.375,2.953 -1.031,4.172l-1.5,-1.547c0.328,-0.797 0.516,-1.688 0.516,-2.625zm-2.484,0c0,0.234 0,0.422 -0.047,0.609l-2.438,-2.438l0,-2.203c1.5,0.75 2.484,2.25 2.484,4.031l0.001,0.001z"></path></svg>'):this.html(d)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.toggleMute()}}]),f)},function(e,t,n){var r=n(73);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_volume{width:35px;height:35px;float:right;margin-right:5px}.ad_runner_ui_volume:hover{cursor:pointer}.ad_runner_ui_volume>svg{fill:#f5f5f5}.ad_runner_ui_volume:hover>svg,.ad_runner_ui_volume:active>svg{fill:#ffffff}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(2),c=n(3).formatTime;function d(){var e,t;return function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=o(d).call(this))||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t).render(),t}n(75),e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,u),s(d,[{key:"name",get:function(){return"ad_runner_ui_timer"}},{key:"attributes",get:function(){return{class:this.name}}}]),s(d,[{key:"render",value:function(){i(o(d.prototype),"render",this).call(this),this.html("00:00 / 00:00")}},{key:"update",value:function(e){var t=c(e.duration-e.remaining),e=c(e.duration);this.html("".concat(t," / ").concat(e))}}]),d)},function(e,t,n){var r=n(76);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_timer{color:#f5f5f5;float:left;margin-left:5px;height:35px;line-height:35px;font-size:12px}\n",""])},function(e,t,n){var r=n(78);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_control{-webkit-transition:height 100ms ease;-moz-transition:height 100ms ease;-o-transition:height 100ms ease;transition:height 100ms ease;background:linear-gradient(transparent, #000);bottom:0;height:40px;left:0;position:absolute;width:100%;pointer-events:none}.ad_runner_ui_control.minimized{background:none;height:5px}.ad_runner_ui_control>*{pointer-events:auto}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=n(2),d=n(17);function f(e){var t,n=e.getPoster;return function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=o(f).call(this))||"object"!==r(e)&&"function"!=typeof e?u(t):e)._onPosterLoad=e._onPosterLoad.bind(u(u(e))),e.render(),e._registerEvents(),e.getPoster=n,e}n(80),e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(f,c),s(f,[{key:"attributes",get:function(){return{class:"ad_runner_ui_skip_button"}}}]),s(f,[{key:"render",value:function(){i(o(f.prototype),"render",this).call(this),this.countdown=new d({template:"Bỏ qua quảng cáo sau %ss",className:"countdown"}),this.countdown.render(),this.update=this.countdown.update.bind(this.countdown),this.skipText=new c({className:"skip_text"}),this.skipText.render(),this.skipText.element.textContent="Bỏ qua",this.poster=new c({tagName:"img"}),this.poster.render(),this.poster.hide(),this.playIcon=new c({className:"play_icon"}),this.playIcon.render(),this.playIcon.html('<svg viewBox="12 12 24 24"><style type="text/css"> .st1{fill:none;stroke:#f1f1f1;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;} </style><g><g><path class="st1" d="M21.88173,28.00095l6.30217-3.67922c0.24333-0.14206,0.24348-0.49362,0.00028-0.63589l-6.30217-3.68663 c-0.2455-0.14361-0.5542,0.03345-0.5542,0.31786v7.36585C21.32781,27.9672,21.63623,28.14428,21.88173,28.00095z"/><circle class="st1" cx="24" cy="24" r="11.1667"/></g></g></svg>'),this.appendChild(this.skipText),this.appendChild(this.countdown),this.appendChild(this.poster),this.appendChild(this.playIcon)}},{key:"show",value:function(){i(o(f.prototype),"show",this).call(this),this.skipText.hide(),this.countdown.show(),this.removeClass("skippable")}},{key:"hide",value:function(){i(o(f.prototype),"hide",this).call(this),this.poster.hide(),this.removeClass("has_poster")}},{key:"remove",value:function(){this._unregisterEvents(),this.countdown.remove(),this.poster.remove(),this.skipText.remove(),this.playIcon.remove(),i(o(f.prototype),"remove",this).call(this)}},{key:"loadPoster",value:function(){var t=this;this.getPoster&&this.getPoster().then(function(e){t.poster.attr("src",e)})}},{key:"skipOn",value:function(){this.skipText.show(),this.countdown.hide(),this.addClass("skippable")}},{key:"_onPosterLoad",value:function(){this.poster.show(),this.addClass("has_poster")}},{key:"_registerEvents",value:function(){this.poster.on("load",this._onPosterLoad)}},{key:"_unregisterEvents",value:function(){this.poster.off("load",this._onPosterLoad)}}]),f)},function(e,t,n){var r=n(81);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_skip_button{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;-webkit-transition:bottom 100ms ease;-moz-transition:bottom 100ms ease;-o-transition:bottom 100ms ease;transition:bottom 100ms ease;background-color:#2b2a2a;align-items:center;border:1px solid rgba(72,72,72,0.4);bottom:35px;display:flex;height:42px;padding:0;pointer-events:none !important;right:0px;text-align:center}.ad_runner_ui_skip_button.skippable{pointer-events:auto !important;cursor:pointer}.ad_runner_ui_skip_button .countdown{padding:5px;max-width:100px}.ad_runner_ui_skip_button .skip_text{font-size:13px;width:100px}.ad_runner_ui_skip_button .play_icon{position:absolute;width:65px;height:30px;right:0;display:none}.ad_runner_ui_skip_button .play_icon svg{width:30px;height:30px}.ad_runner_ui_skip_button.skippable.has_poster .play_icon{display:block}.ad_runner_ui_skip_button img{height:38px;object-fit:cover;width:65px}.is_mobile .ad_runner_ui_skip_button{width:170px;justify-content:center}.is_mobile .ad_runner_ui_skip_button .countdown{max-width:120px}.ad_runner_ui.facebook-ad .ad_runner_ui_skip_button{background-color:#000}.ad_runner_ui.has_control .ad_runner_ui_skip_button{bottom:35px}\n",""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(83);n=n(2);function s(){var e,t;return function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=o(s).call(this,{className:"ad_runners_ui_slide_black"}))||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t).render(),t}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(s,n),function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(s.prototype,[{key:"fadeIn",value:function(){this.addClass("ad_ui_slide_black_fade_in")}},{key:"fadeOut",value:function(){this.removeClass("ad_ui_slide_black_fade_in")}},{key:"render",value:function(){i(o(s.prototype),"render",this).call(this),this.html('<span class="ad_message_text">Video nội dung sẽ tiếp tục sau đoạn quảng cáo</span>'),this.hide()}}]),s)},function(e,t,n){var r=n(84);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runners_ui_slide_black{position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;background-color:#000;opacity:0;-webkit-transition:opacity .3s linear;-moz-transition:opacity .3s linear;-o-transition:opacity .3s linear;transition:opacity .3s linear}.ad_runners_ui_slide_black.ad_ui_slide_black_fade_in{opacity:1}.ad_runners_ui_slide_black .ad_message_text{color:#eee;font-size:13px;position:absolute;left:10px;bottom:10px}\n",""])},function(e,t,n){var r=n(86);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,'.ad_runner_ui{left:0px;position:absolute;top:0px;width:100%;height:100%;z-index:2}.ad_runner_ui.click-through{pointer-events:none}.ad_runner_ui.click-through>*{pointer-events:auto}.ad_runner_ui.click-through .ad_runner_ui_viewdetail{display:none}.ad_runner_ui .ad_runner_ui_viewdetail{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA2ElEQVQ4ja2U0U3DMBRFz0MM0BkyQleo2CAVm7ACYoaOUDagjJBs0G6A6AaHjzhSVcXGDtw/289H9z1fGbVXv83rCKBuCzWqwwPwBmz4D92Qt433+iVnawz0wDEtr/N+Myx1cEjLE/C6CpZAn0wzPkXE0+15New3UDXsDjQC+1xh8TVTvuYcDmo+RiVYEwh4bGhtFxHXTN0z8LXoTO3Uc40j9SUb2gT9ALqSo6o2I2JUR6ZkV4MWYQm4V7sWEBRyFhGXFlARtkahnpmG/Ve9z/9S6aet0aB2P+baSzgLyi9XAAAAAElFTkSuQmCC");background-position-x:calc(100% - 5px);background-position-y:center;background-repeat:no-repeat;background-size:12px;cursor:pointer;padding-right:20px;right:10px;top:10px}.ad_runner_ui .ad_runner_ui_adindex{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-color:transparent;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjVJREFUOBHlVEFrU0EQ/mb35TVtqqRKq0LaXhRbxbMggh5UKioePQserEcP4smjoHjoTUERvAi9eCmC9A+UCqJQJIJ6KAhNqlBLNE3y8nb89iV5SbB66bEDYb/9ZufLzOy8BXadia84Wi/MOCezgE6rYoTkEEQy3Bu6hZxfScFxUSIH1YigSm6D+6Ix+jgz9u2NROWJ87Fziz5gp2aNuWCcczd3KtSJ91oGghMdorPa4bsIR5eQ2b8IM3itQ8OEZ8ktIBwrIsg/B8xo6ksAtdgb6WNt7hZsbhZxdR4arSDY+xASngbsOEWesIMNxL/mKH6Svvv9gtQKyOR6WZO9TKFlxL/nSFuE2Yuw2Stw0QeIySHavAONv/JOfkLsZG+oxzkKqhdNTYKjcLWF9j6GuhI8J1pJOHXfk9VtzacxXaCBHwc/Cl2Ly+zCnnQvxOrWeWqzxclga7UF/tF0eq4NnOFU1XtZx3JNeIqHp2AGZljWQbZtmSW/S47Z7FV2YgLhyEv28EFvqJ/QutRK4yU25EDqkTxv8hVMcCShtLmKxo8zxDEFHsEOtW5dXQXRxvWk391YKUt9rVDkxE+lZBtIcJwZnoMdvo1m5R5c9UXiEXuY47IP2lxhRlt9YfzCPgX8nj4zw78EtfkRMX8uesuS36eBGn/xyW5v1DIKebq9t8VqY4mg9r8jqc9rJY9DbW3ykoi7wUyPqSCfPA6QAdb078cBWk8eB+XjIFJUNc+yh1Zfp+q7B/wBa0XJ8tc9BKoAAAAASUVORK5CYII=");background-position-y:center;background-repeat:no-repeat;bottom:50px;left:15px;padding-left:25px;text-shadow:0 0 4px #000}.ad_runner_ui_countdown_to_play{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px;z-index:1}.ad_runner_ui_loading{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}.ad_runner_ui_hide{display:none !important}\n',""])},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(88);n=n(2);function l(e){var t,n;return function(e){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),t=this,n=!(n=s(l).call(this,{className:"ad_runners_ui_ad_mark_container"}))||"object"!==r(n)&&"function"!=typeof n?i(t):n,a(s(l.prototype),"render",i(n)).call(i(n)),(n.containerElement=e)&&e.appendChild(n.element),n}e.exports=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(l,n),function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(l.prototype,[{key:"render",value:function(r,e){var i=this;this.containerElement&&e.forEach(function(e){var t,n=100*e.startTime/r;0<=n&&n<=100&&(t=i._createAdMarkItem(n),i.appendChild(t),e.adMarkItem=t,e._completeAd=function(){t.remove()})})}},{key:"removeMarkItems",value:function(){this.html("")}},{key:"setContainer",value:function(e){e.appendChild(this.element)}},{key:"_createAdMarkItem",value:function(e){var t=document.createElement("span");return t.setAttribute("class","ad_runners_ui_ad_mark_container_item"),t.style.left="".concat(e,"%"),t}}]),l)},function(e,t,n){var r=n(89);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runners_ui_ad_mark_container{display:flex !important;width:100%;height:100%}.ad_runners_ui_ad_mark_container .ad_runners_ui_ad_mark_container_item{height:100%;width:5px;background-color:yellow;display:block;position:relative}\n",""])}],i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=18))},function(e,t,n){"use strict";!function(e){"function"!=typeof e.Promise&&(e.Promise=n(2))}.call(this,n(3))},function(u,e,t){"use strict";!function(t){var r,e,n,i,o=t.MutationObserver||t.WebKitMutationObserver,a=o?(e=0,o=new o(l),n=t.document.createTextNode(""),o.observe(n,{characterData:!0}),function(){n.data=e=++e%2}):t.setImmediate||void 0===t.MessageChannel?"document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)}:((i=new t.MessageChannel).port1.onmessage=l,function(){i.port2.postMessage(0)}),s=[];function l(){var e,t;r=!0;for(var n=s.length;n;){for(t=s,s=[],e=-1;++e<n;)t[e]();n=s.length}r=!1}u.exports=function(e){1!==s.push(e)||r||a()}}.call(this,t(3))},function(e,t,n){n=n(8);Object.getOwnPropertySymbols||(Object.getOwnPropertySymbols=n)},function(n,e,t){!function(N){function a(){return this}var s,e,t;!function(e,t){"use strict";if(!(t in e)){var o,n=typeof N==typeof n?window:N,r=0,i=""+Math.random(),a="__symbol:",s=a.length,l="__symbol@@"+i,u="defineProperty",c="defineProperties",d="getOwnPropertyNames",f="getOwnPropertyDescriptor",h="propertyIsEnumerable",p=e[d],y=e[f],g=e.create,m=e.keys,v=e.freeze||e,b=e[u],_=e[c],E=y(e,d),k=e.prototype,A=k.hasOwnProperty,S=k[h],w=k.toString,T=function(e,t,n){A.call(e,l)||b(e,l,{enumerable:!1,configurable:!1,writable:!1,value:{}}),e[l]["@@"+t]=n},P=function(){},O=function(e){return e!=l&&!A.call(x,e)},L=function(e){return e!=l&&A.call(x,e)},R=function(e){var t=""+e;return L(t)?A.call(this,t)&&this[l]["@@"+t]:S.call(this,e)},C=function(t){return b(k,t,{enumerable:!1,configurable:!0,get:P,set:function(e){o(this,t,{enumerable:!1,configurable:!0,writable:!0,value:e}),T(this,t,!0)}}),v(x[t]=b(e(t),"constructor",I))},D=function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return C(a.concat(t||"",i,++r))},x=g(null),I={value:D},M=function(e){return x[e]},j=function(e,t,n){var r,i=""+t;return L(i)?(o(e,i,n.enumerable?((r=g(n)).enumerable=!1,r):n),T(e,i,!!n.enumerable)):b(e,t,n),e},F=function(e){return p(e).filter(L).map(M)};E.value=j,b(e,u,E),E.value=F,b(e,t,E),E.value=function(e){return p(e).filter(O)},b(e,d,E),E.value=function(t,n){var e=F(n);return e.length?m(n).concat(e).forEach(function(e){R.call(n,e)&&j(t,e,n[e])}):_(t,n),t},b(e,c,E),E.value=R,b(k,h,E),E.value=D,b(n,"Symbol",E),E.value=function(e){e=a.concat(a,e,i);return e in k?x[e]:C(e)},b(D,"for",E),E.value=function(e){if(O(e))throw new TypeError(e+" is not a symbol");if(A.call(x,e)){e=e.slice(s);if(e.slice(0,s)===a&&(e=e.slice(s))!==i)return 0<(e=e.slice(0,e.length-i.length)).length?e:void 0}},b(D,"keyFor",E),E.value=function(e,t){var n=y(e,t);return n&&L(t)&&(n.enumerable=R.call(e,t)),n},b(e,f,E),E.value=function(e,t){return 1===arguments.length||void 0===t?g(e):(n=t,r=g(e),p(n).forEach(function(e){R.call(n,e)&&j(r,e,n[e])}),r);var n,r},b(e,"create",E),E.value=function(){var e=w.call(this);return"[object String]"===e&&L(this)?"[object Symbol]":e},b(k,"toString",E);try{if(!0!==g(b({},a,{get:function(){return b(this,a,{value:!0})[a]}}))[a])throw"IE11";o=b}catch(e){o=function(e,t,n){var r=y(k,t);delete k[t],b(e,t,n),b(k,t,r)}}}}(Object,"getOwnPropertySymbols"),function(t,n){"use strict";var r,i=t.defineProperty,o=t.prototype,a=o.toString,s="toStringTag";["iterator","match","replace","search","split","hasInstance","isConcatSpreadable","unscopables","species","toPrimitive",s].forEach(function(e){e in n||(i(n,e,{value:n(e)}),e===s&&((r=t.getOwnPropertyDescriptor(o,"toString")).value=function(){var e=a.call(this),t=null!=this?this[n.toStringTag]:this;return null==t?e:"[object "+t+"]"},i(o,"toString",r)))})}(Object,Symbol),s=Symbol.iterator,e=Array.prototype,t=String.prototype,e[s]||(e[s]=function(){var t=0,n=this,e={next:function(){var e=n.length<=t;return e?{done:e}:{done:e,value:n[t++]}}};return e[s]=a,e}),t[s]||(t[s]=function(){var n=String.fromCodePoint,r=this,i=0,o=r.length,e={next:function(){var e=o<=i,t=e?"":n(r.codePointAt(i));return i+=t.length,e?{done:e}:{done:e,value:t}}};return e[s]=a,e}),n.exports=Object.getOwnPropertySymbols}.call(this,t(3))},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,r){var i={"./blue.scss":[33,1],"./green.scss":[34,2],"./light_blue.scss":[35,3],"./purple.scss":[36,4],"./red.scss":[37,5]};function n(t){var n=i[t];return n?r.e(n[1]).then(function(){var e=n[0];return r.t(e,7)}):Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return Object.keys(i)},n.id=23,e.exports=n},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"cloneDeep",function(){return $}),i.d(n,"getDeep",function(){return z}),i.d(n,"each",function(){return q}),i.d(n,"extend",function(){return X}),i.d(n,"objValuesToArray",function(){return Q});var r={};i.r(r),i.d(r,"hasClass",function(){return le}),i.d(r,"addClass",function(){return ue}),i.d(r,"removeClass",function(){return ce}),i.d(r,"toggleClass",function(){return de}),i.d(r,"setClass",function(){return fe}),i.d(r,"setStyles",function(){return he}),i.d(r,"isEl",function(){return pe}),i.d(r,"isTextNode",function(){return ye}),i.d(r,"emptyEl",function(){return ge}),i.d(r,"normalizeContent",function(){return me}),i.d(r,"appendContent",function(){return ve}),i.d(r,"insertContent",function(){return be}),i.d(r,"textContent",function(){return _e}),i.d(r,"createEl",function(){return Ee}),i.d(r,"createElFromHTML",function(){return ke}),i.d(r,"getAttribute",function(){return Ae}),i.d(r,"setAttribute",function(){return Se}),i.d(r,"removeAttribute",function(){return we}),i.d(r,"findPosition",function(){return Te}),i.d(r,"isOnViewport",function(){return Pe}),i.d(r,"getPointerPosition",function(){return Oe}),i.d(r,"isSingleLeftClick",function(){return Le}),i.d(r,"removeFromDom",function(){return Re});var o={};i.r(o),i.d(o,"IS_IPAD",function(){return et}),i.d(o,"IS_IPHONE",function(){return tt}),i.d(o,"IS_IPOD",function(){return nt}),i.d(o,"IS_IOS",function(){return rt}),i.d(o,"IOS_VERSION",function(){return it}),i.d(o,"IS_ANDROID",function(){return ot}),i.d(o,"ANDROID_VERSION",function(){return at}),i.d(o,"IS_NATIVE_ANDROID",function(){return st}),i.d(o,"IS_FIREFOX",function(){return lt}),i.d(o,"IS_EDGE",function(){return ut}),i.d(o,"IS_CHROME",function(){return ct}),i.d(o,"CHROME_VERSION",function(){return dt}),i.d(o,"IE_VERSION",function(){return ft}),i.d(o,"IS_SAFARI",function(){return ht}),i.d(o,"IS_ANY_SAFARI",function(){return pt}),i.d(o,"IS_MOBILE",function(){return yt});var a={};i.r(a),i.d(a,"createPromiseDefer",function(){return gt});var s={};i.r(s),i.d(s,"orderBy",function(){return It}),i.d(s,"whereBy",function(){return Mt}),i.d(s,"average",function(){return jt}),i.d(s,"findWithAttr",function(){return Ft});var l={};i.r(l),i.d(l,"getHours",function(){return Rr}),i.d(l,"getMinutes",function(){return Cr}),i.d(l,"getSeconds",function(){return Dr}),i.d(l,"getCurrentTimeSeconds",function(){return Ir}),i.d(l,"formatTime",function(){return Mr});var u={};i.r(u),i.d(u,"format",function(){return Bo}),i.d(u,"escapeHtml",function(){return Yo}),i.d(u,"trimHtml",function(){return Go}),i.d(u,"trimAccents",function(){return Vo}),i.d(u,"startsWith",function(){return Ho}),i.d(u,"endsWith",function(){return Ko}),i.d(u,"generateId",function(){return $o}),i.d(u,"getPercentage",function(){return zo}),i.d(u,"replaceAll",function(){return Wo}),i.d(u,"toTitleCase",function(){return qo}),i.d(u,"toPascalCase",function(){return Xo}),i.d(u,"toCamelCase",function(){return Qo}),i.d(u,"stripHTML",function(){return Jo}),i.d(u,"getHTML",function(){return Zo});var c={};i.r(c),i.d(c,"checkAdBlocker",function(){return Ga});var d={};i.r(d),i.d(d,"fetchUrl",function(){return Ha});var f={};i.r(f),i.d(f,"fadeOut",function(){return gl}),i.d(f,"fadeIn",function(){return ml}),i(5),i(7);var h={};function p(e){return h[e]||(h[e]=0),e+ ++h[e]}var y="font-weight: bold; font-size: 13px;",g="color: #ff8000;"+y,m="color: #ff0000;"+y,v=["color: #0000ff;font-weight: bold; font-size: 13px;","color: #006600;font-weight: bold; font-size: 13px;",g,m,m],b=["debug","info","warn","error","disabled"],_=(function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(E.prototype,[{key:"debug",value:function(e){this.log(e,0,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(e){this.log(e,1,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(e){this.log(e,2,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(e){this.log(e,3,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Zplayer.Log] set log level to "+b[this.level],g)}},{key:"level",value:function(e){this.level=e}},{key:"log",value:function(e,t,n){t<this.level||(n||(n=e,e=null),window.console&&window.console.log&&window.console.log.apply(console,["%c["+b[t]+"]"+(e?"["+e+"]":""),v[t]].concat(n)))}}]),E);function E(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;!function(e){if(!(e instanceof E))throw new TypeError("Cannot call a class as a function")}(this),this.level=e,this.offLevel=t}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}_.LEVEL_DEBUG=0,_.LEVEL_INFO=1,_.LEVEL_WARN=2,_.LEVEL_ERROR=3,_.LEVEL_DISABLED=4,_.getInstance=function(){return void 0===this._instance&&(this._instance=new this,this._instance.previousLevel=this._instance.level,this._instance.level=this._instance.offLevel),this._instance},_.setLevel=function(e){this.getInstance().level=e},_.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)},_.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)},_.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)},_.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};function S(e,t,n,r){if(!n)return 1;if("object"!==A(n)){if(!P.test(n))return 1;for(var i=n.split(P),o=0,a=i.length;o<a;o++)e[t].apply(e,[i[o]].concat(r))}else for(var s in n)e[t].apply(e,[s,n[s]].concat(r))}function w(e,n,r,i){var o,a=-1,s=e.length,l=n[0],u=n[1],c=n[2];!function t(){try{switch(n.length){case 0:for(;++a<s;)(o=e[a]).callback.call(o.ctx);return;case 1:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l);return;case 2:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l,u);return;case 3:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l,u,c);return;default:for(;++a<s;)(o=e[a]).callback.apply(o.ctx,n);return}}catch(e){_.error.apply(_,[r,"error on event",i,"trigger","-",e]),t()}}()}var T=Array.prototype.slice,P=/\s+/,O=(Ze=[{key:"register",value:function(e){R.Custom||(R.Custom={});var t="string"==typeof e&&e.toUpperCase().trim();t&&!R.Custom[t]?R.Custom[t]=t.toLowerCase().split("_").map(function(e,t){return 0===t?e:e[0].toUpperCase()+e.slice(1)}).join(""):_.error("Events","Error when register event: "+e)}}],k((Je=R).prototype,[{key:"on",value:function(e,t,n){if(!S(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});e=this._events[e]||(this._events[e]=[]);return e&&e.push({callback:t,context:n,ctx:n||this}),this}},{key:"once",value:function(e,t,n){var r,i=this;return S(this,"once",e,[t,n])&&t?this.on(e,r=function(){i.off(e,r),t.apply(this,arguments)},n):this}},{key:"off",value:function(e,t,n){var r,i,o,a,s,l,u,c;if(!this._events||!S(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(s=0,l=(a=e?[e]:Object.keys(this._events)).length;s<l&&(e=a[s],o=this._events[e])&&(this._events[e]=r=[],t||n);s++){for(u=0,c=o.length;u<c;u++)i=o[u],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this}},{key:"trigger",value:function(e){var t=this.name||this.constructor.name;if(!e)return _.warn.apply(_,[t,"trying to trigger undefined event, ignored"]),this;if(!this._events)return this;var n=T.call(arguments,1);if(!S(this,"trigger",e,n))return this;var r=this._events[e],i=this._events.all;return r&&w(r,n,t,e),i&&w(i,arguments,t,e),this}},{key:"stopListening",value:function(e,t,n){var r=this._listeningTo;if(!r)return this;var i,o=!t&&!n;for(i in n||"object"!==A(t)||(n=this),e&&((r={})[e._listenId]=e),r)(e=r[i]).off(t,n,this),!o&&0!==Object.keys(e._events).length||delete this._listeningTo[i];return this}}]),k(Je,Ze),R),L={listenTo:"on",listenToOnce:"once"};function R(){!function(e){if(!(e instanceof R))throw new TypeError("Cannot call a class as a function")}(this)}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.keys(L).forEach(function(r){O.prototype[r]=function(e,t,n){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=p("l"))]=e,n||"object"!==A(t)||(n=this),e[L[r]](t,n,this),this}}),["PLAYER_PLAY","PLAYER_PLAY_INTENT","PLAYER_PAUSE","PLAYER_STOP","PLAYER_ENDED","PLAYER_SEEK","PLAYER_SEEKED","PLAYER_SEEKING","PLAYER_ERROR","PLAYER_TIMEUPDATE","PLAYER_PROGRESS","PLAYER_FULLSCREEN","PLAYER_READY","PLAYER_BUFFERING","PLAYER_BUFFERING_CHANGE","PLAYER_BUFFERFULL","PLAYER_PRESS_PLAY","PLAYER_VOLUMEUPDATE","PLAYER_LOADEDMETADATA","PLAYER_CLICK","PLAYER_DBLCLICK","PLAYER_KEYDOWN","PLAYER_MOUSE_ENTER","PLAYER_MOUSE_LEAVE","PLAYER_MOUSE_MOVE","PLAYER_CONTEXTMENU","PLAYER_LEVELS_AVAILABEL","PLAYER_LEVEL_SWITCHED","PLAYER_SETTINGS_MENU_HIDE","PLAYER_QUALITY_LEVELS_SELECTED","PLAYER_UPDATE_SIZE","PLAYER_CANPLAYTHROUGH","PLAYER_WAITING","PLAYER_ORIENTATION_CHANGE","PLAYER_AD_PAUSE_REQUEST","PLAYER_AD_RESUME_REQUEST","PLAYER_AD_WILL_START","PLAYER_AD_STARTED","PLAYER_AD_STOPPED","PLAYER_AD_SKIPPED","PLAYER_AD_LOAD_TIMEOUT","PLAYER_MEDIACONTROL_DISABLE","PLAYER_MEDIACONTROL_ENABLE","PLAYER_MEDIACONTROL_SHOW","PLAYER_MEDIACONTROL_HIDE","PLAYER_MEDIACONTROL_READY","PLAYER_MEDIACONTROL_CLICK","PLAYER_MEDIACONTROL_DBLCLICK","PLAYER_DVRSTATECHANGED","PLAYER_THEATER_MODE_CHANGE","PLAYBACK_PROGRESS","PLAYBACK_TIMEUPDATE","PLAYBACK_BUFFERING","PLAYBACK_BUFFERING_CHANGE","PLAYBACK_BUFFERFULL","PLAYBACK_SETTINGSUPDATE","PLAYBACK_LOADEDMETADATA","PLAYBACK_VOLUMEUPDATE","PLAYBACK_HIGHDEFINITIONUPDATE","PLAYBACK_BITRATE","PLAYBACK_LEVELS_AVAILABLE","PLAYBACK_LEVEL_SWITCH_START","PLAYBACK_LEVEL_SWITCH_END","PLAYBACK_PLAYBACKSTATE","PLAYBACK_DVR","PLAYBACK_DVRSTATECHANGED","PLAYBACK_MEDIACONTROL_DISABLE","PLAYBACK_MEDIACONTROL_ENABLE","PLAYBACK_ENDED","PLAYBACK_PLAY_INTENT","PLAYBACK_PLAY","PLAYBACK_PAUSE","PLAYBACK_SEEKING","PLAYBACK_WAITING","PLAYBACK_SEEKED","PLAYBACK_STOP","PLAYBACK_ERROR","PLAYBACK_STATS_ADD","PLAYBACK_FRAGMENT_LOADED","PLAYBACK_LEVEL_SWITCHED","PLAYBACK_SUBTITLE_AVAILABLE","PLAYBACK_SUBTITLE_CHANGED","PLAYBACK_FULLSCREEN_IOS","PLAYBACK_CANPLAYTHROUGH","MEDIACONTROL_HIDE","MEDIACONTROL_SHOW","MEDIACONTROL_MOUSEMOVE_SEEKBAR","MEDIACONTROL_MOUSELEAVE_SEEKBAR"].forEach(function(e){O[e]=e});function M(e){return null!=e?e.constructor:null}function j(e,t){return Boolean(e&&t&&e instanceof t)}function F(e){return null==e}function N(e){return M(e)===Object}function U(e){return M(e)===String}function B(e){return Array.isArray(e)}function Y(e){return j(e,NodeList)}function G(e){return F(e)||(U(e)||B(e)||Y(e))&&!e.length||N(e)&&!Object.keys(e).length}var V=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(K,O),Ln=[{key:"NAME_EVENTS",get:function(){return[]}}],x((En=K).prototype,[{key:"bindEvents",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach(function(e){e.once?t.listenToOnce(e.target||n||t,e.name,e.handler):t.listenTo(e.target||n||t,e.name,e.handler)})}},{key:"unbindEvents",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach(function(e){e.once?t.stopListening(e.target||n||t,e.name):t.stopListening(e.target||n||t,e.name,e.handler)})}},{key:"options",get:function(){return this._options}},{key:"listenEvents",get:function(){return[]}}]),x(En,Ln),K),H={nullOrUndefined:F,object:N,number:function(e){return M(e)===Number&&!Number.isNaN(e)},string:U,boolean:function(e){return M(e)===Boolean},function:function(e){return M(e)===Function},array:B,weakMap:function(e){return j(e,WeakMap)},nodeList:Y,element:function(e){return j(e,Element)},textNode:function(e){return M(e)===Text},event:function(e){return j(e,Event)},cue:function(e){return j(e,window.TextTrackCue)||j(e,window.VTTCue)},track:function(e){return j(e,TextTrack)||!F(e)&&U(e.kind)},url:function(e){if(j(e,window.URL))return!0;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!G(new URL(t).hostname)}catch(e){return!1}},empty:G};function K(e,t){var n,r,i;return function(e){if(!(e instanceof K))throw new TypeError("Cannot call a class as a function")}(this),e&&(t=e.options),r=this,i=D(K).call(this),(n=!i||"object"!==C(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i).player=e,n._options=t,n.uniqueId=p("o"),n._nameEvents={},n.constructor.NAME_EVENTS.forEach(function(e){O[e]=e,n._nameEvents[e]=e}),n}function $(e){return JSON.parse(JSON.stringify(e))}function z(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}var W=function(e){return H.object(e)?Object.keys(e):[]};function q(t,n){W(t).forEach(function(e){return n(t[e],e)})}function X(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var r=arguments[t];if(r)for(var i in r)r.hasOwnProperty(i)&&("[object Object]"!==Object.prototype.toString.call(r[i])?e[i]=r[i]:e[i]=X(e[i],r[i]))}return e}function Q(t){return Object.values&&Object.values(t)||Object.keys(t).map(function(e){return t[e]})}function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t,n){return t&&ee(e.prototype,t),n&&ee(e,n),e}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var re=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),ne(e,t)}(ae,V),te(ae,[{key:"defaultOptions",get:function(){return{}}}]),te(ae,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then(function(){return e.setUp()}).then(function(){return e.enabled&&e.bindEvents()})}},{key:"getPluginOptions",value:function(){return X(this.defaultOptions,z(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0,_.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.enabled=!1,_.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.player.removePlugin(this.name)}}]),ae),ie=i(1),oe=i.n(ie);function ae(e){var t;return function(e){if(!(e instanceof ae))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=Z(ae).call(this,e))||"object"!==J(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).pluginOptions=e.getPluginOptions(),e.enabled=!0,e.pluginOptions.disabled&&e.disable(),e}function se(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function le(e,t){return se(t),e.classList?e.classList.contains(t):new RegExp("(^|\\s)"+t+"($|\\s)").test(e.className)}function ue(e,t){return e.classList?e.classList.add(t):le(e,t)||(e.className=(e.className+" "+t).trim()),e}function ce(e,t){return e.classList?e.classList.remove(t):(se(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function de(e,t,n){if(e.classList)return void 0===n?e.classList.toggle(t):e.classList.toggle(t,n);var r=le(e,t);return(n="boolean"!=typeof(n="function"==typeof n?n(e,t):n)?!r:n)!==r?((n?ue:ce)(e,t),e):void 0}function fe(e,t){return e.className=t,e}function he(e,t){for(var n in t){var r;null===t[n]?(r=n.split(/(?=[A-Z])/).map(function(e){return e.toLowerCase()}).join("-"),e.style.removeProperty(r)):e.style[n]=t[n]}return e}function pe(e){return H.object(e)&&1===e.nodeType}function ye(e){return H.object(e)&&3===e.nodeType}function ge(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function me(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return pe(e="function"==typeof e?e():e)||ye(e)?e:"string"==typeof e&&/\S/.test(e)?document.createTextNode(e):void 0}).filter(function(e){return e})}function ve(t,e){return me(e).forEach(function(e){return t.appendChild(e)}),t}function be(e,t){return ve(ge(e),t)}function _e(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function Ee(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=document.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?i.setAttribute(e,t):i[e]=t}),Object.getOwnPropertyNames(t).forEach(function(e){i.setAttribute(e,t[e])}),r&&ve(i,r),i}function ke(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function Ae(e,t){return e.getAttribute(t)}function Se(e,t,n){e.setAttribute(t,n)}function we(e,t){e.removeAttribute(t)}function Te(e){var t;if(!(t=e.getBoundingClientRect&&e.parentNode?e.getBoundingClientRect():t))return{left:0,top:0};var n=document.documentElement,r=document.body,i=n.clientLeft||r.clientLeft||0,e=window.pageXOffset||r.scrollLeft,i=t.left+e-i,n=n.clientTop||r.clientTop||0,r=window.pageYOffset||r.scrollTop,n=t.top+r-n;return{left:Math.round(i),top:Math.round(n)}}function Pe(e){if(e){e=e.getBoundingClientRect();return e.height/2<=window.innerHeight-e.top&&e.bottom>=e.height/2}}function Oe(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r={},i=Te(e),o=n?e.offsetHeight:e.offsetWidth,a=n?e.offsetWidth:e.offsetHeight,s=i.top,n=i.left,e=t.pageY,i=t.pageX;return t.changedTouches&&(i=t.changedTouches[0].pageX,e=t.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(s-e+a)/a)),r.x=Math.max(0,Math.min(1,(i-n)/o)),r}function Le(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons}function Re(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Me=/^(\S+)\s*(.*)$/,je=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Ie(e,t)}(Fe,V),Nt=[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}}],De((y=Fe).prototype,[{key:"$",value:function(e){return this.$el.find(e)}},{key:"setElement",value:function(e){return this.$el=oe.a.zepto.isZ(e)?e:oe()(e),this.el=this.$el[0],this}},{key:"buildElement",value:function(){var e,t;this.el?this.setElement(this.el,!1):(t=X({},this.attributes),this.id&&(t.id=this.id),e=X({},this.properties),t=Ee(this.tagName,e,t),this.setElement(t,!1))}},{key:"delegateEvents",value:function(e){if(!e&&!(e=this.events))return this;for(var t in e){var n,r=e[t];(r=r&&r.constructor!==Function?this[e[t]]:r)&&(t=(n=t.match(Me))[1],n=n[2],t+=".delegateEvents"+this.cid,""===n?this.$el.on(t,r.bind(this)):this.$el.on(t,n,r.bind(this)))}}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"render",value:function(){return this}},{key:"remove",value:function(){return this.$el.remove(),this.unbindEvents(),this.undelegateEvents(),this}},{key:"getAttribute",value:function(e){return Ae(this.el,e)}},{key:"setAttribute",value:function(e,t){Se(this.el,e,t)}},{key:"removeAttribute",value:function(e){we(this.el,e)}},{key:"setStyles",value:function(e){he(this.el,e)}},{key:"hasClass",value:function(e){return le(this.el,e)}},{key:"addClass",value:function(e){ue(this.el,e)}},{key:"removeClass",value:function(e){ce(this.el,e)}},{key:"toggleClass",value:function(e,t){de(this.el,e,t)}},{key:"show",value:function(){this.removeClass("--z--hide")}},{key:"hide",value:function(){this.addClass("--z--hide")}},{key:"properties",get:function(){return{}}}]),De(y,Nt),Fe);function Fe(e,t){var n;return function(e){if(!(e instanceof Fe))throw new TypeError("Cannot call a class as a function")}(this),n=this,(t=!(t=xe(Fe).call(this,e,t))||"object"!==Ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n):t).cid=p("c"),t.buildElement(),t.delegateEvents(),t}function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(e,t,n){return t&&Be(e.prototype,t),n&&Be(e,n),e}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ve=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Ge(e,t)}(He,je),Ye(He,[{key:"defaultOptions",get:function(){return{}}}]),Ye(He,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then(function(){return e.setUp()}).then(function(){return e.render()}).then(function(){return e.enabled&&e.bindEvents()})}},{key:"getPluginOptions",value:function(){return X(this.defaultOptions,z(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0,_.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.hide(),this.enabled=!1,_.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.remove(),this.player.removePlugin(this.name)}}]),He);function He(e){var t;return function(e){if(!(e instanceof He))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=Ue(He).call(this,e))||"object"!==Ne(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).pluginOptions=e.getPluginOptions(),e.enabled=!0,e.pluginOptions.disabled&&e.disable(),e}function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(9);(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),We(e,t)})(qe,je),$e(qe.prototype,[{key:"play",value:function(){throw new Error("this must be implemented")}},{key:"pause",value:function(){throw new Error("this must be implemented")}},{key:"stop",value:function(){}},{key:"seek",value:function(){}},{key:"seekPercentage",value:function(){}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",value:function(){throw new Error("this must be implemented")}},{key:"getPlaybackType",value:function(){return qe.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"volume",value:function(){}},{key:"getVolume",value:function(){return 0}},{key:"isHlsPlayback",value:function(){return!1}},{key:"isMp4Playback",value:function(){return!1}},{key:"destroy",value:function(){this.remove()}}]),m=qe;function qe(e){return function(e){if(!(e instanceof qe))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=ze(qe).call(this,null,e))||"object"!==Ke(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e;var t}m.canPlay=function(){return!1},m.VOD="vod",m.AOD="aod",m.LIVE="live",m.LIVE_END="live_end",m.NO_OP="no_op",m.type="playback";var Xe=m,Qe=window.navigator&&window.navigator.userAgent||"",Je=/AppleWebKit\/([\d.]+)/i.exec(Qe),Ze=Je?parseFloat(Je.pop()):null,et=/iPad/i.test(Qe),tt=/iPhone/i.test(Qe)&&!et,nt=/iPod/i.test(Qe),rt=tt||et||nt,it=(En=Qe.match(/OS (\d+)_/i))&&En[1]?En[1]:null,ot=/Android/i.test(Qe),at=function(){var e=Qe.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),st=ot&&at<5&&Ze<537,lt=/Firefox/i.test(Qe),ut=/Edge/i.test(Qe),ct=!ut&&(/Chrome/i.test(Qe)||/CriOS/i.test(Qe)),dt=(Ln=Qe.match(/(Chrome|CriOS)\/(\d+)/))&&Ln[2]?parseFloat(Ln[2]):null,ft=y=!(y=(ie=/MSIE\s(\d+)\.\d/.exec(Qe))&&parseFloat(ie[1]))&&/Trident\/7.0/i.test(Qe)&&/rv:11.0/.test(Qe)?11:y,ht=/Safari/i.test(Qe)&&!ct&&!ot&&!ut,pt=(ht||rt)&&!ct,yt=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(Qe);function gt(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n}function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t,n){return(vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bt(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Et(e,t,n){return t&&_t(e.prototype,t),n&&_t(e,n),e}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var St={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},wt=Object.keys(St).reduce(function(e,t){return[].concat(At(e),At(St[t]))},[]),Tt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(Pt,Xe),Et(Pt,[{key:"isAudioOnly",get:function(){var e=this.options.src,e=Pt._mimeTypesForUrl(e,St,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||0<=wt.indexOf(e[0])}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_onCanplaythrough",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",stalled:"_onStalled",timeupdate:"_onTimeUpdate",waiting:"_onWaiting",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",ended:"_onEnded",webkitbeginfullscreen:"_onBeginFullScreen",webkitendfullscreen:"_onEndFullScreen"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}}]),Et(Pt,[{key:"setupSource",value:function(e){H.empty(e)||this.el.src!==e&&(this._src=e,this.el.src=e)}},{key:"getSource",value:function(){return this._src}},{key:"render",value:function(){return this._readyDeferred.resolve(),this}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"play",value:function(){return this._stopped=!1,this._handleBufferingEvents(),this.playPromise=this.el.play(),_.debug(this.name,"PLAY_PROMISE",this.playPromise),this.playPromise}},{key:"pause",value:function(){var e=this;this.playPromise?this.playPromise.then(function(){return e.el.pause()}):this.el.pause()}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(O.PLAYBACK_STOP)}},{key:"volume",value:function(e){e<0||100<e||(0===e?this.mute():this.unmute(),this.el.volume=e/100,this.trigger(O.PLAYBACK_VOLUMEUPDATE,e))}},{key:"getVolume",value:function(){return this.el.volume}},{key:"mute",value:function(){this.$el.attr({muted:"true"}),this.el.muted=!0}},{key:"unmute",value:function(){this.$el.attr({muted:null}),this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted}},{key:"seek",value:function(e){H.number(e)&&(this.el.currentTime=e)}},{key:"seekPercentage",value:function(e){e=this.el.duration*(e/100);this.seek(e)}},{key:"getCurrentTime",value:function(){this.el.currentTime}},{key:"getDuration",value:function(){return this.el.duration}},{key:"setPlaybackRate",value:function(){this.el.playbackRate=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1}},{key:"setPreload",value:function(){return this.el.preload=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"metadata",this}},{key:"destroy",value:function(){this._destroyed=!0,vt(bt(Pt.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this._src=null}},{key:"_now",value:function(){return Date.now()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onCanplaythrough",value:function(e){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_CANPLAYTHROUGH,{time:this._now(),data:e})}},{key:"_onError",value:function(){var e=this.el.error;e?(e={code:e.code,description:e.message,raw:e},this.trigger(O.PLAYBACK_ERROR,e)):_.warn(this.name,"HTML5 media unknown error")}},{key:"_onWaiting",value:function(e){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_WAITING,{time:this._now(),data:e}),this._loadStarted=!0}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedMetadata",value:function(e){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_LOADEDMETADATA,{duration:e.target.duration,data:e})}},{key:"_onStalled",value:function(){this._handleBufferingEvents()}},{key:"_onTimeUpdate",value:function(){this.trigger(O.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var e=this.el.buffered.length,t=[],n=0,r=0;r<e;r++)t=[].concat(At(t),[{start:this.el.buffered.start(r),end:this.el.buffered.end(r)}]),this.el.currentTime>=t[r].start&&this.el.currentTime<=t[r].end&&(n=r);var i={start:t[n].start,current:t[n].end,total:this.el.duration};this.trigger(O.PLAYBACK_PROGRESS,i,t)}}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(O.PLAYBACK_PAUSE)}},{key:"_onPlaying",value:function(){this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(O.PLAYBACK_PLAY)}},{key:"_onSeeking",value:function(e){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_SEEKING,{time:this._now(),data:e})}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(O.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingPercent",value:function(){if("html5_video"===this.name&&(1===this.el.networkState||2===this.el.networkState)){for(var e=this.el.buffered.length,t=this.el.currentTime,n=0,r=0;r<e;r++){var i=this.el.buffered.end(r);(i<=t&&n<i||this.el.buffered.start(r)<=t&&t<=i)&&(n=i)}this.trigger(O.PLAYBACK_BUFFERING_CHANGE,100/6*(6-(t+3-n)))}}},{key:"_handleBufferingEvents",value:function(){this._handleBufferingPercent();var e=!this.el.ended&&!this.el.paused,e=this._loadStarted&&!this.el.ended&&!this._stopped&&(e&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!=e&&((this._isBuffering=e)?this.trigger(O.PLAYBACK_BUFFERING,this.name):this.trigger(O.PLAYBACK_BUFFERFULL,this.name))}},{key:"_startPlayheadMovingChecks",value:function(){null===this._playheadMovingTimer&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){null!==this._playheadMovingTimer&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var e=this._playheadMovingTimeOnCheck,t=this.el.currentTime;this._playheadMoving=e!==t,this._playheadMovingTimeOnCheck=t,this._handleBufferingEvents()}},{key:"_onBeginFullScreen",value:function(){this.trigger(O.PLAYBACK_FULLSCREEN_IOS,!0)}},{key:"_onEndFullScreen",value:function(){this.trigger(O.PLAYBACK_FULLSCREEN_IOS,!1)}},{key:"getPlaybackType",value:function(){throw new Error("this must be implemented")}}]),Pt);function Pt(){!function(e){if(!(e instanceof Pt))throw new TypeError("Cannot call a class as a function")}(this);for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e=this,(e=!(i=(i=bt(Pt)).call.apply(i,[this].concat(n)))||"object"!==mt(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):i)._readyDeferred=gt(),e._destroyed=!1,e._loadStarted=!1,e._playheadMoving=!1,e._playheadMovingTimer=null,e._stopped=!1,e.isHlsPlayback()||e.setupSource(e.options.src),e.options.playback||(e.options.playback=e.options||{});var i=e.options.playback.preload||(ht?"auto":e.options.preload);return X(e.el,{muted:e.options.mute,loop:e.options.loop,preload:i,autoPlay:e.options.autoPlay||!1}),e.options.playInline&&(e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline","")),e}function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Tt._mimeTypesForUrl=function(e,t,n){e=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],e=n||e&&t[e.toLowerCase()]||[];return e.constructor===Array?e:[e]},Tt._canPlay=function(e,t,n,r){var r=Tt._mimeTypesForUrl(n,t,r),i=document.createElement(e);return!!r.filter(function(e){return!!i.canPlayType(e).replace(/no/,"")})[0]};var Dt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(xt,Tt),Lt(xt.prototype,[{key:"getPlaybackType",value:function(){var e=Xe.VOD;return 0<=[0,void 0,1/0].indexOf(this.el.duration)?Xe.LIVE:e}},{key:"isMp4Playback",value:function(){return!0}},{key:"name",get:function(){return"html5_video"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"attributes",get:function(){return{"data-html5-video":""}}}]),xt);function xt(){return function(e){if(!(e instanceof xt))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Rt(xt).apply(this,arguments))||"object"!==Ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function It(e,n){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(H.array(e)&&n)return e.sort(function(e,t){return r?e[n]-t[n]:t[n]-e[n]})}function Mt(e,t,n){if(H.array(e))return e.filter(function(e){return e[t]===n}).shift()}function jt(e){return e.length?e.reduce(function(e,t){return e+t},0)/e.length:0}function Ft(e,t,n){for(var r=e.length,i=0;i<r;i++)if(e[i][t]===n)return i;return-1}Dt.canPlay=function(e,t){var n={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};return n.ogv=n.ogg,n["3gp"]=n["3gpp"],Tt._canPlay("video",n,e,t)};var Nt=i(0),Ut=i.n(Nt);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t,n){return(Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gt(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ht(e,t,n){return t&&Vt(e.prototype,t),n&&Vt(e,n),e}function Kt(e,t){return(Kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var zt={startLevel:-1},Wt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}(qt,Tt),Ht(qt,[{key:"name",get:function(){return"hls"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(e){var t=this;this.playPromise&&this.playPromise.then(function(){t._currentLevel=e,t._hls&&(t._hls.currentLevel=t._currentLevel)})}},{key:"startLevel",set:function(e){var t=this;this.playPromise&&this.playPromise.then(function(){t._startLevel=e,t._hls&&(t._hls.startLevel=t._startLevel)})},get:function(){return this._startLevel}}],[{key:"canPlay",value:function(e,t){e=e.split("?")[0].match(/.*\.(.*)$/)||[];return(1<e.length&&"m3u8"===e[1].toLowerCase()||"application/x-mpegURL"===t||"application/vnd.apple.mpegurl"===t)&&Ut.a.isSupported()}}]),Ht(qt,[{key:"stop",value:function(){Yt(Gt(qt.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls}},{key:"isHlsPlayback",value:function(){return!0}},{key:"_initHls",value:function(){var e=this,t=new Ut.a(this._config.hls);t.on(Ut.a.Events.MEDIA_ATTACHED,function(){return t.loadSource(e.options.src)}),t.on(Ut.a.Events.ERROR,this._onHLSJSError),t.once(Ut.a.Events.LEVEL_LOADED,this._updatePlaybackType.bind(this)),t.on(Ut.a.Events.LEVEL_SWITCH,this._onLevelSwitch.bind(this)),t.on(Ut.a.Events.LEVEL_SWITCHED,this._onLevelSwitched.bind(this)),t.on(Ut.a.Events.FRAG_LOAD_PROGRESS,this._onFragLoadingProgress.bind(this)),t.on(Ut.a.Events.FRAG_LOADED,this._onFragLoadedProgress.bind(this)),t.attachMedia(this.el),this._hls=t}},{key:"_updatePlaybackType",value:function(e,t){_.debug(this.name,"_updatePlaybackType",t),this._playbackType=t.details.live?Xe.LIVE:0<t.details.startSN?Xe.LIVE_END:Xe.VOD,this.trigger(O.PLAYBACK_DVRSTATECHANGED),this._fillLevels(),_.debug(this.name,"LEVELS",this._levels),this.initLevelFromLocalStorage()}},{key:"_onLevelSwitch",value:function(e,t){_.debug(this.name,"_onLevelSwitch",t)}},{key:"_onLevelSwitched",value:function(e,t){_.debug(this.name,"_onLevelSwitched",t);t=Mt(this.levels,"index",t.level);this.trigger(O.PLAYBACK_LEVEL_SWITCHED,t)}},{key:"_addingSuffixCharacter",value:function(e){e=e.toString().toLowerCase();return-1<e.indexOf("p")?e:e+"p"}},{key:"_generateLabel",value:function(e){return e.name||Math.ceil(e.bitrate/1e3)}},{key:"_fillLevels",value:function(){var n=this;H.empty(this._levels)&&(this._levels=this._hls.levels.map(function(e,t){return{index:t,level:e,label:n._addingSuffixCharacter(n._generateLabel(e))}}),this._levels.unshift({index:-1,label:"Auto"}),this.trigger(O.PLAYBACK_LEVELS_AVAILABLE,this._levels))}},{key:"initLevelFromLocalStorage",value:function(){var e;H.array(this._levels)&&this.options.quality&&(e=Mt(this._levels,"label",this.options.quality),H.object(e)&&H.object(e.level)&&(this.currentLevel=e.index,this.startLevel=e.index))}},{key:"_recoverMediaError",value:function(e){return this._recoverRetry+=1,this._recoverRetry>this._config.recoverMaxRetry?(_.error(this.name,"could not recover from error after maximum number of attempts",e),this.trigger(O.PLAYBACK_ERROR,e),void this.stop()):(_.warn(this.name,"recovering fatal error (".concat(this._recoverRetry,"/").concat(this._config.recoverMaxRetry,"):"),e),this._recoveredMediaError?this._hls.swapAudioCodec():this._recoveredMediaError=!0,void this._hls.recoverMediaError())}},{key:"_onError",value:function(){var e=this.el.error;if(e){var t=e.code,n={code:t,description:e.message,raw:e};if(t===e.MEDIA_ERR_DECODE)return this._recoverMediaError(n);this.trigger(O.PLAYBACK_ERROR,n)}else _.warn(this.name,"HTML5 video unknown error")}},{key:"_onHLSJSError",value:function(e,t){if(t.fatal){var n={code:"".concat(t.type,"_").concat(t.details),description:t.reason||(t.response?"status: ".concat(t.response.code,", text: ").concat(t.response.text):"unknown"),raw:t};return t.type===Ut.a.ErrorTypes.NETWORK_ERROR&&t.response.code<400?(_.debug(this.name,"recovering network error, user may be offline:",n),void this._hls.startLoad()):t.type!==Ut.a.ErrorTypes.MEDIA_ERROR?(_.error(this.name,"unrecoverable fatal error: ".concat(t.type),n),this.trigger(O.PLAYBACK_ERROR,n),void this.stop()):void this._recoverMediaError(n)}}},{key:"_onTimeUpdate",value:function(){this.el.duration&&this.trigger(O.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onFragLoadingProgress",value:function(e,t){t=100/t.stats.total*t.stats.loaded;this.trigger(O.PLAYBACK_BUFFERING_CHANGE,t)}},{key:"_onFragLoadedProgress",value:function(){this.trigger(O.PLAYBACK_BUFFERFULL,this.name)}},{key:"getPlaybackType",value:function(){return this._playbackType}}]),qt);function qt(){var e;!function(e){if(!(e instanceof qt))throw new TypeError("Cannot call a class as a function")}(this);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=!(e=(e=Gt(qt)).call.apply(e,[this].concat(n)))||"object"!==Bt(e)&&"function"!=typeof e?$t(this):e)._config={hls:z(e.options,"playback.hls")||zt,recoverMaxRetry:z(e.options,"playback.hls.recoverMaxRetry")||16},e._recoverRetry=0,e._recoveredMediaError=!1,e._playbackType=Xe.VOD,e._onHLSJSError=e._onHLSJSError.bind($t($t(e))),e._initHls(),e}function Xt(e){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t,n){return(Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jt(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Jt(e){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t,n){return t&&Zt(e.prototype,t),n&&Zt(e,n),e}function tn(e,t){return(tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nn=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(rn,Xe),en(rn,[{key:"name",get:function(){return"youtube_playback"}},{key:"attributes",get:function(){return{"data-youtube-playback":"",class:"zplayer-youtube-playback",style:"height:100%",id:this.cid}}},{key:"buffering",get:function(){return!1}}],[{key:"canPlay",value:function(e){return this.isYTVideo(e)}},{key:"isYTVideo",value:function(e){return!!e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)&&RegExp.$1}}]),en(rn,[{key:"ready",value:function(){this._ready=!0,this.$el.hide(),this._readyDeferred.resolve()}},{key:"qualityChange",value:function(){this.trigger(O.PLAYBACK_HIGHDEFINITIONUPDATE)}},{key:"stateChange",value:function(e){switch(e.data){case window.YT.PlayerState.PLAYING:this.$el.show(),this.trigger(O.PLAYBACK_PLAY),this._isSeeking&&(this._isSeeking=!1,this.trigger(O.PLAYBACK_SEEKED));break;case window.YT.PlayerState.PAUSE:this.$el.hide(),this.trigger(O.PLAYBACK_PAUSE);break;case window.YT.PlayerState.ENDED:this.ended(),this.seek(0),this.stop();break;default:this.$el.show()}}},{key:"play",value:function(){var e=this;this._progressTimer=this._progressTimer||setInterval(function(){return e.progress()},100),this._timeupdateTimer=setInterval(function(){return e.timeupdate()},100),this.player.playVideo(),this.trigger(O.PLAYBACK_PLAY),this.trigger(O.PLAYBACK_BUFFERFULL)}},{key:"pause",value:function(){this.clearTimer(),this.player&&this.player.pauseVideo(),this.trigger(O.PLAYBACK_PAUSE)}},{key:"seek",value:function(e){this.player&&(this.player.seekTo(e),this._isSeeking=!0,setTimeout(function(){},100))}},{key:"ended",value:function(){this.trigger(O.PLAYBACK_ENDED)}},{key:"stop",value:function(){this.player.stopVideo(),this.clearTimer()}},{key:"volume",value:function(e){this.player&&(this.player.setVolume(e),e<=0?this.player.mute():this.player.unMute(),this.trigger(O.PLAYBACK_VOLUMEUPDATE,e))}},{key:"isMuted",value:function(){return this.player&&this.player.isMuted()}},{key:"getVolume",value:function(){return this.player&&this.player.getVolume()}},{key:"progress",value:function(){var e=this.player.getDuration()*this.player.getVideoLoadedFraction();this.trigger(O.PLAYBACK_PROGRESS,0,e,this.player.getDuration())}},{key:"timeupdate",value:function(){this.trigger(O.PLAYBACK_TIMEUPDATE,{current:this.player.getCurrentTime(),total:this.player.getDuration()})}},{key:"isPlaying",value:function(){return this.player&&this._timeupdateTimer&&this.player.getPlayerState()==window.YT.PlayerState.PLAYING}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"getDuration",value:function(){var e=0;return this.player&&(e=this.player.getDuration()),parseFloat(e)}},{key:"render",value:function(){var e=this;return this.el.append(Ee("div",{},{id:"yt".concat(this.cid)})),setTimeout(function(){e._setupYoutubePlayer()},1),this}},{key:"setPlaybackRate",value:function(){this.player.setPlaybackRate(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)}},{key:"_setupYoutubePlayer",value:function(){window.YT&&window.YT.Player?this._embedYoutubePlayer():this._embedYoutubeApiScript()}},{key:"_getVideoId",value:function(e){return(void 0!==(e=e.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?e[2].split(/[^0-9a-z_\-]/i):e)[0]}},{key:"_embedYoutubeApiScript",value:function(){var e=this,t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("async","async"),t.setAttribute("src","https://www.youtube.com/iframe_api"),document.body.appendChild(t),window.onYouTubeIframeAPIReady=function(){return e._embedYoutubePlayer()}}},{key:"_embedYoutubePlayer",value:function(){var t=this,e={controls:0,autoplay:this.options.autoPlay?1:0,disablekb:1,rel:0,enablejsapi:1,iv_load_policy:3,modestbranding:1,showinfo:0,html5:1,playsinline:this.options.playInline?1:0};this.player=new window.YT.Player("yt".concat(this.cid),{videoId:this._getVideoId(this.options.source),playerVars:e,width:"100%",height:"100%",events:{onReady:function(){return t.ready()},onStateChange:function(e){return t.stateChange(e)},onPlaybackQualityChange:function(e){return t.qualityChange(e)}}})}},{key:"getPlaybackType",value:function(){return Xe.VOD}},{key:"clearTimer",value:function(){clearInterval(this._timeupdateTimer),clearInterval(this._progressTimer),this._timeupdateTimer=null,this._progressTimer=null}},{key:"destroy",value:function(){this.clearTimer(),Qt(Jt(rn.prototype),"destroy",this).call(this),this.stop(),this.player.destroy(),this.player=null}}]),rn);function rn(){!function(e){if(!(e instanceof rn))throw new TypeError("Cannot call a class as a function")}(this);for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=this,(t=!(t=(t=Jt(rn)).call.apply(t,[this].concat(r)))||"object"!==Xt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t)._ready=!1,t._readyDeferred=gt(),t._isSeeking=!1,t}function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ln(e,t){return(ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(10);var un=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ln(e,t)}(gn,Xe),m=[{key:"canPlay",value:function(){return!0}}],an((Je=gn).prototype,[{key:"render",value:function(){var e=Ee("p",{innerHTML:"Your browser does not support the playback of this video. Please try using a different browser."},{"data-no-op-msg":""});return this.el.append(e),this}},{key:"isReady",value:function(){return Promise.resolve()}},{key:"name",get:function(){return"no_op"}},{key:"attributes",get:function(){return{"data-no-op":""}}}]),an(Je,m),gn),cn=(i(11),"--z--full-width"),dn="--z--bg-transparent",fn={layout:{left:["playpause","volume","time"],right:["settings","fullscreen"],default:["seekbar"]},type:{fullWidth:!1},alwaysShowControl:!1,showOnPauseMobile:!1,hideAnimation:!1,theme:"",disabled:!1},hn="transparent",pn="gradient",yn={RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"};function gn(){return function(e){if(!(e instanceof gn))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=sn(gn).apply(this,arguments))||"object"!==on(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _n(e,t){return(_n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(12);var En=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),_n(e,t)}(kn,je),vn(kn.prototype,[{key:"destroy",value:function(){this.remove()}},{key:"handleClick",value:function(){}},{key:"className",get:function(){return["",this.name].join(" ")}},{key:"attributes",get:function(){return{class:this.className}}},{key:"events",get:function(){return{click:"handleClick"}}}]),kn);function kn(e,t){var n;return function(e){if(!(e instanceof kn))throw new TypeError("Cannot call a class as a function")}(this),n=this,(e=!(e=bn(kn).call(this,e))||"object"!==mn(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n):e).plugin=t,e.bindEvents(),e}function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Tn(e,t)})(Pn,En),Sn(Pn.prototype,[{key:"name",get:function(){return"ButtonControl"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return["--z--control --z--btn",this.name].join(" ")}}]),Ze=Pn;function Pn(){return function(e){if(!(e instanceof Pn))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=wn(Pn).apply(this,arguments))||"object"!==An(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ln=(On(Rn.prototype,[{key:"initializer",value:function(e,t){this.controls=t}},{key:"onMouseOver",value:function(){yt||this.controls.disableAutoHide()}},{key:"onMouseOut",value:function(){this.controls.enableAutoHide()}},{key:"handleClick",value:function(){}},{key:"events",get:function(){return{click:"handleClick",mouseover:"onMouseOver",mouseout:"onMouseOut"}}}]),Rn);function Rn(){!function(e){if(!(e instanceof Rn))throw new TypeError("Cannot call a class as a function")}(this)}function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function In(e,t){return(In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mn(e){for(var t=arguments.length,o=new Array(1<t?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];function r(t,n){Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n)).forEach(function(e){e.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&In(e,t)}(a,e),a);function a(){for(var t,e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=(e=Dn(a)).call.apply(e,[this].concat(r)),t=!e||"object"!==Cn(e)&&"function"!=typeof e?xn(this):e,o.forEach(function(e){(e=e.prototype.initializer).call.apply(e,[xn(t)].concat(r))}),t}return o.forEach(function(e){r(i.prototype,e.prototype),r(i,e)}),i}function jn(e){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fn(e){return(Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(e,t,n){return t&&Nn(e.prototype,t),n&&Nn(e,n),e}function Bn(e,t){return(Bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bn(e,t)})(Yn,Mn(Ze,Ln)),Un(Yn,[{key:"name",get:function(){return"PlayPauseControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-play"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_ENDED,handler:this.onEnded},{name:O.PLAYER_CLICK,handler:this.toogleIcon},{name:O.PLAYER_PLAY,handler:this.toogleIcon},{name:O.PLAYER_PAUSE,handler:this.toogleIcon}]}}]),Un(Yn,[{key:"toogleIcon",value:function(){ce(this.iconEl,"pl-ic-refresh");var e=this.player.isPlaying();de(this.iconEl,"pl-ic-play_arrow",!e),de(this.iconEl,"pl-ic-pause",e),this.setAttribute("title",e?"Dừng":"Phát")}},{key:"onEnded",value:function(){ce(this.iconEl,"pl-ic-play_arrow"),ce(this.iconEl,"pl-ic-pause"),ue(this.iconEl,"pl-ic-refresh"),this.setAttribute("title","Phát lại")}},{key:"handleClick",value:function(){this.player.togglePlay(),this.toogleIcon()}},{key:"render",value:function(){return this.iconEl=Ee("span",{},{class:"--z--icon pl-ic-play_arrow"}),this.config.color&&he(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),ie=Yn;function Yn(){!function(e){if(!(e instanceof Yn))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r=this;var r=!(i=(i=Fn(Yn)).call.apply(i,[this].concat(t)))||"object"!==jn(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i,i=t[0];return r.config=X({},fn,z(i.options,"controls.playPause")||{}),r}function Gn(e){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kn(e,t,n){return t&&Hn(e.prototype,t),n&&Hn(e,n),e}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(13);(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),$n(e,t)})(zn,En),Kn(zn,[{key:"name",get:function(){return"SliderControl"}}]),Kn(zn,[{key:"onMouseDown",value:function(e){(yt||Le(e))&&(this.isDragging=!0,e&&e.preventDefault(),this.plugin.disableAutoHide(),window.on("mousemove",this.onMouseMove.bind(this)),window.on("mouseup",this.onBodyUnbindMouseMove.bind(this)))}},{key:"onMouseUp",value:function(e){this.isDragging=!1,this.distance=this.calculateDistance(e),this.handleMouseUp(),this.plugin.enableAutoHide()}},{key:"onMouseMove",value:function(e){yt&&!this.isDragging||(this.distance=this.calculateDistance(e),(yt||Le(e))&&(this.isDragging&&this.handleMouseMove(),this.plugin.disableAutoHide()))}},{key:"onBodyUnbindMouseMove",value:function(e){yt&&!this.isDragging||(window.off("mousemove",this.onMouseMove.bind(this)),window.off("mouseup",this.onBodyUnbindMouseMove.bind(this)),this.onMouseUp(e))}},{key:"calculateDistance",value:function(e){var t=this.player.options,n=t.lockRotateFullscreen,r=t.customIosFullscreen,i=!this.player.isLandscapeScreen(),t=this.player.isFullscreen(),t=r&&n&&i&&t,e=Oe(this.el,e,t);return t?1-e.y:e.x}},{key:"handleClick",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"handleMouseMove",value:function(){throw new Error("this must be overridden")}},{key:"handleMouseUp",value:function(){throw new Error("this must be overridden")}},{key:"events",get:function(){return{click:"handleClick",touchmove:"onMouseMove",touchstart:"onMouseDown",mousedown:"onMouseDown",touchend:"onMouseUp"}}}]),y=zn;function zn(e,t){var n;return function(e){if(!(e instanceof zn))throw new TypeError("Cannot call a class as a function")}(this),n=this,(t=!(t=Vn(zn).call(this,e,t))||"object"!==Gn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n):t).isDragging=!1,t.distance=0,t}function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t,n){return t&&Xn(e.prototype,t),n&&Xn(e,n),e}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(14);var Zn={color:"",bulletColor:""},er=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Jn(e,t)}(tr,En),Qn(tr,[{key:"name",get:function(){return"SliderFillRecentBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-recent"}},{key:"tagName",get:function(){return"span"}}]),Qn(tr,[{key:"update",value:function(e){H.number(e)&&(e={width:"".concat(e,"%")},he(this.el,e))}},{key:"render",value:function(){return this.config.color&&he(this.el,{backgroundColor:this.config.color}),this.bulletEl=Ee("span",{},{class:"--z--bullet"}),this.config.bulletColor&&he(this.bulletEl,{backgroundColor:this.config.bulletColor}),this.el.append(this.bulletEl),this}}]),tr);function tr(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){if(!(e instanceof tr))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=qn(tr).call(this,e))||"object"!==Wn(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).config=X({},Zn,n),e.render(),e}function nr(e){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rr(e){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function or(e,t,n){return t&&ir(e.prototype,t),n&&ir(e,n),e}function ar(e,t){return(ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sr=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ar(e,t)}(lr,er),or(lr,[{key:"name",get:function(){return"ProgressControl"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate}]}}]),or(lr,[{key:"onTimeUpdate",value:function(e){var t=e.current<0?e.total:e.current;this.currentPositionValue=t,this.currentDurationValue=e.total,this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100,this.update(this.currentSeekBarPercentage)}}]),lr);function lr(e){!function(e){if(!(e instanceof lr))throw new TypeError("Cannot call a class as a function")}(this);var t,n=z(e.options,"controls.seekBar.foregroundColor")||"",r=z(e.options,"controls.seekBar.playHeadColor")||"";return t=this,!(r=rr(lr).call(this,e,{color:n,bulletColor:r}))||"object"!==nr(r)&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):r}function ur(e){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fr(e,t,n){return t&&dr(e.prototype,t),n&&dr(e,n),e}function hr(e,t){return(hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(15);var pr={color:""};function yr(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){if(!(e instanceof yr))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=cr(yr).call(this,e))||"object"!==ur(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).config=X({},pr,n),e.render(),e}function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mr(e){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t,n){return t&&vr(e.prototype,t),n&&vr(e,n),e}function _r(e,t){return(_r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Er=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),_r(e,t)}(kr,(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),hr(e,t)}(yr,En),fr(yr,[{key:"name",get:function(){return"SliderLoadedBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-load"}},{key:"tagName",get:function(){return"span"}}]),fr(yr,[{key:"update",value:function(e){H.number(e)&&(e={width:"".concat(e,"%")},he(this.el,e))}},{key:"render",value:function(){return this.config.color&&he(this.el,{backgroundColor:this.config.color}),this}}]),yr)),br(kr,[{key:"name",get:function(){return"LoadProgressBar"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_PROGRESS,handler:this.onProgressUpdate}]}}]),br(kr,[{key:"onProgressUpdate",value:function(e){var t=e.start/e.total*100,e=e.current/e.total*100;this.processLoaded=e-t,this.update(this.processLoaded)}}]),kr);function kr(e){!function(e){if(!(e instanceof kr))throw new TypeError("Cannot call a class as a function")}(this);var t,n=z(e.options,"controls.seekBar.bufferedColor")||"";return t=this,!(n=mr(kr).call(this,e,{color:n}))||"object"!==gr(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):n}function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t,n){return t&&wr(e.prototype,t),n&&wr(e,n),e}function Pr(e,t){return(Pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(16);var Or={color:""},Lr=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Pr(e,t)}(xr,En),Tr(xr,[{key:"name",get:function(){return"SliderBackgroundBar"}},{key:"className",get:function(){return"--z--bar --z--bar-bg"}},{key:"tagName",get:function(){return"span"}}]),Tr(xr,[{key:"render",value:function(){return this.config.color&&he(this.el,{backgroundColor:this.config.color}),this}}]),xr),Rr=function(e){return parseInt(e/60/60%60,10)},Cr=function(e){return parseInt(e/60%60,10)},Dr=function(e){return parseInt(e%60,10)};function xr(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){if(!(e instanceof xr))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=Sr(xr).call(this,e))||"object"!==Ar(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).config=X({},Or,n),e.render(),e}function Ir(){return(new Date).getTime()/1e3}function Mr(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!H.number(e))return"";function r(e){return"0".concat(e).slice(-2)}var i=Rr(e),o=Cr(e),a=Dr(e),i=t||0<i?"".concat(i,":"):"";return"".concat(n&&0<e?"-":"").concat(i).concat(r(o),":").concat(r(a))}function jr(e){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fr(e){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ur(e,t,n){return t&&Nr(e.prototype,t),n&&Nr(e,n),e}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yr=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Br(e,t)}(Gr,je),Ur(Gr,[{key:"name",get:function(){return"SeekTime"}},{key:"tagName",get:function(){return"span"}},{key:"attributes",get:function(){return{class:"--z--seek-time"}}},{key:"listenEvents",get:function(){return[{name:O.MEDIACONTROL_MOUSEMOVE_SEEKBAR,handler:this.onMouseMoveSeekbar},{name:O.MEDIACONTROL_MOUSELEAVE_SEEKBAR,handler:this.onMouseLeaveSeekbar}]}}]),Ur(Gr,[{key:"onMouseMoveSeekbar",value:function(e,t){var n=t*this.player.getDuration();he(this.el,{left:100*t+"%",marginLeft:-this.el.offsetWidth/2+"px"}),this.el.textContent=Mr(n),this.show()}},{key:"onMouseLeaveSeekbar",value:function(){this.hide()}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0)}},{key:"disable",value:function(){this.unbindEvents(),this.hide(),this.enabled=!1}},{key:"render",value:function(){return this.el.innerHTML="00:00",this}}]),Gr);function Gr(e){var t;return function(e){if(!(e instanceof Gr))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=Fr(Gr).call(this,e))||"object"!==jr(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).enabled=!0,e.render(),e.hide(),e.bindEvents(),e}function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hr(e,t,n){return(Hr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kr(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zr(e,t,n){return t&&$r(e.prototype,t),n&&$r(e,n),e}function Wr(e,t){return(Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)})(qr,Mn(y,Ln)),zr(qr,[{key:"name",get:function(){return"SeekBarControl"}},{key:"className",get:function(){return"--z--progress-bar"}},{key:"events",get:function(){return{touchmove:"onMouseMove",mousedown:"onMouseDown",touchstart:"onMouseDown",touchend:"onMouseUp",mouseleave:"onMouseLeave",mouseover:"onMouseOver",mouseout:"onMouseOut",mousemove:"onMouseMove"}}},{key:"listenEvents",get:function(){return[{once:!0,name:O.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),zr(qr,[{key:"onMouseLeave",value:function(e){this.player.trigger(O.MEDIACONTROL_MOUSELEAVE_SEEKBAR,e)}},{key:"onMouseMove",value:function(e){_.debug(this.name,"onMouseMove"),Hr(Kr(qr.prototype),"onMouseMove",this).call(this,e),this.player.trigger(O.MEDIACONTROL_MOUSEMOVE_SEEKBAR,e,this.distance)}},{key:"onMouseDown",value:function(e){_.debug(this.name,"onMouseDown"),Hr(Kr(qr.prototype),"onMouseDown",this).call(this,e),this.addClass("active"),this.isPlayingBeforeSeek=this.player.isPlaying(),this.isPlayingBeforeSeek&&this.player.pause()}},{key:"update",value:function(){var e=100*this.distance;this.player.seekPercentage(e),this.currentSeekBarPercentage=e,this.progressControl.update(this.currentSeekBarPercentage)}},{key:"handleMouseMove",value:function(){this.player.mediaControl.draggingSeekBar=!0,this.update()}},{key:"handleMouseUp",value:function(){this.plugin.draggingSeekBar=!1,this.update(),this.removeClass("active"),this.seekTime.hide(),this.isPlayingBeforeSeek&&this.player.play()}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.loadProgressBar.el),this.el.append(this.progressControl.el),this.el.append(this.seekTime.el),this}},{key:"remove",value:function(){[this.loadProgressBar,this.progressControl,this.barBackground,this.seekTime].forEach(function(e){e.remove()}),Hr(Kr(qr.prototype),"remove",this).call(this)}}]),Nt=qr;function qr(){!function(e){if(!(e instanceof qr))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i=this;var r=!(o=(r=Kr(qr)).call.apply(r,[this].concat(t)))||"object"!==Vr(o)&&"function"!=typeof o?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i):o,i=t[0],o=z(i.options,"controls.seekBar.backgroundColor")||"";return r.loadProgressBar=new Er(i),r.progressControl=new sr(i),r.barBackground=new Lr(i,{color:o}),r.seekTime=new Yr(i),r}function Xr(e){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zr(e,t,n){return t&&Jr(e.prototype,t),n&&Jr(e,n),e}function ei(e,t){return(ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(17);var ti={currentTimeColor:"",totalTimeColor:"",delimiterColor:"",delimiter:"/"},Je=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),ei(e,t)}(ni,En),Zr(ni,[{key:"name",get:function(){return"TimeControl"}},{key:"className",get:function(){return"--z--control --z--control-time"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{once:!0,name:O.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),Zr(ni,[{key:"onTimeUpdate",value:function(e){this.el&&(this.currentTime=e.current<0?e.total:e.current,this.duration||(this.duration=this.player.getDuration()),this.update())}},{key:"update",value:function(){this.currentTimeEl&&(this.currentTimeEl.textContent=Mr(this.currentTime)),this.durationEl&&(this.durationEl.textContent=Mr(this.duration))}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.currentTimeEl=Ee("span"),this.spaceEl=Ee("span",{innerHTML:this.config.delimiter}),this.durationEl=Ee("span",{innerHTML:Mr(this.duration)}),he(this.currentTimeEl,{color:this.config.currentTimeColor}),he(this.spaceEl,{color:this.config.delimiterColor}),he(this.durationEl,{color:this.config.totalTimeColor}),this.el.append(this.currentTimeEl),this.el.append(this.spaceEl),this.el.append(this.durationEl),this}}]),ni);function ni(e){var t,n;return function(e){if(!(e instanceof ni))throw new TypeError("Cannot call a class as a function")}(this),t=this,(n=!(n=Qr(ni).call(this,e))||"object"!==Xr(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):n).config=X({},ti,z(e.options,"controls.time")||{}),n.currentTime=0,n.duration=n.player.getDuration(),n}function ri(e){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ai(e,t,n){return t&&oi(e.prototype,t),n&&oi(e,n),e}function si(e,t){return(si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(18),i(19);var li={color:""},ui=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),si(e,t)}(ci,Ze),ai(ci,[{key:"name",get:function(){return"VolumeButton"}},{key:"className",get:function(){return"--z--control --z--btn --z--volume-icon"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated}]}}]),ai(ci,[{key:"_chooseVolumeIconInit",value:function(){0===this.volume?this.volumeIconClass="pl-ic-volume_off":50<=this.volume?this.volumeIconClass="pl-ic-volume_up":this.volume<50&&(this.volumeIconClass="pl-ic-volume_down")}},{key:"handleClick",value:function(){this.player.isMuted()?this.player.setVolume(this.cachedVolume,!0):this.player.setVolume(0,!0)}},{key:"onVolumeUpdated",value:function(e){0<(this.volume=e)&&(this.cachedVolume=e),this.updateIcon(e),this.setAttribute("title",0===e?"Bật âm thanh":"Tắt tiếng")}},{key:"updateIcon",value:function(e){de(this.iconEl,"pl-ic-volume_down",e<50),de(this.iconEl,"pl-ic-volume_up",50<=e),de(this.iconEl,"pl-ic-volume_off",0===e)}},{key:"render",value:function(){return this.iconEl=Ee("span",{},{class:"--z--icon ".concat(this.volumeIconClass)}),this.config.color&&he(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),ci);function ci(e){var t,n;return function(e){if(!(e instanceof ci))throw new TypeError("Cannot call a class as a function")}(this),t=this,(n=!(n=ii(ci).call(this,e))||"object"!==ri(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):n).config=X({},li,z(e.options,"controls.volumeButton")||{}),n.volume=e.options.mute?0:e.options.volume,n.cachedVolume=e.options.volume||100,n.volumeIconClass="",n._chooseVolumeIconInit(),n}function di(e){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fi(e,t,n){return(fi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hi(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function hi(e){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yi(e,t,n){return t&&pi(e.prototype,t),n&&pi(e,n),e}function gi(e,t){return(gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(20);var mi=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),gi(e,t)}(vi,y),yi(vi,[{key:"name",get:function(){return"VolumeBar"}},{key:"className",get:function(){return"--z--volume-bar"}},{key:"tagName",get:function(){return"span"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:O.PLAYER_READY,handler:this.onPlayerReady},{name:O.PLAYER_FULLSCREEN,handler:this.onPlayerReady}]}}]),yi(vi,[{key:"onPlayerReady",value:function(){this.player.getPlayerSize().width<=400?this.hide():this.show()}},{key:"onVolumeUpdated",value:function(e){this.volume=e,this.update()}},{key:"setVolume",value:function(e){e=Math.min(100,Math.max(e,0)),this.volume=e,this.player.setVolume(e,!0),this.update()}},{key:"update",value:function(){this.barFill&&this.barFill.update(this.volume)}},{key:"onMouseDown",value:function(e){fi(hi(vi.prototype),"onMouseDown",this).call(this,e),this.parent.toggleHideAnimation(!1)}},{key:"handleMouseMove",value:function(){this.handleMouse()}},{key:"handleMouseUp",value:function(){this.handleMouse(),this.parent.toggleHideAnimation(!0)}},{key:"handleMouse",value:function(){this.player.mediaControl.draggingVolumeBar=!0,this.setVolume(100*this.distance)}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.barFill.el),this}}]),vi);function vi(e,t,n){!function(e){if(!(e instanceof vi))throw new TypeError("Cannot call a class as a function")}(this),r=this,(n=!(i=hi(vi).call(this,e,n))||"object"!==di(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i).volume=e.options.mute?0:e.options.volume,n.parent=t;var r=z(e.options,"controls.volumeBar.foregroundColor")||"",i=z(e.options,"controls.volumeBar.backgroundColor")||"",t=z(e.options,"controls.volumeBar.volumeHeadColor")||"";return n.barFill=new er(e,{color:r,bulletColor:t}),n.barBackground=new Lr(e,{color:i}),n.update(),n}function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _i(e,t,n){return(_i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ei(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Ei(e){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ai(e,t,n){return t&&ki(e.prototype,t),n&&ki(e,n),e}function Si(e,t){return(Si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var m=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Si(e,t)}(Pi,Mn(En,Ln)),Ai(Pi,[{key:"name",get:function(){return"VolumeControl"}},{key:"className",get:function(){return"--z--control --z--control-volume"}}]),Ai(Pi,[{key:"toggleHideAnimation",value:function(){this.toggleClass("--z--hide-animation",!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}},{key:"render",value:function(){return this.el.append(this.volumeButton.render().el),this.el.append(this.volumeBar.render().el),this}},{key:"remove",value:function(){[this.volumeButton,this.volumeBar].forEach(function(e){e.remove()}),_i(Ei(Pi.prototype),"remove",this).call(this)}}]),Pi),Ti=(i(21),{isFullscreenIos:!1,isFullscreen:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||this.isFullscreenIos)},requestFullscreen:function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.querySelector&&e.querySelector("video")&&e.querySelector("video").webkitEnterFullScreen?e.querySelector("video").webkitEnterFullScreen():e.webkitEnterFullScreen&&e.webkitEnterFullScreen()},cancelFullscreen:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;return e.exitFullscreen?e.exitFullscreen():e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen?e.msExitFullscreen():void 0},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}});function Pi(){!function(e){if(!(e instanceof Pi))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!(o=(i=Ei(Pi)).call.apply(i,[this].concat(t)))||"object"!==bi(o)&&"function"!=typeof o?wi(this):o,i=t[0],o=t[1];r.volumeButton=new ui(i),r.volumeBar=new mi(i,wi(wi(r)),o);i=z(i.options,"controls.volumeBarShowOnHover");return H.nullOrUndefined(i)&&(i=!0),r.toggleHideAnimation(i),r}function Oi(e){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Li(e){return(Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ci(e,t,n){return t&&Ri(e.prototype,t),n&&Ri(e,n),e}function Di(e,t){return(Di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xi={color:""},y=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Di(e,t)}(Ii,Mn(Ze,Ln)),Ci(Ii,[{key:"name",get:function(){return"FullScreenControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-full-screen"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_FULLSCREEN,handler:this._onFullScreenChange}]}}]),Ci(Ii,[{key:"handleClick",value:function(){this.player.toggleFullscreen()}},{key:"toogleIconFullScreen",value:function(e){de(this.iconEl,"pl-ic-fullscreen_exit",e),de(this.iconEl,"pl-ic-fullscreen",!e),this.setButtonTooltip(e)}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,n=t?t.on:"Toàn màn hình",t=t?t.off:"Thoát chế độ toàn màn hình";this.setAttribute("title",e?t:n)}},{key:"render",value:function(){return this.iconEl=Ee("span",{},{class:"--z--icon pl-ic-fullscreen"}),this.setButtonTooltip(this.player.isFullscreen()),this.config.color&&he(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}},{key:"_onFullScreenChange",value:function(e){this.toogleIconFullScreen(e)}}]),Ii);function Ii(){!function(e){if(!(e instanceof Ii))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r=this;var r=!(i=(i=Li(Ii)).call.apply(i,[this].concat(t)))||"object"!==Oi(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i,i=t[0];return r.config=X({},xi,z(i.options,"controls.fullscreen")||{}),r}function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ji(e,t,n){return(ji="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fi(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Fi(e){return(Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ui(e,t,n){return t&&Ni(e.prototype,t),n&&Ni(e,n),e}function Bi(e,t){return(Bi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}i(22);var Gi={color:"",labelBgColor:"",labelTextColor:""},Vi=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Bi(e,t)}(Ki,En),Ui(Ki,[{key:"name",get:function(){return"SettingsButton"}},{key:"className",get:function(){return"--z--btn --z--btn-settings"}},{key:"tagName",get:function(){return"button"}}]),Ui(Ki,[{key:"clickOutsideSettingsButton",value:function(e){le(e.target,"pl-ic-settings")||this.parent.hideSettingsMenu()}},{key:"remove",value:function(){window.off("click.".concat(this.name),this.clickOutsideSettingsButton.bind(this)),ji(Fi(Ki.prototype),"remove",this).call(this)}},{key:"handleClick",value:function(e){e.stopPropagation(),this.parent.toggleVisibleSettingsMenu()}},{key:"updateBadgeLabel",value:function(e){this.label=e,this.iconLabelEl.textContent=e}},{key:"render",value:function(){return this.iconEl=Ee("span",{},{class:"--z--icon pl-ic-settings"}),this.iconLabelEl=Ee("span",{},{class:"--z--badge"}),this.iconLabelEl.textContent=this.label,this.setAttribute("title","Cài đặt"),he(this.iconEl,{color:this.config.color}),he(this.iconLabelEl,{backgroundColor:this.config.labelBgColor,color:this.config.labelTextColor}),this.el.append(this.iconEl),this.el.append(this.iconLabelEl),this}}]),Ki),Hi={MENU_TYPE:{TOGGLE:"toggle",EXPAND:"expand"},LIST_MENU_TYPE:{CHECKLIST:"checklist",MIXIN:"mixin"}};function Ki(e,t){var n;return function(e){if(!(e instanceof Ki))throw new TypeError("Cannot call a class as a function")}(this),(n=!(n=Fi(Ki).call(this,e))||"object"!==Mi(n)&&"function"!=typeof n?Yi(this):n).config=X({},Gi,z(e.options,"controls.SettingsButton")||{}),n.parent=t,n.label="",window.on("click.".concat(n.name),n.clickOutsideSettingsButton.bind(Yi(Yi(n)))),n}function $i(e){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zi(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);(t="function"==typeof Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})):t).forEach(function(e){var t,n;t=r,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e})}return r}function Wi(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function qi(e){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qi(e,t,n){return t&&Xi(e.prototype,t),n&&Xi(e,n),e}function Ji(e,t){return(Ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zi(){}var eo=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ji(e,t)}(to,Mn(En,Ln)),Qi(to,[{key:"name",get:function(){return"SettingsMenu"}},{key:"className",get:function(){return"--z--zpl-settings-menu"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_READY,handler:this.onPlayerReady},{name:O.PLAYER_MEDIACONTROL_HIDE,handler:this.onHideMediaControl},{name:O.PLAYER_SETTINGS_MENU_HIDE,handler:this.hideMenu},{name:O.PLAYER_PLAY,handler:this.hideMenu},{name:O.PLAYER_PAUSE,handler:this.hideMenu},{name:O.PLAYER_FULLSCREEN,handler:this.hideMenu},{name:O.PLAYER_MEDIACONTROL_CLICK,handler:this.hideMenu},{name:O.PLAYER_VOLUMEUPDATE,handler:this.hideMenu}]}}]),Qi(to,[{key:"handleClick",value:function(e){e.stopPropagation()}},{key:"onHideMediaControl",value:function(){this.hideMenu()}},{key:"onPlayerReady",value:function(){var e=Q(this.settingsMenuItems);(e=e.length?It(e,"order"):e).length?(this.createMenu({type:Hi.LIST_MENU_TYPE.MIXIN,config:{itemsList:e}}),this.parent.show(),this.parent.settingsButton.show()):this.parent.hide()}},{key:"registerMenuItem",value:function(e){var t=e.pluginKey,n=void 0===t?"":t,r=e.type,i=void 0===r?Hi.MENU_TYPE.TOGGLE:r,o=e.config,t=void 0===o?{}:o,r=e.order,o=void 0===r?0:r,r=e.callback,r=void 0===r?Zi:r,e=e.optionsConfig;if(!n)throw new Error("pluginKey must be required");this.settingsMenuItems[n]={type:i,config:t,order:o,callback:r,optionsConfig:e}}},{key:"asyncRegisterMenuItem",value:function(){this.registerMenuItem.apply(this,arguments),this.onPlayerReady()}},{key:"createToggleItem",value:function(e){var r=this,t=e.title,n=e.checked,i=void 0!==n&&n,n=e.clickCallback,o=void 0===n?Zi:n,a=e.itemIndex,s=Ee("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(void 0===t?"":t,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-toggle-checkbox"></div>\n            </div>\n        ')},{class:"--z--zpl-menu-item","aria-checked":i});return s.on("click",function(e){H.function(o)&&o(e,s);var t="true"!==Ae(s,"aria-checked");Se(s,"aria-checked",t);var n=r.routeHistory.length;!n||"mixin"===z(e=r.routeHistory[n-1],"config.headerConfig.optionsMenu.type")&&(n=z(e,"config.headerConfig.optionsMenu.data"),H.array(n)&&n.length&&(n=z(e=n[a],"config.checked"),e&&!H.nullOrUndefined(n)&&(e.config.checked=t)))}),s}},{key:"createExpandableItem",value:function(e){var t=this,n=e.title,r=void 0===n?"":n,n=e.activeItemIndex,i=void 0===n?0:n,n=e.clickCallback,o=void 0===n?Zi:n,n=e.subMenu,a=e.optionsConfig,s=e.historyData,l=e.itemIndex,u=n.type,c=n.data,d=n.clickCallback,f=n.titleClickCallback,e=c&&H.array(c)&&c[i],e=e&&e.displayName||e&&e.label||"",h=Ee("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(r,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-has-expand">\n                    <span> ').concat(e,' </span>\n                    <i class="pl-ic-keyboard_arrow_right"></i>\n                </div>\n            </div>\n        ')},{class:"--z--zpl-menu-item"});return c.map(function(e,t){return e.checked=i===t,e}),h.data={title:r,activeItemIndex:i,subMenu:n,optionsConfig:a,itemIndex:l},h.on("click",function(e){H.function(o)&&o(e,h),H.nullOrUndefined(s)||H.empty(s)||(t.routeHistory=[].concat(Wi(t.routeHistory),[s])),u===Hi.LIST_MENU_TYPE.CHECKLIST&&(e={headerConfig:{title:r,showOptions:!!a,optionText:a&&a.label,optionsClickCallback:a&&a.clickCallback,optionsMenu:a&&a.subMenu,titleClickCallback:f},itemsList:c,clickCallback:d,itemIndex:l},t.createCheckListMenu(e,{type:Hi.LIST_MENU_TYPE.CHECKLIST,config:e}))}),h}},{key:"createCheckableItem",value:function(e){var s=this,t=e.label,n=e.disabled,l=void 0!==n&&n,r=e.checked,n=void 0!==r&&r,r=e.callback,u=void 0===r?Zi:r,c=e.itemIndex,d=Ee("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                <i class="pl-ic-done"></i>\n                <span class="txt">'.concat(void 0===t?"":t,"</span>\n            </div>\n        ")},{class:"--z--zpl-menu-item","aria-checked":n,"aria-disabled":l});return d.on("click",function(e){if(H.function(u)&&u(e,d),l)return!1;for(var t=(d.parentNode||d.parentElement).childNodes,n=t.length,r=0;r<n;r++)Se(t[r],"aria-checked",!1);Se(d,"aria-checked",!0);var i=s.routeHistory.length,o=s.routeHistory[i-1],a=z(o,"config.itemsList"),e=a&&H.array(a)&&a[c],i=z(d.data,"index");if(H.nullOrUndefined(i))throw new Error("Element must be have index property in data",d);e&&!H.nullOrUndefined(e.type)?(a=z(e,"config.activeItemIndex"),H.nullOrUndefined(a)||(e.config.activeItemIndex=i)):(o=z(o,"config.headerConfig.optionsMenu"))&&!H.nullOrUndefined(z(o,"activeItemIndex"))&&(o.activeItemIndex=i)}),d}},{key:"goBack",value:function(){var e=this.routeHistory.length;!e||(e=this.routeHistory[e-1])&&(this.createMenu(e),this.routeHistory.pop())}},{key:"createMenuHeader",value:function(e){var o=this,t=e.title,n=void 0===t?"":t,r=e.showOptions,t=void 0!==r&&r,r=e.optionText,a=void 0===r?"Options":r,r=e.titleClickCallback,i=void 0===r?Zi:r,r=e.optionsClickCallback,s=void 0===r?Zi:r,l=e.optionsMenu,u=e.historyData,c=e.itemIndex,e=Ee("div",{},{class:"--z--zpl-panel-header --z--clearfix"}),n=Ee("button",{innerHTML:'<i class="pl-ic-keyboard_arrow_left"></i> '.concat(n)},{class:"--z--panel-title"});return n.on("click",function(e){e.stopPropagation(),o.goBack(),H.function(i)&&i(e)}),e.append(n),t&&((t=Ee("div",{innerText:a},{class:"--z--zpl-options"})).on("click",function(e){e.stopPropagation();var n,t=o.routeHistory[o.routeHistory.length-1],r=t&&z(t,"config.itemsList"),t=r&&H.array(r)&&r[c];t&&(n=z(t,"config.activeItemIndex"),H.nullOrUndefined(n)||(u.config.activeItemIndex=n,z(u,"config.itemsList")&&u.config.itemsList.map(function(e,t){return e.checked=n===t,e}))),H.nullOrUndefined(u)||H.empty(u)||(o.routeHistory=[].concat(Wi(o.routeHistory),[u])),H.function(s)&&s(e);var r=l.type,t=l.data,i=l.activeItemIndex,e={headerConfig:{title:a},itemsList:t,itemIndex:c};r===Hi.LIST_MENU_TYPE.CHECKLIST?(H.number(i)&&t.map(function(e,t){return e.checked=i===t,e}),o.createCheckListMenu(e,{type:Hi.LIST_MENU_TYPE.CHECKLIST,config:e})):r===Hi.LIST_MENU_TYPE.MIXIN&&o.createMixinMenu(e,{type:Hi.LIST_MENU_TYPE.MIXIN,config:e})}),e.append(t)),e}},{key:"createMenu",value:function(e){var t=e.type,e=e.config;"checklist"===t?this.createCheckListMenu(zi({},e),{type:t,config:e}):"mixin"===t&&this.createMixinMenu(zi({},e),{type:t,config:e})}},{key:"createCheckListMenu",value:function(e,t){var n=e.headerConfig,r=e.itemsList,i=void 0===r?[]:r,r=e.clickCallback,o=void 0===r?Zi:r,a=e.itemIndex;this.panelEl.innerHTML="",n&&(s=this.createMenuHeader(zi({},n,{historyData:t,itemIndex:a})),this.panelEl.append(s));for(var s=Ee("div",{},{class:"--z--panel-scroll-wrapper"}),l=Ee("div",{},{class:"--z--zpl-panel-menu"}),u=i.length,c=0;c<u;c++){var d=i[c];if(!H.object(d)||!d.label)return;var f=this.createCheckableItem({label:d.displayName||d.label,checked:!!d.checked,disabled:!!d.disabled,callback:o,itemIndex:a});f.data=d,l.append(f)}s.append(l),this.panelEl.append(s)}},{key:"createMixinMenu",value:function(e,t){var n=e.headerConfig,e=e.itemsList,r=void 0===e?[]:e;this.panelEl.innerHTML="",n&&(i=this.createMenuHeader(n),this.panelEl.append(i));for(var i=Ee("div",{},{class:"--z--panel-scroll-wrapper"}),o=Ee("div",{},{class:"--z--zpl-panel-inner"}),a=r.length,s=0;s<a;s++){var l=r[s],u=l.type,c=l.config,d=l.callback,f=l.optionsConfig,l=null;u===Hi.MENU_TYPE.TOGGLE?l=this.createToggleItem(zi({},c,{itemIndex:s})):u===Hi.MENU_TYPE.EXPAND&&(l=this.createExpandableItem(zi({},c,{optionsConfig:f,historyData:t,itemIndex:s}))),H.function(d)&&d(l),l&&o.append(l)}i.append(o),this.panelEl.append(i)}},{key:"toggleVisibleMenu",value:function(){de(this.el,"--z--show"),this.player.isMenuOpen=!this.player.isMenuOpen}},{key:"hideMenu",value:function(){ce(this.el,"--z--show"),this.player.isMenuOpen=!1}},{key:"render",value:function(){this.panelEl=Ee("div",{},{class:"--z--zpl-panel"}),this.el.append(this.panelEl),this.player.el.append(this.el)}}]),to);function to(){!function(e){if(!(e instanceof to))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r=this;var r=!(i=(i=qi(to)).call.apply(i,[this].concat(t)))||"object"!==$i(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i,i=t[2];return r.render(),r.parent=i,r.controls=r.parent.controls,r.settingsMenuItems={},r.routeHistory=[],r}function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ro(e,t,n){return(ro="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=io(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ao(e,t,n){return t&&oo(e.prototype,t),n&&oo(e,n),e}function so(e,t){return(so=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uo(e){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function co(e){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ho(e,t,n){return t&&fo(e.prototype,t),n&&fo(e,n),e}function po(e,t){return(po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yo(e){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mo(e,t,n){return(mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vo(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function vo(e){return(vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bo(e,t){return(bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _o={playpause:ie,seekbar:Nt,time:Je,volume:m,fullscreen:y,settings:(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&so(e,t)}(So,Mn(En,Ln)),ao(So,[{key:"name",get:function(){return"SettingsControl"}},{key:"className",get:function(){return"--z--control --z--control-settings"}}]),ao(So,[{key:"toggleVisibleSettingsMenu",value:function(){this.settingsMenu.toggleVisibleMenu()}},{key:"hideSettingsMenu",value:function(){this.settingsMenu.hideMenu()}},{key:"render",value:function(){return this.el.append(this.settingsButton.render().el),this}},{key:"remove",value:function(){[this.settingsButton,this.settingsMenu].forEach(function(e){e.remove()}),ro(io(So.prototype),"remove",this).call(this)}}]),So),theatermode:(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&po(e,t)}(Ao,Mn(Ze,Ln)),ho(Ao,[{key:"name",get:function(){return"TheaterModeControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-theater-mode"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_THEATER_MODE_CHANGE,handler:this._onTheaterModeChange}]}}]),ho(Ao,[{key:"toggleIcon",value:function(e){de(this.iconEl,"pl-ic-theater",e),de(this.iconEl,"pl-ic-theater-mini",!e),this.setButtonTooltip(e)}},{key:"handleClick",value:function(){this.player.toggleTheaterMode()}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,n=t?t.on:"Chế độ rạp chiếu",t=t?t.off:"Thoát chế độ rạp chiếu";this.setAttribute("title",e?t:n)}},{key:"render",value:function(){var e=this.options.theaterMode;return this.iconEl=Ee("span",{},{class:"--z--icon ".concat(e?"pl-ic-theater":"pl-ic-theater-mini")}),this.setButtonTooltip(e),this.el.append(this.iconEl),this}},{key:"_onTheaterModeChange",value:function(e){this.toggleIcon(e)}}]),Ao)},Eo=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),bo(e,t)}(ko,Ve),Ze=[{key:"NAME_EVENTS",get:function(){return[{name:O.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:O.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:O.PLAYER_PLAY,handler:this.onPlay},{name:O.PLAYER_PAUSE,handler:this.onPause}]}}],go((Ln=ko).prototype,[{key:"setUp",value:function(){this.draggingVolumeBar=!1,this.draggingSeekBar=!1,this.autoHideDisabled=!1,this.setting=X({},this.pluginOptions),this.setting.layout=z(this.pluginOptions,"layout"),this.controls=[],this.leftElement=null,this.rightElement=null,this.pluginOptions.disabled||this.onMouseMove()}},{key:"setupTheme",value:function(){var t=this,e=this.setting,n=e.type,r=e.theme;if(n.fullWidth){ue(this.innerEl,cn),ue(this.el,cn);e=n.fullWidth;switch(e.backgoundType){case hn:ue(this.innerEl,dn);break;case pn:ue(this.innerEl,dn),ue(this.el,dn)}n=e.paddingTop;H.number(n)&&0<=n&&he(this.innerEl,{paddingTop:-1<String(n).indexOf("px")?n:"".concat(n,"px")}),he(this.innerEl,{backgroundImage:e.backgroundImage,backgroundColor:e.backgroundColor}),this.setting.hideAnimation&&(this.hideClass="--z--fadeout")}r&&-1<Q(yn).indexOf(r)&&i(23)("./".concat(r,".scss")).then(function(e){e=Ee("style",{innerHTML:e.default});t.innerEl.append(e)})}},{key:"onClicked",value:function(e){e.stopPropagation(),this.player.trigger(O.PLAYER_MEDIACONTROL_CLICK)}},{key:"onDblClicked",value:function(e){e.stopPropagation(),this.player.trigger(O.PLAYER_MEDIACONTROL_DBLCLICK)}},{key:"onMouseLeave",value:function(){this.autoHideDisabled||this.setting.alwaysShowControl||(clearTimeout(this.hideTimeout),this.hide())}},{key:"onMouseMove",value:function(){var e=this;this.autoHideDisabled||(clearTimeout(this.hideTimeout),this.show(),this.setting.alwaysShowControl||(this.hideTimeout=setTimeout(function(){return e.onMouseLeave()},3e3)))}},{key:"onPlay",value:function(){this.enableAutoHide()}},{key:"onPause",value:function(){this.onMouseLeave(),yt&&!this.setting.showOnPauseMobile||this.disableAutoHide()}},{key:"disableAutoHide",value:function(){this.autoHideDisabled=!0,clearTimeout(this.hideTimeout),this.show()}},{key:"enableAutoHide",value:function(){this.player.isPlaying()&&(this.autoHideDisabled=!1,this.onMouseMove())}},{key:"disable",value:function(){mo(vo(ko.prototype),"disable",this).call(this),this.player.disableMediaControl()}},{key:"enable",value:function(){mo(vo(ko.prototype),"enable",this).call(this),this.player.enableMediaControl()}},{key:"show",value:function(){_.debug(this.name,"show"),ce(this.el,this.hideClass),this.player.showMediaControl()}},{key:"hide",value:function(){this.hideClass||(this.hideClass="--z--hide"),_.debug(this.name,"hide",this.hideClass),ue(this.el,this.hideClass),this.player.hideMediaControl()}},{key:"destroy",value:function(){mo(vo(ko.prototype),"destroy",this).call(this),this.controls.forEach(function(e){return e.remove()}),this.remove()}},{key:"getControl",value:function(t){return this.controls&&this.controls.filter(function(e){return e.name===t})[0]}},{key:"renderControl",value:function(e,t){!t||(t=_o[t])&&(t=new t(this.player,this),e.append(t.render().el),this.controls.push(t))}},{key:"render",value:function(){var e=this;if(!this.controls)return this;if(mo(vo(ko.prototype),"render",this).call(this),this.leftElement=Ee("div",{},{class:"--z--control-left"}),this.rightElement=Ee("div",{},{class:"--z--control-right"}),this.innerEl=Ee("div",{},{class:"--z--controls"}),this.setting.layout.left&&this.setting.layout.left.length||ue(this.rightElement,"--z--only-right-control"),this.setting.layout.default){var t=!0,n=!1,r=void 0;try{for(var i,o=this.setting.layout.default[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.renderControl(this.innerEl,a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}if(this.setting.layout.left){var s=!0,l=!1,u=void 0;try{for(var c,d=this.setting.layout.left[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;this.renderControl(this.leftElement,f)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}if(this.setting.layout.right){var h=!0,l=!1,u=void 0;try{for(var p,y=this.setting.layout.right[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var g=p.value;this.renderControl(this.rightElement,g)}}catch(e){l=!0,u=e}finally{try{h||null==y.return||y.return()}finally{if(l)throw u}}}return this.setupTheme(),this.innerEl.append(this.leftElement),this.innerEl.append(this.rightElement),this.el.append(this.innerEl),this.player.$el.append(this.el),setTimeout(function(){e.player.mediaControlReady()},0),this}},{key:"name",get:function(){return"ControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--controls-wrapper"}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked"}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:O.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:O.PLAYER_PLAY,handler:this.onPlay},{name:O.PLAYER_PAUSE,handler:this.onPause}]}},{key:"defaultOptions",get:function(){return fn}}]),go(Ln,Ze),ko);function ko(){return function(e){if(!(e instanceof ko))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=vo(ko).apply(this,arguments))||"object"!==yo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Ao(){!function(e){if(!(e instanceof Ao))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r=this;var r=!(i=(i=co(Ao)).call.apply(i,[this].concat(t)))||"object"!==uo(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):i,i=t[0];return r.config=X({},fn,z(i.options,"controls.theaterMode")||{}),r}function So(){!function(e){if(!(e instanceof So))throw new TypeError("Cannot call a class as a function")}(this);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!(o=(i=io(So)).call.apply(i,[this].concat(t)))||"object"!==no(o)&&"function"!=typeof o?lo(this):o,i=t[0],o=t[1];return r.settingsButton=new Vi(i,lo(lo(r))),r.settingsMenu=new eo(i,o,lo(lo(r))),r}function wo(e){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oo(e,t){return(Oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(24);var Lo={poster:"//zjs.zadn.vn/zplayer/images/poster_default.jpg"},Ro=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Oo(e,t)}(Co,Ve),To(Co.prototype,[{key:"_onPlayerPlayIntent",value:function(){this.hide()}},{key:"_onPlayerEnded",value:function(){this.player.options.customIosFullscreen||this.show()}},{key:"handleClick",value:function(){return this.player.play(),!1}},{key:"getPosterUrl",value:function(){return this.options.poster||this.pluginOptions.poster}},{key:"render",value:function(){var e=this.getPosterUrl(),t=Ee("div",{},{class:"--z--poster-controls --z--play-wrapper --z--active"});return this.el.setAttribute("style","background-image : url(".concat(e,");")),H.empty(this.pluginOptions.styles)||he(this.el,this.pluginOptions.styles),this.$el.append(t),this.player.$el.append(this.el),this}},{key:"name",get:function(){return"PosterPlugin"}},{key:"attributes",get:function(){return{class:"--z--player-poster"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"defaultOptions",get:function(){return Lo}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:O.PLAYER_ENDED,handler:this._onPlayerEnded}]}}]),Co);function Co(){return function(e){if(!(e instanceof Co))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Po(Co).apply(this,arguments))||"object"!==wo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Do(e){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Io(e,t,n){return(Io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mo(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Mo(e){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jo(e,t){return(jo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(25);var Fo={showLabel:!1},No=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),jo(e,t)}(Uo,Ve),xo(Uo.prototype,[{key:"setUp",value:function(){Io(Mo(Uo.prototype),"setUp",this).call(this),this.bufferingPercent=1,this.shouldUpdate=!0}},{key:"onBuffering",value:function(){this.shouldUpdate=!0,this.show()}},{key:"onBufferingChange",value:function(e){H.number(e)&&((e=Math.floor(e))<1?e=1:99<e&&(e=99),this.bufferingPercent=e,this.update())}},{key:"onBufferFull",value:function(){_.debug(this.name,"onBufferFull"),this.bufferingPercent=1,this.update(),this.hide(),this.shouldUpdate=!1}},{key:"onStop",value:function(){_.debug(this.name,"onStop"),this.bufferingPercent=1,this.hide()}},{key:"show",value:function(){var e=this;null===this.showTimeout&&(this.showTimeout=setTimeout(function(){return e.$el.show()},300))}},{key:"hide",value:function(){null!==this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.$el.hide()}},{key:"update",value:function(){this.shouldUpdate&&this.pieWrapperEl&&(fe(this.pieWrapperEl,"--z--pie-wrapper --z--progress-".concat(this.bufferingPercent)),this.labelEl&&_e(this.labelEl,"".concat(this.bufferingPercent,"%")))}},{key:"render",value:function(){return this.pieEl=Ee("div",{},{class:"--z--pie-progress-size"}),this.pieWrapperEl=Ee("div",{innerHTML:'\n                <div class="--z--pie">\n                    <div class="--z--left-side --z--half-circle"></div>\n                    <div class="--z--right-side --z--half-circle"></div>\n                </div>\n                <div class="--z--shadow"></div>\n                '},{class:"--z--pie-wrapper"}),this.pluginOptions.showLabel&&(this.labelEl=Ee("div",{innerHTML:"".concat(this.bufferingPercent,"%")},{class:"--z--label"}),this.pieWrapperEl.prepend(this.labelEl)),this.pieEl.append(this.pieWrapperEl),this.$el.append(this.pieEl),this.player.$el.append(this.$el),this.$el.hide(),this.player.buffering&&this.onBuffering(),this}},{key:"_onPlayerPlayIntent",value:function(){this.player.buffering&&this.show()}},{key:"name",get:function(){return"LoadingSpinnerPlugin"}},{key:"attributes",get:function(){return{class:"--z--loading-wrapper"}}},{key:"defaultOptions",get:function(){return Fo}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:O.PLAYER_BUFFERING,handler:this.onBuffering},{name:O.PLAYER_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:O.PLAYER_BUFFERFULL,handler:this.onBufferFull},{name:O.PLAYER_STOP,handler:this.onStop},{name:O.PLAYER_ENDED,handler:this.onStop},{name:O.PLAYER_ERROR,handler:this.onStop}]}}]),Uo);function Uo(){return function(e){if(!(e instanceof Uo))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Mo(Uo).apply(this,arguments))||"object"!==Do(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Bo(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e&&e.toString().replace(/{(\d+)}/g,function(e,t){return n[t].toString()})}function Yo(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function Go(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}function Vo(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Ho(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return String.prototype.startsWith?e.startsWith(t,n):(n=!n||n<0?0:+n,e.indexOf(t)===n)}function Ko(e,t,n){return String.prototype.endsWith?e.endsWith(t,n):((void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t)}function $o(e){return"".concat(e,"-").concat(Math.floor(1e4*Math.random()))}function zo(e,t){return 0===e||0===t||Number.isNaN(e)||Number.isNaN(t)?0:(e/t*100).toFixed(2)}function Wo(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";return e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"),n.toString())}function qo(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function Xo(){var e=Wo(e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").toString(),"-"," ");return e=Wo(e,"_"," "),Wo(e=qo(e)," ","")}function Qo(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").toString();return(e=Xo(e)).charAt(0).toLowerCase()+e.slice(1)}function Jo(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}function Zo(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ea(ta.prototype,[{key:"getItem",value:function(e){return this.data[e]}},{key:"setItem",value:function(e,t){this.data[e]=String(t)}},{key:"removeItem",value:function(e){delete this.data[e]}}]),Ln=ta;function ta(){!function(e){if(!(e instanceof ta))throw new TypeError("Cannot call a class as a function")}(this),this.data=[]}function na(){try{return"localStorage"in window&&(window.localStorage.setItem("__test__","__test__"),window.localStorage.removeItem("__test__"),!0)}catch(e){return!1}}var ra=na()?window.localStorage:new Ln;function ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oa=(Ze=[{key:"supported",value:na}],ia((Ln=aa).prototype,[{key:"get",value:function(e){var t=ra.getItem(this.key);if(H.empty(t))return{};t=JSON.parse(t);return H.string(e)&&e.length?t[e]:t}},{key:"set",value:function(e){var t;H.object(e)&&(t=this.get(),X(t=H.empty(t)?{}:t,e),ra.setItem(this.key,JSON.stringify(t)))}},{key:"clean",value:function(){ra.removeItem(this.key)}}]),ia(Ln,Ze),aa);function aa(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"zplayer";!function(e){if(!(e instanceof aa))throw new TypeError("Cannot call a class as a function")}(this),this.key=e}function sa(e){return(sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ua(e){return(ua=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(e,t){return(ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var da="zplayer-trk",fa=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),ca(e,t)}(ha,Ve),la(ha.prototype,[{key:"setUp",value:function(){this.options.sources!=[{source:"",mimeType:""}]&&(this._isFirstLoad=!0,this._isBuffering=!0,this._trackingApi=this.pluginOptions.trackingApi,this._storage=new oa($o(da)),this._reset(),this._sendLastReports())}},{key:"_now",value:function(){return Date.now()}},{key:"_onPlayIntent",value:function(){this._timeOnStartLoad=this._now(),this._start("startup"),this._startMonitoring()}},{key:"_onBitrate",value:function(e){var t=parseInt(e.label),n=this._now(),e=this._metrics.extra.bitratesHistory.length;0<e&&((e=this._metrics.extra.bitratesHistory[e-1]).end=n,e.time=n-e.start),this._metrics.extra.bitratesHistory.push({start:this._now(),bitrate:t}),this._inc("changeLevel")}},{key:"_onFirstPlaying",value:function(){this.listenTo(this.player,O.PLAYER_TIMEUPDATE,this._onContainerUpdateWhilePlaying),this.listenEvents.push({name:O.PLAYER_TIMEUPDATE,handler:this._onContainerUpdateWhilePlaying}),this._start("watch"),this._stop("startup")}},{key:"_onContainerUpdateWhilePlaying",value:function(){this.player.isPlaying()&&(this._stop("watch"),this._start("watch"))}},{key:"_onCanPlayThrough",value:function(e){this.player.isPlaying()&&(e=e.time,this._isFirstLoad?(this._isFirstLoad=!1,this._timeOnCanPlayFirstLoad=e):(this._timeOnCanPlayThrough=e,this._trackLatencyHistory(this._isBuffering)))}},{key:"_trackLatencyHistory",value:function(e){e&&(this._isSeeking?(this._seekLatencyHistory.push(this._timeOnCanPlayThrough-this._timeOnSeeking),this._isSeeking=!1):this._isWaiting&&(e=this._timeOnCanPlayThrough-this._timeOnWaiting,this._metrics.timers.playLatency+=e,this._isWaiting=!1))}},{key:"_onSeeking",value:function(e){this._isSeeking=!0,this._timeOnSeeking=e.time}},{key:"_onWaiting",value:function(e){this._isSeeking||(this._isWaiting=!0,this._timeOnWaiting=e.time)}},{key:"_onPlayerEnded",value:function(){this._sendReportThenReset(),this.stopListening(),this.bindEvents()}},{key:"_onPlayerError",value:function(e){this._metrics.extra.errorDetail.push("code: ".concat(e.code,", description: ").concat(e.description)),this._inc("error"),this._sendReportThenReset()}},{key:"_startMonitoring",value:function(){var e=this;this._intervalId=setInterval(function(){e._buildReport(),e._sendLastReports()},5e3),this._buildReport(),_.info(this.name,"started monitoring")}},{key:"_stopMonitoring",value:function(){clearInterval(this._intervalId),_.info(this.name,"stopped monitoring")}},{key:"_sendReportThenReset",value:function(){this._stopMonitoring(),this._buildReport(),this._sendReport(this._storage.get()),this._reset()}},{key:"_reset",value:function(){this._isFirstLoad=!0,this._seekLatencyHistory=[],this._newMetrics(),this._storage.clean()}},{key:"_sendLastReports",value:function(){var r=this;Object.keys(ra).filter(pa).forEach(function(e){var t,n=JSON.parse(ra.getItem(e));r._storage.key===e||(t=n)&&Date.now()-t._updatedAt<5e3||(r._sendReport(n),ra.removeItem(e),_.debug(r.name,"sent report:",e))})}},{key:"_saveMetrics",value:function(){var e={_updatedAt:this._now(),userAgent:navigator.userAgent,fromUrl:window.location.href,params:JSON.stringify(this._metrics)};this._storage.set(e)}},{key:"_sendReport",value:function(t){_.debug(this.name,"sending report:",t),this._trackingApi.forEach(function(e){(new Image).src=e+"?userAgent="+encodeURIComponent(t.userAgent)+"&fromUrl="+encodeURIComponent(t.fromUrl)+"&params="+encodeURIComponent(t.params)})}},{key:"onPlay",value:function(){this._inc("play")}},{key:"onPause",value:function(){this._stop("watch"),this._start("pause"),this._inc("pause"),this.listenToOnce(this.player,O.PLAYER_PLAY,this.playAfterPause)}},{key:"playAfterPause",value:function(){this._stop("pause"),this._start("watch")}},{key:"onSeek",value:function(e){this._inc("seek"),this._metrics.extra.watchHistory.push([1e3*e,1e3*e])}},{key:"onFullScreen",value:function(){this._inc("fullscreen")}},{key:"onProgress",value:function(e){this._metrics.extra.buffersize=1e3*e.current}},{key:"onTimeUpdate",value:function(e){var t=1e3*e.current,n=1e3*e.total,e=this._metrics.extra.watchHistory.length;this._metrics.extra.duration=n,this._metrics.extra.currentTime=t,0===e?this._metrics.extra.watchHistory.push([t,t]):this._metrics.extra.watchHistory[e-1][1]=t}},{key:"onBuffering",value:function(){this._isBuffering=!0,this._inc("buffering"),this._start("buffering"),this.listenToOnce(this.player,O.PLAYER_BUFFERFULL,this.onBufferfull)}},{key:"onBufferfull",value:function(){this._isBuffering=!1,this._stop("buffering"),this.listenToOnce(this.player,O.PLAYER_BUFFERING,this.onBuffering)}},{key:"_inc",value:function(e){this._metrics.counters[e]+=1}},{key:"_timerHasStarted",value:function(e){return void 0!==this["_start".concat(e)]}},{key:"_start",value:function(e){this["_start".concat(e)]=this._now()}},{key:"_stop",value:function(e){this._metrics.timers[e]+=this._now()-this["_start".concat(e)]}},{key:"_fetchFPS",value:function(){var e={html5_video:this._html5FetchFPS,hls:this._html5FetchFPS};e[this._playbackName]&&e[this._playbackName].call(this)}},{key:"_calculateBitrates",value:function(){var t=this,e=this._metrics.extra.bitratesHistory.map(function(e){return e.bitrate});this._metrics.extra.bitrateMean=e.reduce(function(e,t){return e+t},0)/e.length,this._metrics.extra.bitrateVariance=e.map(function(e){return Math.pow(e-t._metrics.extra.bitrateMean,2)}).reduce(function(e,t){return e+t},0)/e.length,this._metrics.extra.bitrateStandardDeviation=Math.sqrt(this._metrics.extra.bitrateVariance),this._metrics.extra.bitrateMostUsed=this._metrics.extra.bitratesHistory.sort(function(e,t){return e.time<t.time})[0]}},{key:"_calculatePercentages",value:function(){0<this._metrics.extra.duration&&(this._metrics.extra.watchedPercentage=this._metrics.timers.watch/this._metrics.extra.duration*100,this._metrics.extra.bufferingPercentage=this._metrics.timers.buffering/this._metrics.extra.duration*100)}},{key:"_calculateStartLatency",value:function(){!this._timeOnCanPlayFirstLoad||this._timeOnCanPlayFirstLoad<=0||(this._metrics.timers.startLatency=this._timeOnCanPlayFirstLoad-this._timeOnStartLoad)}},{key:"_calculateSeekLatency",value:function(){this._metrics.timers.seekLatency=jt(this._seekLatencyHistory)}},{key:"_newMetrics",value:function(){var t=this;this._metrics={counters:{play:0,pause:0,error:0,buffering:0,decodedFrames:0,droppedFrames:0,fps:0,changeLevel:0,seek:0,fullscreen:0,dvrUsage:0},timers:{startup:0,watch:0,pause:0,buffering:0,session:0,startLatency:0,seekLatency:0,playLatency:0,getSourceLatency:0},extra:{product:"",level:"",playbackName:"",playbackType:"",playbackRedirector:"",playbackSrc:"",mimeType:"",platform:yt?"webm":"webd",zdnServer:"",bitratesHistory:[],bitrateMean:0,bitrateVariance:0,bitrateStandardDeviation:0,bitrateMostUsed:0,buffersize:0,errorDetail:[],watchHistory:[],watchedPercentage:0,bufferingPercentage:0,isOnline:!0}},window.ZA&&H.function(window.ZA.getVisitorID)&&window.ZA.getVisitorID(function(e){_.debug(t.name,"ZA visitor ID:",e),t._metrics.extra.visitorId=e})}},{key:"_buildReport",value:function(){this._stop("session"),this._start("session"),this._metrics.extra.playbackName=this._playbackName,this._metrics.extra.playbackType=this._playbackType,this._metrics.extra.product=this.options.product,this._calculateBitrates(),this._calculatePercentages(),this._fetchFPS(),this._calculateStartLatency(),this._calculateSeekLatency(),this._metrics.extra.playbackSrc=this.player.isHlsPlayback()?this.player.options.source:this.player.playback.el.src,this._metrics.extra.mimeType=this.player.options.mimeType,this._saveMetrics()}},{key:"_html5FetchFPS",value:function(){var e=this.player.playback.el,t=e.webkitDecodedFrameCount||e.mozDecodedFrames||0,n=e.webkitDroppedFrameCount||e.mozParsedFrames-e.mozDecodedFrames||0,e=t-(this._lastDecodedFramesCount||0);this._metrics.counters.decodedFrames=t,this._metrics.counters.droppedFrames=n,this._metrics.counters.fps=e/5,this._lastDecodedFramesCount=t}},{key:"name",get:function(){return"StatsPlugin"}},{key:"defaultOptions",get:function(){return{trackingApi:["https://zplayer-trk.zdn.vn/track"]}}},{key:"_playbackName",get:function(){return this.player.playback.name}},{key:"_playbackType",get:function(){return this.player.getPlaybackType()}},{key:"listenEvents",get:function(){return[{once:!0,name:O.PLAYER_PLAY_INTENT,handler:this._onPlayIntent},{once:!0,name:O.PLAYER_PLAY,handler:this._onFirstPlaying},{name:O.PLAYER_QUALITY_LEVELS_SELECTED,handler:this._onBitrate},{name:O.PLAYER_CANPLAYTHROUGH,handler:this._onCanPlayThrough},{name:O.PLAYER_PLAY,handler:this.onPlay},{name:O.PLAYER_PAUSE,handler:this.onPause},{once:!0,name:O.PLAYER_ERROR,handler:this._onPlayerError},{name:O.PLAYER_ENDED,handler:this._onPlayerEnded},{name:O.PLAYER_SEEKING,handler:this._onSeeking},{name:O.PLAYER_SEEK,handler:this.onSeek},{name:O.PLAYER_WAITING,handler:this._onWaiting},{name:O.PLAYER_FULLSCREEN,handler:this.onFullScreen},{name:O.PLAYER_PROGRESS,handler:this.onProgress},{name:O.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{once:!0,name:O.PLAYER_BUFFERING,handler:this.onBuffering},{once:!0,name:O.PLAYER_BUFFERFULL,handler:this.onBufferfull}]}}]),ha);function ha(){return function(e){if(!(e instanceof ha))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=ua(ha).apply(this,arguments))||"object"!==sa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function pa(e){return e&&0===e.indexOf(da)}function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function va(e,t){return(va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(26);var ba=["PosterPlugin","LoadingSpinnerPlugin","BigPlayButtonPlugin","ClickToPausePlugin","PauseAdPlugin","PlayPauseFaceoutPlugin","HotKeysPlugin"],_a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),va(e,t)}(Ea,Ve),ga(Ea.prototype,[{key:"setUp",value:function(){var t=this;if(this.defaultOptions.disabled)return this.disable();this.shouldRender=!0,this.interferedPlugins=ba.map(function(e){return t.player.getPlugin(e)})}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var e=this;this.listenToOnce(this.player,O.PLAYER_READY,function(){return e.player.play()}),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onError",value:function(){this.err=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.player.mediaControl.disable(),this._disableInterferedPlugins(),this.render(),this.show(),this.shouldRender=!1}},{key:"_disableInterferedPlugins",value:function(){this.interferedPlugins.forEach(function(e){return e&&e.disable()})}},{key:"render",value:function(){if(this.err&&this.shouldRender){var e=Ee("div",{innerHTML:'\n            <div class="player-error-screen__title" data-error-screen>'.concat(this.pluginOptions.message,'.</div>\n            <div class="player-error-screen__code" data-error-screen>Error code: ').concat(this.err.code,"</div>\n            ")},{"data-error-screen":"",class:"player-error-screen__content"});return this.el.append(e),this.player.el.append(this.el),this.bindReload(),this}}},{key:"name",get:function(){return"ErrorScreenPlugin"}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_ERROR,handler:this.onError}]}},{key:"defaultOptions",get:function(){return{message:"Có lỗi xảy ra!"}}}]),Ea);function Ea(){return function(e){if(!(e instanceof Ea))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=ma(Ea).apply(this,arguments))||"object"!==ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function ka(e){return(ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sa(e){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e,t){return(wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ta={disableHotKeys:!1},Pa=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),wa(e,t)}(Oa,re),Aa(Oa.prototype,[{key:"playPauseKey",value:function(e){return 32===e.which||179===e.which}},{key:"rewindKey",value:function(e){return 37===e.which||177===e.which}},{key:"forwardKey",value:function(e){return 39===e.which||176===e.which}},{key:"volumeUpKey",value:function(e){return 38===e.which}},{key:"volumeDownKey",value:function(e){return 40===e.which}},{key:"muteKey",value:function(e){return 77===e.which}},{key:"fullscreenKey",value:function(e){return 70===e.which}},{key:"numberKey",value:function(e){return 47<e.which&&e.which<59||95<e.which&&e.which<106}},{key:"getNumberKey",value:function(e){var t=48;return 95<e.which&&(t=96),e.which-t}},{key:"getKey",value:function(e){return!(e.metaKey||e.ctrlKey||e.altKey)&&(this.playPauseKey(e)?1:this.volumeUpKey(e)?2:this.volumeDownKey(e)?3:this.muteKey(e)?8:this.fullscreenKey(e)?4:this.rewindKey(e)?5:this.forwardKey(e)?6:this.numberKey(e)?9:void 0)}},{key:"_onPlayerKeydown",value:function(e){if(this.player.mediaControl.disabled)return!0;var t=this.getKey(e);if(!t)return!0;e.preventDefault(),e.stopPropagation(),this.player.mediaControl.show();var n=this.player.getCurrentTime(),r=100*this.player.getVolume(),i=this.player.getDuration(),o=this.getNumberKey(e);switch(t){case 1:this.player.togglePlay();break;case 2:this.player.setVolume(5+r,!0);break;case 3:this.player.setVolume(r-5,!0);break;case 8:this.player.isMuted()?this.player.unmute(!0):this.player.mute(!0);break;case 4:this.player.toggleFullscreen();break;case 5:this.player.seek(n-5);break;case 6:this.player.seek(n+5);break;case 9:this.player.seek(i*o*.1)}}},{key:"name",get:function(){return"HotKeysPlugin"}},{key:"defaultOptions",get:function(){return Ta}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_KEYDOWN,handler:this._onPlayerKeydown}]}}]),Oa);function Oa(){return function(e){if(!(e instanceof Oa))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Sa(Oa).apply(this,arguments))||"object"!==ka(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function La(e){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ra(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Da(e,t){return(Da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xa=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Da(e,t)}(Ia,re),Ra(Ia.prototype,[{key:"setUp",value:function(){this.userInteractive=!1}},{key:"_onPlayerClickEvent",value:function(){this.player.isMenuOpen||(yt?(this.userInteractive&&this.player.togglePlay(),this.userInteractive=!0):this.player.togglePlay())}},{key:"_onHideMediaControl",value:function(){this.userInteractive=!1}},{key:"name",get:function(){return"ClickToPausePlugin"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_CLICK,handler:this._onPlayerClickEvent},{name:O.PLAYER_MEDIACONTROL_HIDE,handler:this._onHideMediaControl}]}}]),Ia);function Ia(){return function(e){if(!(e instanceof Ia))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Ca(Ia).apply(this,arguments))||"object"!==La(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Ma(e){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fa(e){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Na(e,t){return(Na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ua=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Na(e,t)}(Va,re),ja(Va.prototype,[{key:"_onDblClicked",value:function(){this.options.dblClickToFullScreen&&!yt&&this.player.toggleFullscreen()}},{key:"name",get:function(){return"DoubleClickToFullscreen"}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_DBLCLICK,handler:this._onDblClicked}]}}]),Va),Ba=i(4),Ln=i(2),Ya=i.n(Ln),Ga=function(){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("HEAD","//zjs.zadn.vn/zplayer/ads.js?ad",!0),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e():t(new Error("Ad Blocker is enabled")))},n.send()})};function Va(){return function(e){if(!(e instanceof Va))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Fa(Va).apply(this,arguments))||"object"!==Ma(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Ha(){var e=Array.prototype.slice.call(arguments);if(window.fetch)return window.fetch.apply(window,e);function r(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return e="string"!=typeof e?e.toString():e}function a(t){var n=this;this.map={},t instanceof a?t.forEach(function(t,e){e.forEach(function(e){n.append(t,e)})}):t&&Object.getOwnPropertyNames(t).forEach(function(e){n.append(e,t[e])})}function n(e){if(e.bodyUsed)return fetch.Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function o(n){return new fetch.Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function t(e){var t=new FileReader;return t.readAsArrayBuffer(e),o(t)}a.prototype.append=function(e,t){e=r(e),t=i(t);var n=this.map[e];n||(this.map[e]=n=[]),n.push(t)},a.prototype.delete=function(e){delete this.map[r(e)]},a.prototype.get=function(e){e=this.map[r(e)];return e?e[0]:null},a.prototype.getAll=function(e){return this.map[r(e)]||[]},a.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},a.prototype.set=function(e,t){this.map[r(e)]=[i(t)]},a.prototype.forEach=function(t){var n=this;Object.getOwnPropertyNames(this.map).forEach(function(e){t(e,n.map[e])})};var s="FileReader"in window&&"Blob"in window&&function(){try{return new Blob,!0}catch(e){return!1}}(),l="FormData"in window;function u(){return this.bodyUsed=!1,this._initBody=function(e){if("string"==typeof(this._bodyInit=e))this._bodyText=e;else if(s&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(l&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},s?(this.blob=function(){var e=n(this);if(e)return e;if(this._bodyBlob)return fetch.Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return fetch.Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(t)},this.text=function(){var e,t=n(this);if(t)return t;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),o(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return fetch.Promise.resolve(this._bodyText)}):this.text=function(){return n(this)||fetch.Promise.resolve(this._bodyText)},l&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(function(e){return JSON.parse(e)})},this}var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function d(e,t){var n;if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new a(t.headers),this.method=(e=(n=t.method||"GET").toUpperCase(),-1<c.indexOf(e)?e:n),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function f(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(e=(t=e.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),n.append(decodeURIComponent(e),decodeURIComponent(t)))}),n}var h=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);function p(e,t){t=t||{},this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=200<=this.status&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof a?t.headers:new a(t.headers),this.url=t.url||""}return u.call(d.prototype),u.call(p.prototype),window.Headers=a,window.Request=d,window.Response=p,window.fetch=function(e,t){var n=d.prototype.isPrototypeOf(e)&&!t?e:new d(e,t);return new fetch.Promise(function(r,i){var o=function(){return h&&!/^(get|post|head|put|delete|options)$/i.test(this.method)?(this.usingActiveXhr=!0,new window.ActiveXObject("Microsoft.XMLHTTP")):new XMLHttpRequest}.call(this);function e(){var e,t,n;4===o.readyState&&((e=1223===o.status?204:o.status)<100||599<e?i(new TypeError("Network request failed")):(e={status:e,statusText:o.statusText,headers:(t=o,n=new a,t.getAllResponseHeaders().trim().split("\n").forEach(function(e){var t=e.trim().split(":"),e=t.shift().trim(),t=t.join(":").trim();n.append(e,t)}),n),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},t="response"in o?o.response:o.responseText,r(new p(t,e))))}"cors"===n.credentials&&(o.withCredentials=!0),o.onreadystatechange=e,this.usingActiveXhr||(o.onload=e,o.onerror=function(){i(new TypeError("Network request failed"))}),o.open(n.method,n.url,!0),"responseType"in o&&s&&(o.responseType="blob"),n.headers.forEach(function(t,e){e.forEach(function(e){o.setRequestHeader(t,e)})}),o.send(void 0===n._bodyInit?null:n._bodyInit)})},fetch.Promise=window.Promise,window.fetch.polyfill=!0,window.fetch.apply(window,e)}var Ka=function(t,n){return Promise.resolve().then(Ga).then(function(){return"function"==typeof(e=t)?e():e;var e}).then($a).then(function(e){return function(e,n){var r;_.debug("AdLoader","loading ad from source:",e);var t=Ha(e,{credentials:"include"}).then(function(e){return e.json()}).then(function(e){return clearTimeout(r),e&&e.ads?e.ads.schedule:[]}),e=new Promise(function(e,t){r=setTimeout(function(){return t(new Error("Timeout reached: ".concat(n)))},n)});return Promise.race([t,e])}(e,n)})};function $a(e){if(!e)throw new Error("no ad source");return e}function za(e){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qa(e,t,n){return(qa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xa(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Xa(e){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qa(e,t){return(Qa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ja=["PosterPlugin","ClickToPausePlugin","DoubleClickToFullscreen","PauseAdPlugin","HotKeysPlugin"],Ze=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Qa(e,t)}(Za,Ve),Wa(Za.prototype,[{key:"setUp",value:function(){this.interferedPlugins=[],this.pauseContentRequested=!1,this.interferedPluginNames=Ja.slice(0),_.debug(this.name,"initializing"),this._loadSource()}},{key:"addInterferedPlugin",value:function(e){this.interferedPluginNames.push(e)}},{key:"getPluginOptions",value:function(){return X(this.defaultOptions,z(this._options,"pluginsOptions.ads")||this.defaultOptions)}},{key:"render",value:function(){qa(Xa(Za.prototype),"render",this).call(this),this.$el.hide()}},{key:"init",value:function(){throw new Error("this must be overridden")}},{key:"canHandle",value:function(e){throw new Error("this must be overridden")}},{key:"onAdsDataLoaded",value:function(e){throw new Error("this must be overridden")}},{key:"onAdWillStart",value:function(){_.info(this.name,"ad will start"),this.player.trigger(O.PLAYER_AD_WILL_START)}},{key:"onAdStarted",value:function(){_.info(this.name,"ad started"),this.player.trigger(O.PLAYER_AD_STARTED)}},{key:"onAdStopped",value:function(e){_.info(this.name,"ad stopped:",e),this.player.trigger(O.PLAYER_AD_STOPPED,{reason:e})}},{key:"onAdSkipped",value:function(){_.info(this.name,"ad skipped"),this.player.trigger(O.PLAYER_AD_SKIPPED)}},{key:"pauseForAd",value:function(){return this.pauseContentRequested?Ya.a.resolve():(_.debug(this.name,"pauseForAd"),this.pauseContentRequested=!0,this._disableMediaControl(),this._disableInterferedPlugins(),this.$el.show(),this._pausePlayback())}},{key:"resumeAfterAd",value:function(){return _.debug(this.name,"resumeAfterAd"),this.pauseContentRequested?(this.pauseContentRequested=!1,this._enableMediaControl(),this._enableInterferedPlugins(),this.$el.hide(),this._resumePlayback()):Ya.a.resolve()}},{key:"_pausePlayback",value:function(){return this.player.pause()}},{key:"_resumePlayback",value:function(){return this.player.playback.ended?Ya.a.resolve():this.player.play()}},{key:"_disableInterferedPlugins",value:function(){var t=this;this.interferedPlugins=this.interferedPluginNames.map(function(e){return(e=t.player.getPlugin(e))&&e.enabled?{enable:e.enable.bind(e),disable:e.disable.bind(e)}:{enable:function(){},disable:function(){}}}),this.interferedPlugins.forEach(function(e){return e.disable()})}},{key:"_enableInterferedPlugins",value:function(){this.interferedPlugins.forEach(function(e){return e.enable()})}},{key:"_disableMediaControl",value:function(){this.mediaControlDisabled=this.player.mediaControl.disabled,this.mediaControlDisabled||this.player.mediaControl.disable()}},{key:"_enableMediaControl",value:function(){this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"_loadSource",value:function(){var t=this,e=this.pluginOptions,n=e.source,e=e.loadTimeout;Ka(n,void 0===e?3e3:e).then(function(e){return t.onAdsDataLoaded(e)},function(e){/timeout reached/.test(e.message)&&t.player.trigger(O.PLAYER_AD_LOAD_TIMEOUT),_.error(t.name,"Cannot load ad:",e),t.onAdsDataLoaded(null)})}},{key:"name",get:function(){return"AdsBase"}},{key:"attributes",get:function(){return{class:this.name}}}]),Za);function Za(){return function(e){if(!(e instanceof Za))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Xa(Za).apply(this,arguments))||"object"!==za(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function es(e){return(es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ts(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ns(e,t,n){return(ns="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rs(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function rs(e){return(rs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function is(e,t){return(is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(27);var os=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),is(e,t)}(as,Ze),ts(as.prototype,[{key:"setUp",value:function(){_.debug(this.name,"setUp"),ns(rs(as.prototype),"setUp",this).call(this),this.metadataDeferred=gt(),this.runnerDeferred=gt(),this.runnerDeferredPromise=this.runnerDeferred.promise,this.rootPosterConfig=this.pluginOptions.poster,this._onResize=this._onResize.bind(this),window.on("resize.ads",this._onResize,!1),this.player.$el.append(this.$el),this.nonLinearAdContainer=Ee("div",{},{class:"AdsPluginNonLinear"}),this.player.$el.append(this.nonLinearAdContainer),this.runner=null}},{key:"onAdsDataLoaded",value:function(e){var t=this;this._transformAdsData(e).then(function(e){e&&e.length?t._runnerProxy(function(){t.runner.onAdsDataLoaded(e)}):(_.info(t.name,"empty ad data, destroying plugin..."),t.destroy())})}},{key:"destroy",value:function(){var e=this;ns(rs(as.prototype),"destroy",this).call(this),window.off("resize.ads",this._onResize,!1),Re(this.nonLinearAdContainer),this._runnerProxy(function(){e.runner.destroy(),e.runner=null}),_.debug(this.name,"destroyed")}},{key:"getPoster",value:function(){var e=this.player.getPlayerSize().width;if(this.pluginOptions.poster=!(e<=400)&&this.rootPosterConfig,!this.pluginOptions.poster)return Promise.resolve();e=this.player.getPlugin("PosterPlugin");return e?Promise.resolve(e.getPosterUrl()):Promise.resolve()}},{key:"getContentPlayer",value:function(){return this.player.playback.el}},{key:"getContentVolume",value:function(){return this.player.isMuted()?0:100*this.player.getVolume()}},{key:"getContentMetadata",value:function(){return this.metadataDeferred.promise}},{key:"getAdContainers",value:function(){var e=this.player.mediaControl.getControl("SeekBarControl");return{linear:this.el,nonLinear:this.nonLinearAdContainer,notification:this.player.el,adMark:e&&e.el}}},{key:"getLogger",value:function(){return _}},{key:"onAdStarted",value:function(){var e=this;ns(rs(as.prototype),"onAdStarted",this).call(this),!this.player.options.customIosFullscreen&&rt&&Ti.isFullscreen()&&(_.info(this.name,"player in fullscreen mode on iOS, skipping ad..."),this._runnerProxy(function(){e.runner.stopAd()}))}},{key:"_onUserActionEvent",value:function(){var e=this;this._runnerProxy(function(){e.runner.onUserAction()})}},{key:"_onPlaybackEnded",value:function(){var e=this;this._runnerProxy(function(){e.runner.onContentEnded()}),this.pluginOptions.replayAds&&this._loadSource()}},{key:"_onPlayerError",value:function(){this.destroy()}},{key:"_onTimeUpdate",value:function(e){var t=this;this.player.mediaControl.draggingSeekBar||this._runnerProxy(function(){t.runner.onContentProgress(e)})}},{key:"_onLoadedMetadata",value:function(e){this.player.getDuration()<this.pluginOptions.minDurationShowAd&&this.destroy(),this.metadataDeferred.resolve(e)}},{key:"_onAdPauseRequest",value:function(){this._pauseAd()}},{key:"_onAdResumeRequest",value:function(){this._resumeAd()}},{key:"_onResize",value:function(t){var n=this,r=arguments,e=this.player.getPlayerSize().width,i=this.rootPosterConfig&&400<e;this._runnerProxy(function(){var e=n.runner;H.nullOrUndefined(e)||(e.showPosterAndPlayIcon(i),"resize"===t.type?e.resize():e.resize.apply(e,r))})}},{key:"_pauseAd",value:function(){var e=this;this._runnerProxy(function(){e.runner.pauseAd()})}},{key:"_resumeAd",value:function(){var e=this;this._runnerProxy(function(){e.runner.resumeAd()})}},{key:"_transformAdsData",value:function(t){var n=this.pluginOptions.transform;return"function"!=typeof n?Promise.resolve(t):(_.debug(this.name,"transforming ad data..."),this.getContentMetadata().then(function(e){return n(t,e)}))}},{key:"_runnerProxy",value:function(e){this.runnerDeferred&&this.runnerDeferredPromise.then(e)}},{key:"_toggleMediaControls",value:function(){var t=this,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._runnerProxy(function(){var e=n?"addClass":"removeClass";t.runner.adUi.countdownToPlay[e]("has_controls_bar"),t.runner.adUi.$uiLoading[e]("has_controls_bar")})}},{key:"_onPlayerControlShow",value:function(){this._toggleMediaControls()}},{key:"_onPlayerControlHide",value:function(){this._toggleMediaControls(!1)}},{key:"_onPlayerControlReady",value:function(){this.runner||(this.runnerOptions={startTimeout:this.pluginOptions.startTimeout/1e3,skipTimeout:this.pluginOptions.skipTimeout/1e3,countdownPlay:!this.pluginOptions.noCountdownPlay,showSlideBlack:this.pluginOptions.showSlideBlack,removeAdmarkOnError:this.pluginOptions.removeAdmarkOnError,autoPlayAdBreaks:this.pluginOptions.autoPlayAdBreaks,autoPlay:!!this.player.options.autoPlay,mute:!!this.player.options.mute},this.runner=new Ba.Runner(this,this.runnerOptions),this.runnerDeferred.resolve())}},{key:"_onPlayerFullscreen",value:function(){this._onResize("resize")}},{key:"name",get:function(){return"AdsPlugin"}},{key:"defaultOptions",get:function(){return{replayAds:!1,showSlideBlack:!0,removeAdmarkOnError:!0,startTimeout:1e4,skipTimeout:3e3,autoPlayAdBreaks:!0,minDurationShowAd:5}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_PLAY_INTENT,handler:this._onUserActionEvent},{name:O.PLAYER_TIMEUPDATE,handler:this._onTimeUpdate},{once:!0,name:O.PLAYER_LOADEDMETADATA,handler:this._onLoadedMetadata},{once:!this.pluginOptions.replayAds,name:O.PLAYER_ENDED,handler:this._onPlaybackEnded},{name:O.PLAYER_ERROR,handler:this._onPlayerError},{name:O.PLAYER_AD_PAUSE_REQUEST,handler:this._onAdPauseRequest},{name:O.PLAYER_AD_RESUME_REQUEST,handler:this._onAdResumeRequest},{name:O.PLAYER_UPDATE_SIZE,handler:this._onResize},{name:O.PLAYER_MEDIACONTROL_SHOW,handler:this._onPlayerControlShow},{name:O.PLAYER_MEDIACONTROL_HIDE,handler:this._onPlayerControlHide},{once:!0,name:O.PLAYER_MEDIACONTROL_READY,handler:this._onPlayerControlReady},{name:O.PLAYER_FULLSCREEN,handler:this._onPlayerFullscreen}]}}]),as);function as(){return function(e){if(!(e instanceof as))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=rs(as).apply(this,arguments))||"object"!==es(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function ss(e){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function us(e){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cs(e,t){return(cs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(28);var ds=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),cs(e,t)}(fs,Ve),ls(fs.prototype,[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"handleClick",value:function(e){return e.stopPropagation(),this.player.play(),this.player.el.focus(),!1}},{key:"_onPlayerPlay",value:function(){this.hide()}},{key:"_onPlayerPause",value:function(){this.pluginOptions.showOnPauseMobile&&this.show()}},{key:"render",value:function(){var e=Ee("span",{},{class:"--z--icon pl-ic-play_arrow"});return he(e,this.pluginOptions.iconStyles),he(this.el,this.pluginOptions.buttonStyles),this.setAttribute("title","Phát"),this.el.append(e),this.player.el.append(this.el),this}},{key:"name",get:function(){return"BigPlayButtonPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--big-play-button"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_PLAY,handler:this._onPlayerPlay},{name:O.PLAYER_PLAY_INTENT,handler:this._onPlayerPlay},{name:O.PLAYER_PAUSE,handler:this._onPlayerPause}]}},{key:"defaultOptions",get:function(){return{showOnPauseMobile:!0}}}]),fs);function fs(){return function(e){if(!(e instanceof fs))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=us(fs).apply(this,arguments))||"object"!==ss(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function hs(e){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ys(e){return(ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gs(e,t){return(gs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(29);var ms=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),gs(e,t)}(_s,Ve),ps(_s.prototype,[{key:"setUp",value:function(){this.pluginOptions.disabled||yt?this.disable():(this.bigPlayButtonPlugin=this.player.getPlugin("BigPlayButtonPlugin"),this.isPlaying=!this.player.isPlaying(),this.mediaControlDisabled=this.player.mediaControl.disabled,this.bigPlayButtonEnabled=this.bigPlayButtonPlugin.enabled)}},{key:"_disableInterferedPlugins",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.disable()}},{key:"_onPlayerPlayIntent",value:function(){this._disableInterferedPlugins()}},{key:"_onPlayerClick",value:function(){this.player.isMenuOpen||this._togglePlayPause()}},{key:"_togglePlayPause",value:function(){var e=this;this.isPlaying=!this.isPlaying,he(this.el,{display:"flex"}),setTimeout(function(){he(e.el,{display:"none"})},500),de(this.iconEl,"pl-ic-play_arrow",this.isPlaying),de(this.iconEl,"pl-ic-pause",!this.isPlaying)}},{key:"_onPlayerEnded",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.enable(),this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"render",value:function(){return this.iconEl=Ee("span",{},{class:"--z--icon pl-ic-play_arrow"}),he(this.iconEl,this.pluginOptions.iconStyles),he(this.el,this.pluginOptions.buttonStyles),this.el.append(this.iconEl),this.player.el.append(this.el),this}},{key:"name",get:function(){return"PlayPauseFaceoutPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--playpause-fadeout"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_CLICK,handler:this._onPlayerClick},{name:O.PLAYER_ENDED,handler:this._onPlayerEnded},{name:O.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent}]}}]),_s),vs=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),bs=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});function _s(){return function(e){if(!(e instanceof _s))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=ys(_s).apply(this,arguments))||"object"!==hs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Es(e){return Object.assign({muted:!1,timeout:250,inline:!1},e)}function ks(e,t){var r,n=e.muted,i=e.timeout,e=e.inline,t=t(),o=t.element,t=t.source,a=void 0,s=void 0;return!0===(o.muted=n)&&o.setAttribute("muted","muted"),!0===e&&o.setAttribute("playsinline","playsinline"),o.src=t,new Promise(function(n){a=o.play(),r=setTimeout(function(){s(!1,new Error("Timeout "+i+" ms has been reached"))},i),s=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(r),n({result:e,error:t})},void 0!==a?a.then(function(){return s(!0)}).catch(function(e){return s(!1,e)}):s(!0)})}var As={audio:function(e){return ks(e=Es(e),function(){return{element:document.createElement("audio"),source:URL.createObjectURL(vs)}})},video:function(e){return ks(e=Es(e),function(){return{element:document.createElement("video"),source:URL.createObjectURL(bs)}})}};function Ss(e){return(Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ts(e,t,n){return(Ts="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ps(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Ps(e){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Os(e,t){return(Os=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(30);var Ls=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Os(e,t)}(Rs,je),ws(Rs.prototype,[{key:"render",value:function(){return Ts(Ps(Rs.prototype),"render",this).call(this),this.el.innerHTML='<button class="--z--btn-unmute" title=\''.concat(this.pluginOptions.boxUnmute.message,'\'>\n                                <i class="--z--icon pl-ic-volume_off"></i>\n                            </button>\n                            <span>').concat(this.pluginOptions.boxUnmute.message,"</span>"),this.player.el.append(this.el),this}},{key:"handleClick",value:function(e){e.stopPropagation(),this.player.unmute(),this.remove()}},{key:"_update",value:function(){this.player.isMuted()||this.remove()}},{key:"attributes",get:function(){return{class:"--z--unmute-box"}}},{key:"listenEvents",get:function(){return[{name:O.PLAYER_VOLUMEUPDATE,handler:this._update}]}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}}]),Rs);function Rs(e,t){var n;return function(e){if(!(e instanceof Rs))throw new TypeError("Cannot call a class as a function")}(this),n=this,(e=!(e=Ps(Rs).call(this,e))||"object"!==Ss(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n):e).pluginOptions=t,e.render(),e.bindEvents(),e}function Cs(e){return(Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xs(e,t,n){return(xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Is(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function Is(e){return(Is=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ms(e,t){return(Ms=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var js=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Ms(e,t)}(Fs,re),Ln=[{key:"NAME_EVENTS",get:function(){return["PLUGIN_AUTOPLAY_MUTE"]}}],Ds((Ze=Fs).prototype,[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"setUp",value:function(){var n=this;if(this.options.autoPlay){var t="";switch(this.player.getPlaybackType()){case Xe.VOD:t="video";break;case Xe.AOD:t="audio"}t&&As[t]({timeout:this.pluginOptions.timeout}).then(function(e){e.result?n.player.play():(n.player.mute(),As[t]({timeout:n.pluginOptions.timeout,muted:!0}).then(function(e){var t=e.result,e=e.error;t?(_.info(n.name,"autoplay muted"),n.player.play(),n.trigger(n._nameEvents.PLUGIN_AUTOPLAY_MUTE),n.pluginOptions.showBoxUnmute&&(n.boxUnmute=new Ls(n.player,n.pluginOptions))):(_.warn(n.name,"autoplay failed: ",e),n.player.unmute())}).catch(function(){n.player.unmute()}))}),this.player.getPlayerControl("SettingsControl")&&this.pluginOptions.showInSettingsMenu&&(this.pluginLabel="Tự động phát",this.autoPlayChecked=!!this.options.autoPlay,this.updateSettingsControl())}else this.disable()}},{key:"_toggleAutoPlay",value:function(e){e.stopPropagation(),this.autoPlayChecked=!this.autoPlayChecked,this.updateSettingsControl(!0)}},{key:"updateSettingsControl",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.getPlayerControl("SettingsControl");t&&t.settingsMenu[e]({pluginKey:this.name,type:Hi.MENU_TYPE.TOGGLE,config:{title:this.pluginLabel,checked:this.autoPlayChecked,clickCallback:this._toggleAutoPlay.bind(this)},order:0,callback:this.registerMenuCallback.bind(this)})}},{key:"destroy",value:function(){xs(Is(Fs.prototype),"destroy",this).call(this),this.boxUnmute&&this.boxUnmute.remove()}},{key:"name",get:function(){return"AutoPlayPlugin"}},{key:"defaultOptions",get:function(){return{showInSettingsMenu:!1,timeout:1e3,showBoxUnmute:!0,boxUnmute:{message:"Nhấn để bật tiếng"}}}}]),Ds(Ze,Ln),Fs);function Fs(){return function(e){if(!(e instanceof Fs))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Is(Fs).apply(this,arguments))||"object"!==Cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Ns(e,t){if(H.array(e)&&t){t=Mt(e.filter(function(e){return!e.disabled}),"label",t);if(H.object(t)&&(t.source||t.level))return t}}function Us(e){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bs(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ys(e){return(Ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vs(e,t,n){return t&&Gs(e.prototype,t),n&&Gs(e,n),e}function Hs(e,t){return(Hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ks=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Hs(e,t)}($s,Ve),Vs($s,[{key:"name",get:function(){return"QualityPlugin"}},{key:"defaultOptions",get:function(){return{autoText:"Auto",autoTextItem:"Auto"}}}]),Vs($s,[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"render",value:function(){if(this.player.isHlsPlayback())return this.listenTo(this.player,O.PLAYER_LEVELS_AVAILABEL,this.onPlayerLevelsAvailabel),void this.listenTo(this.player,O.PLAYER_LEVEL_SWITCHED,this.onPlayerLevelSwitched);var e;this.autoEnabled=!1,this.levels=this.player.options.sources||[],this.handleDisplayName(),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):0,this.levels.length<2||-1===this.currentSourceLevel?this.disable():(this.levels=this.orderLevelsByIndex(this.levels),this.handleDisplayName(),e=this.levels[this.currentSourceLevel],this.settingBadgeLabel=this._generateHdLabel(e.label),this.updateSettingsControl())}},{key:"updateSettingsControl",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.mediaControl.getControl("SettingsControl");t&&(t.settingsButton.updateBadgeLabel(this.settingBadgeLabel),t.settingsMenu[e]({pluginKey:this.name,type:Hi.MENU_TYPE.EXPAND,config:{title:this.pluginLabel,activeItemIndex:this.currentSourceLevel,clickCallback:this.handleExpandQuality.bind(this),subMenu:{type:Hi.LIST_MENU_TYPE.CHECKLIST,clickCallback:this.handleQualitySelected.bind(this),titleClickCallback:this.titleClickCallback.bind(this),data:this.levels}},order:0,callback:this.registerMenuCallback.bind(this)}))}},{key:"handleDisplayName",value:function(){var e=this.pluginOptions,n=e.displayName,r=e.autoTextItem;(n||r)&&this.levels.map(function(e){var t;return n&&e.label&&((t=n[e.label])&&(e.displayName=t)),"auto"==e.label.toLowerCase()&&(e.label=r),e})}},{key:"orderLevelsByIndex",value:function(e){return It(e,"index",!1)}},{key:"onPlayerLevelsAvailabel",value:function(e){var t=this.player.options.sources||[];this.levels=this.orderLevelsByIndex([].concat(Bs(e),Bs(t))),this.handleDisplayName();t=Ns(this.levels,this.player.options.quality);t&&(this.player.options.currentSourceLevel=t.index,this.settingBadgeLabel=this._generateHdLabel(t.label),this.offAuto=!0),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):this.findIndexFromSourceLevels(-1);t=this.levels[this.currentSourceLevel];t&&-1!==t.index&&this.handleHLSLevelSelect(t)}},{key:"findIndexFromSourceLevels",value:function(e){return Ft(this.levels,"index",e)}},{key:"_generateHdLabel",value:function(e){var t=parseInt(e);return this.currentLabel=e,720<=t?"HD":""}},{key:"onPlayerLevelSwitched",value:function(e){var t=e.label;this.currentSwitchedLabel=t,clearTimeout(this.playerLevelSwitchedTimeout),this.offAuto||(this.settingBadgeLabel=this._generateHdLabel(t)),this.updateSettingsControl(!0);var n=oe()(this.menuItemEl).find(".--z--zpl-has-expand span"),e=this.pluginOptions.autoText;this.autoEnabled&&(n.empty(),n.text(e+" "+this.transformDisplayNameLabel(t)))}},{key:"titleClickCallback",value:function(){var e=oe()(this.menuItemEl).find(".--z--zpl-has-expand span"),t=this.pluginOptions.autoText;this.autoEnabled&&(e.empty(),e.text(t+" "+this.transformDisplayNameLabel(this.currentLabel)))}},{key:"transformDisplayNameLabel",value:function(e){var t=this.pluginOptions.displayName;return t&&t[e]||e}},{key:"handleQualitySelected",value:function(e,t){e.stopPropagation();e=t.data;if(this.player.trigger(O.PLAYER_QUALITY_LEVELS_SELECTED,e,t),this.player.trigger(O.PLAYER_SETTINGS_MENU_HIDE),e&&!e.disabled){t=this.findIndexFromSourceLevels(e.index);if(this.currentSourceLevel===t)return!1;this.player.storage.set({quality:e.label}),this.player.isHlsPlayback()?this.handleHLSLevelSelect(e):this.handleMP4QualitySelect(e)}}},{key:"handleMP4QualitySelect",value:function(e){var t=this.player.getCurrentTime(),n=this.player.isPlaying();this.player.stop(),this.player.setupSource(e.source),this.player.setPreload("metadata"),n&&this.listenToOnce(this.player,O.PLAYER_SEEKED,this.onPlayerSeeked),this.player.seek(t),this.currentSourceLevel=this.findIndexFromSourceLevels(e.index),this.settingBadgeLabel=this._generateHdLabel(e.label),this.autoEnabled=!1,this.updateSettingsControl(!0)}},{key:"onPlayerSeeked",value:function(){this.player.play()}},{key:"handleHLSLevelSelect",value:function(e){var t=this,n=e.index,e=-1===n;e&&(this.offAuto=!1),this.currentSourceLevel=this.findIndexFromSourceLevels(n),this.autoEnabled=e,this.player.setCurrentLevel(n),this.player.setStartLevel(n),this.playerLevelSwitchedTimeout=setTimeout(function(){t.onPlayerLevelSwitched({label:t.currentSwitchedLabel})},1e3)}},{key:"handleExpandQuality",value:function(e){e.stopPropagation()}}]),$s);function $s(e){var t;return function(e){if(!(e instanceof $s))throw new TypeError("Cannot call a class as a function")}(this),t=this,(e=!(e=Ys($s).call(this,e))||"object"!==Us(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e).pluginLabel="Chất lượng",e.currentSourceLevel=null,e.autoEnabled=!0,e}function zs(e){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e){return(qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xs(e,t){return(Xs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i(31);var Qs=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Xs(e,t)}(Js,Ve),Ws(Js.prototype,[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"dvrChanged",value:function(){_.info(this.name,"dvrChanged"),this.addDvrToMediaControls()}},{key:"addDvrToMediaControls",value:function(){var e;this.player.isLive()&&(e=Ee("button",{innerHTML:'<span class="icon-live"></span><span class="text">LIVE</span>'},{class:"--z--control --z--btn --z--drv-icon"}),this.$el.append(e),this.player.mediaControl.leftElement.append(this.el))}},{key:"name",get:function(){return"DVRControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--control --z--control-dvr","data-dvr-controls":""}}},{key:"listenEvents",get:function(){return[{once:!0,name:O.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),Js);function Js(){return function(e){if(!(e instanceof Js))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=qs(Js).apply(this,arguments))||"object"!==zs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function Zs(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];!function(e){if(!(e instanceof Zs))throw new TypeError("Cannot call a class as a function")}(this),this.playbackPlugins=[nn,Wt,Dt,un],this.plugins=[],t&&this.plugins.push(Eo);var n=[Ro,ds,ms,xa,Ua,js,No,_a,Pa,os,Qs,Ks];if(this.plugins=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(t=this.plugins)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}(),n),this.plugins.push(fa),!H.empty(e)){var r=!0,t=!1,n=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var a=i.value;H.function(a)&&this.plugins.push(a)}}catch(e){t=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(t)throw n}}}}function el(e){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nl(e){return(nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rl(e,t){return(rl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}window.on=document.on=Element.prototype.on=function(e,t,n){this.namespaces||(this.namespaces={}),this.namespaces[e]=t;n=n||!1;return this.addEventListener(e.split(".")[0],t,n),this},window.off=document.off=Element.prototype.off=function(e){return this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e],this};var il=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),rl(e,t)}(ol,Ve),tl(ol.prototype,[{key:"getControl",value:function(){return null}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),ol);function ol(){return function(e){if(!(e instanceof ol))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=nl(ol).apply(this,arguments))||"object"!==el(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var e,t}function al(e){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sl(e,t,n){return(sl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ll(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function ll(e){return(ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ul(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cl(e,t,n){return t&&ul(e.prototype,t),n&&ul(e,n),e}function dl(e,t){return(dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var hl={mute:!1,loop:!1,autoPlay:!1,volume:100,height:360,width:640,preload:"metadata",dblClickToFullScreen:!0,lockRotateFullscreen:!1,setStorageTheaterMode:!0},pl=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),dl(e,t)}(yl,je),cl(yl,[{key:"name",get:function(){return"Player"}},{key:"attributes",get:function(){var e=this.options,t=e.width,n=e.height;return{class:e.className||"--z--player","data-player":"",tabindex:1,style:"\n                width: ".concat(t&&H.number(t)?t+"px":t,";\n                height: ").concat(n&&H.number(n)?n+"px":n,"\n            ")}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked",contextmenu:"onContextMenu",keydown:"onKeydown",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onMouseMove",touchleave:"onMouseLeave"}}},{key:"listenEvents",get:function(){return[{name:O.PLAYBACK_BUFFERING,handler:this.onBuffering},{name:O.PLAYBACK_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:O.PLAYBACK_BUFFERFULL,handler:this.onBufferfull},{name:O.PLAYBACK_LOADEDMETADATA,handler:this.onLoadedMetadata},{name:O.PLAYBACK_TIMEUPDATE,handler:this.onTimeUpdated},{name:O.PLAYBACK_PROGRESS,handler:this.onProgress},{name:O.PLAYBACK_SEEKED,handler:this.onSeeked},{name:O.PLAYBACK_SEEKING,handler:this.onSeeking},{name:O.PLAYBACK_ENDED,handler:this.onEnded},{name:O.PLAYBACK_PLAY,handler:this.onPlay},{name:O.PLAYBACK_PAUSE,handler:this.onPaused},{name:O.PLAYBACK_STOP,handler:this.onStopped},{name:O.PLAYBACK_ERROR,handler:this.onError},{name:O.PLAYBACK_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:O.PLAYBACK_LEVELS_AVAILABLE,handler:this.onLevelsAvailabel},{name:O.PLAYBACK_LEVEL_SWITCHED,handler:this.onLevelSwitched},{name:O.PLAYBACK_FULLSCREEN_IOS,handler:this._onFullScreenIosChanged},{name:O.PLAYBACK_CANPLAYTHROUGH,handler:this.onCanPlayThrough},{name:O.PLAYBACK_WAITING,handler:this.onWaiting},{once:!0,name:O.PLAYBACK_DVRSTATECHANGED,handler:this.onDrvChanged},{once:!0,name:O.PLAYBACK_PLAY,handler:this.onDrvChanged}]}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"loader",set:function(e){this.loader=e},get:function(){return this._loader||(this._loader=new Zs(this.options.plugins,this.options.useDefaultControl)),this._loader}},{key:"mediaControl",get:function(){return this.getPlugin("ControlsPlugin")||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl||(this._dummyMediaControl=new il(this),this._dummyMediaControl)}}]),cl(yl,[{key:"bindEvents",value:function(){sl(ll(yl.prototype),"bindEvents",this).call(this,this.playback),this._addEventsFullScreen(),window.on("orientationchange",this._onOrientationChanged,!1),window.on("blur",this.onWindowBlur,!1)}},{key:"unbindEvents",value:function(){sl(ll(yl.prototype),"unbindEvents",this).call(this,this.playback),this._removeEventsFullScreen(),window.off("orientationchange",this._onOrientationChanged,!1),window.off("blur",this.onWindowBlur,!1)}},{key:"hasPlugin",value:function(e){return!!this.getPlugin(e)}},{key:"getPlugin",value:function(t){return this.plugins.find(function(e){return e.name===t})}},{key:"removePlugin",value:function(t){this.plugins=this.plugins.filter(function(e){return e.name!==t})}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"getPlaybackName",value:function(){return this.playback.name}},{key:"appendToParent",value:function(){if(!this.el)return null;this.options.parentElement.appendChild(this.el)}},{key:"render",value:function(){if(!this.el)return null;this.$el.append(this.playback.render().el)}},{key:"destroy",value:function(){this.plugins.forEach(function(e){return e.destroy()}),this.playback.destroy(),this.unbindEvents(),this.remove()}},{key:"attachTo",value:function(e){var t=this;this.options.parentElement=e,this._initPlayback(),this.bindEvents(),this.render(),this._initPlugins(),this.appendToParent(),this.playback.isReady().then(function(){return t._initConfig()}).then(function(){return Promise.all(t.plugins.map(function(e){return e.initialize()}))}).then(function(){_.info(t.name,"IS LIVE",t.isLive()),t.trigger(O.PLAYER_READY,t.name)}).catch(function(e){_.error(t.name,"error while initializing player:",e)}),this.setPlayerFontSizeBase()}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"play",value:function(){this.isPlaying()||(this.trigger(O.PLAYER_PLAY_INTENT),this.playback.play())}},{key:"pause",value:function(){this.isPlaying()&&this.playback.pause()}},{key:"togglePlay",value:function(){this.buffering||(this.isPlaying()?this.pause():this.play())}},{key:"stop",value:function(){this.playback.stop()}},{key:"pauseAd",value:function(){this.trigger(O.PLAYER_AD_PAUSE_REQUEST)}},{key:"resumeAd",value:function(){this.trigger(O.PLAYER_AD_RESUME_REQUEST)}},{key:"getVolume",value:function(){return this.playback.getVolume()}},{key:"setVolume",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];!H.number(e)||e<0||100<e?_.debug(this.name,"setVolume fail , volume = ",e):(t=this.getVolume(),this.playback.volume(e),n&&this.storage.set({volume:e,beforeMuteVolume:t}))}},{key:"mute",value:function(e){return this.setVolume(0,e),this}},{key:"unmute",value:function(e){var t=this.storage.get("beforeMuteVolume");return(!H.number(t)||t<=0)&&(t=1),this.setVolume(100*t,e),this}},{key:"isMuted",value:function(){return this.playback.isMuted()}},{key:"seek",value:function(e){this.isLive()||e<0||e>this.getDuration()||(this.trigger(O.PLAYER_SEEK,e,this.name),this.playback.seek(e))}},{key:"isFullscreen",value:function(){return Ti.isFullscreen()}},{key:"isTheaterMode",value:function(){return this.theaterMode}},{key:"setupSource",value:function(e){this.playback.setupSource(e)}},{key:"getSource",value:function(){this.playback.getSource()}},{key:"setCurrentLevel",value:function(e){this.playback.currentLevel=e}},{key:"setStartLevel",value:function(e){this.playback.startLevel=e}},{key:"setPreload",value:function(e){this.playback.setPreload(e)}},{key:"getPlayerControl",value:function(e){return this.mediaControl&&this.mediaControl.getControl(e)}},{key:"setPlaybackRate",value:function(e){this.playback.setPlaybackRate(e)}},{key:"isHlsPlayback",value:function(){return this.playback.isHlsPlayback()}},{key:"isMp4Playback",value:function(){return!this.isHlsPlayback()}},{key:"seekPercentage",value:function(e){var t=this.getDuration();0<=e&&e<=100&&this.seek(t*(e/100))}},{key:"setPlayerFontSizeBase",value:function(){yt&&he(this.el,{fontSize:(this.isFullscreen()?70:60)+"%"})}},{key:"toggleFullscreen",value:function(){var e=this.options,t=e.customIosFullscreen;e.lockRotateFullscreen&&(this.isLandscapeScreen()?rt&&this.removeClass("is-portrait"):(rt&&this.addClass("--z--orient-lock-fullscreen"),rt&&this.addClass("is-portrait"),setTimeout(function(){screen&&screen.orientation.lock("landscape")},300)),this.isFullscreen()&&(rt&&this.removeClass("--z--orient-lock-fullscreen"),rt&&this.removeClass("is-portrait"),setTimeout(function(){return screen&&screen.orientation.unlock()},300))),t?this._toggleFullScreenIos():this._toggleFullScreenNative()}},{key:"isLandscapeScreen",value:function(){return window.innerWidth>window.innerHeight}},{key:"getPlayBack",value:function(){return function(e,t,n){var r=null,i=n.mimeType;H.object(t)?(r=t.source.toString(),t.mimeType&&(i=t.mimeType)):r=t.toString(),r.match(/^\/\//)&&(r=window.location.protocol+r);var o=X({},n,{src:r,mimeType:i}),r=e.filter(function(e){return e.canPlay(t,i)})[0];return new(r="no_op"===r.name&&n.fallbackSrc?e.filter(function(e){return e.canPlay(n.fallbackSrc,i)})[0]:r)(o)}(this.loader.playbackPlugins,this.options.source,this.options)}},{key:"isLive",value:function(){return this.getPlaybackType()===Xe.LIVE}},{key:"getCurrentTime",value:function(){return this.playback.el.currentTime}},{key:"getPlayerSize",value:function(){return{width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"updateSize",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"px",r={};e&&(r.width=e+n),t&&(r.height=t+n),he(this.el,r),this.trigger(O.PLAYER_UPDATE_SIZE,this.el.offsetWidth,this.el.offsetHeight,this.isFullscreen())}},{key:"onClicked",value:function(){_.debug(this.name,"onClicked"),this.trigger(O.PLAYER_CLICK,this,this.name)}},{key:"onDblClicked",value:function(){this.trigger(O.PLAYER_DBLCLICK,this,this.name)}},{key:"onKeydown",value:function(e){this.trigger(O.PLAYER_KEYDOWN,e,this.name)}},{key:"onMouseEnter",value:function(){this.trigger(O.PLAYER_MOUSE_ENTER)}},{key:"onMouseLeave",value:function(){this.trigger(O.PLAYER_MOUSE_LEAVE)}},{key:"onMouseMove",value:function(){this.trigger(O.PLAYER_MOUSE_MOVE)}},{key:"onContextMenu",value:function(e){this.trigger(O.PLAYER_CONTEXTMENU,e,this.name)}},{key:"onBuffering",value:function(){this.trigger(O.PLAYER_BUFFERING,this.name)}},{key:"onBufferingChange",value:function(e){this.trigger(O.PLAYER_BUFFERING_CHANGE,e)}},{key:"onBufferfull",value:function(){this.trigger(O.PLAYER_BUFFERFULL,this.name)}},{key:"onLoadedMetadata",value:function(e){this.trigger(O.PLAYER_LOADEDMETADATA,e)}},{key:"onTimeUpdated",value:function(e){this.currentTime=e.current,this.trigger(O.PLAYER_TIMEUPDATE,e,this.name)}},{key:"onSeeked",value:function(){this.trigger(O.PLAYER_SEEKED,this.name)}},{key:"onSeeking",value:function(e){this.currentTime=e.data.target.currentTime,this.trigger(O.PLAYER_SEEKING,e)}},{key:"onWaiting",value:function(e){this.trigger(O.PLAYER_WAITING,e)}},{key:"onPlay",value:function(){_.debug(this.name,"PLAYER_PLAY"),this.trigger(O.PLAYER_PLAY,this.name)}},{key:"onPaused",value:function(){_.debug(this.name,"PLAYER_PAUSE"),this.trigger(O.PLAYER_PAUSE,this.name)}},{key:"onError",value:function(e){_.error(this.name,"player error:",e),this.trigger(O.PLAYER_ERROR,e,this.name)}},{key:"onStopped",value:function(){this.trigger(O.PLAYER_STOP)}},{key:"onEnded",value:function(){this.trigger(O.PLAYER_ENDED,this.name),this.currentTime=0}},{key:"onVolumeUpdated",value:function(e){this.trigger(O.PLAYER_VOLUMEUPDATE,e)}},{key:"onLevelsAvailabel",value:function(e){this.trigger(O.PLAYER_LEVELS_AVAILABEL,e)}},{key:"onLevelSwitched",value:function(e){this.trigger(O.PLAYER_LEVEL_SWITCHED,e)}},{key:"onCanPlayThrough",value:function(e){this.trigger(O.PLAYER_CANPLAYTHROUGH,e)}},{key:"onProgress",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trigger.apply(this,[O.PLAYER_PROGRESS].concat(t,[this.name]))}},{key:"onDrvChanged",value:function(){this.trigger(O.PLAYER_DVRSTATECHANGED)}},{key:"onWindowBlur",value:function(){yt&&this.pause()}},{key:"_addEventsFullScreen",value:function(){document.on("webkitfullscreenchange",this._onFullScreenChanged,!1),document.on("mozfullscreenchange",this._onFullScreenChanged,!1),document.on("fullscreenchange",this._onFullScreenChanged,!1),document.on("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_removeEventsFullScreen",value:function(){document.off("webkitfullscreenchange",this._onFullScreenChanged,!1),document.off("mozfullscreenchange",this._onFullScreenChanged,!1),document.off("fullscreenchange",this._onFullScreenChanged,!1),document.off("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_onFullScreenIosChanged",value:function(e){_.debug(this.name,"fullscreen status changed on iOS:",e),Ti.isFullscreenIos=e,this._onFullScreenChanged()}},{key:"_onFullScreenChanged",value:function(){_.debug(this.name,"fullscreen status changed:",this.isFullscreen()),this.isFullscreen()?this.$el.addClass("--z--full-screen"):this.$el.removeClass("--z--full-screen"),this.setPlayerFontSizeBase(),this.trigger(O.PLAYER_FULLSCREEN,this.isFullscreen(),this.name)}},{key:"_onOrientationChanged",value:function(){var e=this,t=this.options,n=t.customIosFullscreen,t=t.lockRotateFullscreen;this.setPlayerFontSizeBase(),n&&this.isFullscreen()&&this.backdropEl&&he(this.backdropEl,{height:window.innerHeight+"px"}),t&&this.isFullscreen()&&rt&&setTimeout(function(){e.isLandscapeScreen()?(e.removeClass("--z--orient-lock-fullscreen"),e.removeClass("is-portrait")):(e.addClass("is-portrait"),e.addClass("--z--orient-lock-fullscreen"))},300),this.trigger(O.PLAYER_ORIENTATION_CHANGE,this.isFullscreen())}},{key:"_initPlayback",value:function(){this.playback=this.getPlayBack(),_.debug(this.name,"found playback",this.getPlaybackName()),_.debug(this.name,"found playbacktype",this.getPlaybackType())}},{key:"_initConfig",value:function(){var e=this.options.mute?0:this.options.volume;this.setVolume(e)}},{key:"_initPlugins",value:function(){var t=this;H.empty(this.loader.plugins)||this.loader.plugins.forEach(function(e){t.plugins.push(new e(t))})}},{key:"_extendsOptions",value:function(e){var t=Ns(e.sources,e.quality);t&&(e.source=t.source,e.currentSourceLevel=t.index),e.customIosFullscreen=!!rt}},{key:"_onTouchMove",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"_toggleFullScreenIos",value:function(){this.backdropEl=this.backdropEl||Ee("div",{},{class:"--z--player-backdrop"}),this.isFullscreen()?(this.removeClass("--z--custom-ios-fullscreen"),this.options.parentElement.append(this.el),this.backdropEl.innerHTML="",de(this.backdropEl,"--z--show"),Ti.isFullscreenIos=!1,this.scrollTopPos&&window.scrollTo(0,this.scrollTopPos)):(this.scrollTopPos=this.scrollTopPos||window.scrollY,window.scrollTo(0,0),this.addClass("--z--custom-ios-fullscreen"),he(this.backdropEl,{height:window.innerHeight+"px"}),this.backdropEl.append(this.el),document.body.append(this.backdropEl),de(this.backdropEl,"--z--show"),Ti.isFullscreenIos=!0),this.setPlayerFontSizeBase(),this.trigger(O.PLAYER_FULLSCREEN,this.isFullscreen())}},{key:"_toggleFullScreenNative",value:function(){this.isFullscreen()?Ti.cancelFullscreen():Ti.requestFullscreen(this.el)}},{key:"toggleTheaterMode",value:function(){this.theaterMode=!this.theaterMode,this.toggleClass("--theater-mode",this.theaterMode),this.options.setStorageTheaterMode&&this.storage.set({theaterMode:this.theaterMode}),this.trigger(O.PLAYER_THEATER_MODE_CHANGE,this.theaterMode)}},{key:"mediaControlReady",value:function(){_.debug(this.name,"mediaControlReady"),this.trigger(O.PLAYER_MEDIACONTROL_READY,this.name)}},{key:"disableMediaControl",value:function(){this.trigger(O.PLAYER_MEDIACONTROL_DISABLE,this.name)}},{key:"enableMediaControl",value:function(){this.trigger(O.PLAYER_MEDIACONTROL_ENABLE,this.name)}},{key:"showMediaControl",value:function(){this.trigger(O.PLAYER_MEDIACONTROL_SHOW,this.name)}},{key:"hideMediaControl",value:function(){this.trigger(O.PLAYER_MEDIACONTROL_HIDE,this.name)}}]),yl);function yl(e){!function(e){if(!(e instanceof yl))throw new TypeError("Cannot call a class as a function")}(this);var t=e.storageKey,n=new oa(void 0===t?"zplayer":t);return(t=!(t=ll(yl).call(this,null,X({},hl,e,n.get())))||"object"!==al(t)&&"function"!=typeof t?fl(this):t)._extendsOptions(t.options),_.debug(t.name,"player initialized with option:",e),t.storage=n,t.plugins=[],t._onFullScreenChanged=t._onFullScreenChanged.bind(fl(fl(t))),t.onWindowBlur=t.onWindowBlur.bind(fl(fl(t))),t._onOrientationChanged=t._onOrientationChanged.bind(fl(fl(t))),t.isMenuOpen=!1,t.theaterMode=!!t.options.theaterMode,t.toggleClass("--theater-mode",t.theaterMode),t}function gl(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:400,o=2<arguments.length?arguments[2]:void 0;r.style.opacity||(r.style.opacity=1);var a=null;window.requestAnimationFrame(function e(t){var n=t-(a=a||t),t=parseFloat(1-n/i,2);r.style.opacity=t<0?0:t,i<n?H.function(o)&&o():window.requestAnimationFrame(e)})}function ml(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:400,o=2<arguments.length?arguments[2]:void 0;r.style.opacity||(r.style.opacity=0);var a=null;window.requestAnimationFrame(function e(t){var n=t-(a=a||t),t=parseFloat(n/i,2);r.style.opacity=1<t?1:t,i<n?H.function(o)&&o():window.requestAnimationFrame(e)})}i.d(t,"AdRunner",function(){return vl}),i.d(t,"Constant",function(){return bl}),i.d(t,"PromiseUtils",function(){return a}),i.d(t,"AdUtils",function(){return c}),i.d(t,"AnimationUtils",function(){return f}),i.d(t,"ArraysUtils",function(){return s}),i.d(t,"BaseObject",function(){return V}),i.d(t,"BasePlugin",function(){return re}),i.d(t,"BrowserUtils",function(){return o}),i.d(t,"DomUtils",function(){return r}),i.d(t,"Events",function(){return O}),i.d(t,"HttpUtils",function(){return d}),i.d(t,"IsUtils",function(){return H}),i.d(t,"Log",function(){return _}),i.d(t,"ObjectUtils",function(){return n}),i.d(t,"Player",function(){return pl}),i.d(t,"Storage",function(){return oa}),i.d(t,"StringsUtils",function(){return u}),i.d(t,"TimeUtils",function(){return l}),i.d(t,"UIObject",function(){return je}),i.d(t,"UIPlugin",function(){return Ve});var vl=null,vl=i(4),bl={MediaControlConst:{BG_TYPE_TRANSPARENT:"transparent",BG_TYPE_GRADIENT:"gradient",THEME:{RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"},MAP_THEME_COLOR:{RED:"#f00",BLUE:"#2FA1B3",PURPLE:"#721799",GREEN:"#6cd936",LIGHT_BLUE:"#2196F3"}},SettingsMenuConst:Hi};_.setLevel(_.LEVEL_DISABLED)}])});var now=function(){return+new Date};function Comment(e,t,n){var i,o,l,u,c,d=this,a=e,s=n,f=!0,h=null,p=$(t),y=0<$("#storybox.details--forum").length?20:10,g=0,m=0,v=y;this.fetchComment=function(e){var t;a&&(t=window.cmsConfig.domainDesktop+"/api/comments/get/by-obj?object_type="+s+"&object_id="+a,$.getJSON(t,function(data){null!==data&&e&&"function"==typeof e&&e(data)}))},this.renderComment=function(e,t,n){var r=0<e.Like?e.Like:0,i="",t=$('<div class="comment'+(0<e.ParentID?" clearfix":" inner-comment"+(0<e.ReplyCount?"":" no-sub-comment"))+(t?"":" hidden")+'" id="'+e.ID+'" data-likes="'+r+'" data-time="'+e.CreationDate+'">');if(i+=0<e.ParentID?"":'<div class="topic-comment">',i+='<span class="avatar avatar-comment"><img src="'+e.Avatar+'"></span>',i+='<div class="content content-comment">',i+='<p class="name info-author"><span>'+e.DisplayName+(void 0!==e.IsOwner&&e.IsOwner?' <i class="fa fa-check-circle"></i>':"")+"</span><time>"+formatTime(e.CreationDate,{friendly:!0})+"</time></p>",i+='<p class="text">'+e.Comment.replace(/\\n/g,"</p><p>")+"</p>",i+='<p class="tool comment-actions action-comment">',i+=r<=0?'<a class="btnLike cmt-like" href="#like"><i class="icon-like"></i><span class="count" style="display:none">0</span> Thích</a>':'<a class="btnLike cmt-like-ed" href="#like"><i class="icon-like"></i><span class="count">'+r+"</span> Thích</a>",i+='<a class="btnReply cmt-reply" href="#reply"><i class="icon-paper-plane"></i>Trả lời</a>',i+='<a class="btnReport cmt-report" href="#report" rel="'+e.ID+'"><i class="icon-exclamation"></i>Báo cáo</a>',i+="</p>",i+=0<e.ParentID?"":"</div>",t.html(i+="</div>"),(!n||!1===n)&&0<e.ReplyCount){for(var o=$("<div>",{class:"sub-comments sub-comment","parent-id":e.ID}),a=0;a<e.Replies.length;a++)o.append(d.renderComment(e.Replies[a],!0,!0));t.append(o)}return t.find(".comment-actions a").off("click").on("click",function(e){e.preventDefault();var t,r,i=$(this),o=i.parents("div.comment").attr("id"),n=(n=i.parents("div.sub-comments.sub-comment").attr("parent-id"))||o,e=i.parents("div.content.content-comment").find(".name span").text();i.hasClass("btnReply")?0===i.parents("div.comment").find(".reply").length?(t=$("<div>",{class:"reply  action-comment-reply"}).html('<textarea class="form-control" comment-parent="'+n+'">'+(0<e.length?"@"+e+": ":"")+'</textarea><button class="btnSubmit disabled">Gửi trả lời</a>'),i.parent().after(t),t.find(".btnSubmit").on("click",function(e){e.preventDefault(),t.hide();e=$(this).parents(".reply").find("textarea");d.submitComment(e.val(),!0,e.attr("comment-parent"),function(e){!1===e&&t.show()})})):i.parents("div.comment").find(".reply").remove():i.parents(".comment-actions").hasClass("disabled")?showDialog("Thông báo","<p>Bạn đã bình chọn cho bình luận này rồi. Bạn chỉ có thể bình chọn 1 lần cho mỗi bình luận.</p>"):(e=$(this).parents(".box-comment").attr("data-id"),r="like",i.hasClass("btnReport")&&(r="report"),$.ajax({url:window.cmsConfig.domainDesktop+"/api/comments/post/"+r,type:"POST",dataType:"text",data:{object_type:s,object_id:e,comment_id:o},success:function(e,t,n){0===$.parseJSON(e).error_code&&("like"===r?(i.parents(".comment-actions").addClass("disabled"),i.addClass("active"),(e=i.find("span.count").text().replace("(","").replace(")","")).length<=0&&(e=0),i.find("span.count").show().text("("+(parseInt(e)+1)+")")):"report"===r&&(d.setReportStatus(o),$(".btnReport[rel="+o+"]").remove(),alert("Cảm ơn bạn đã báo tin.")))},fail:function(){console.log("Error like action for comment #"+o)}}))}),t},this.updateReportStatus=function(){var e,t=getCookie("commentReported");null!==t&&(e=new Array,e=JSON.parse(t),$.each(e,function(e,t){$(".btnReport[rel="+t+"]").remove()}))},this.setReportStatus=function(e){var t=getCookie("commentReported"),n=new Array;(n=null!==t?JSON.parse(t):n).push(e),setCookie("commentReported",JSON.stringify(n),365)},this.updateComment=function(e,a){var s=parseInt(e||1);v=y*s,0<(g=g<=0?l.find(".inner-comment").length:g)?(l.find(".inner-comment:lt("+v+")").removeClass("hidden"),l.find(".inner-comment:gt("+v+")").addClass("hidden"),s<m?u.attr("data-page",s+1).show():u.hide()):d.fetchComment(function(data){if(!(null===data.data||data.data.length<=0)){data=data.data;c=Math.max(data.comments.length,parseInt(data.total_comment)),g=data.comments.length,m=Math.floor(g/y)+1,0<$("#total-comment").length&&$("#total-comment").html(c);var e=c,t=data.comments;t.sort(function(e,t){return t.Like-e.Like});for(var n,r,i=0,o=t.length;i<o;i++)0<$(".tab-pane .text-center").length&&$(".tab-pane .text-center").remove(),a&&!0===a?0===$("#"+t[i].ID).length?((r=d.renderComment(t[i],!0)).css("top","-100px"),l.prepend(r),r.transition({top:"0px"},800)):console.log("no new comment"):(n=t[i])&&((r=new Date(n.CreationDate)).setHours(r.getHours()-7),new Date<r&&e--,l.append(d.renderComment(n,i<v)));l.show(),0<$("#ccc, #commentnotify").length&&(0<e?$("#commentcount, #ccc, #commentnotify").html(e).show():$("#commentcount, #commentnotify").hide()),s<m?u.attr("data-page",s+1).show():u.hide()}})},this.checkCommentContent=function(e,t){!e||e.length<=0?alert("Bình luận không thể để trống. Vui lòng chia sẻ vài dòng suy nghĩ của bạn về bài viết."):e.split(" ").length<10?alert("Bình luận của bạn quá ngắn! Ban quản trị sẽ chỉ duyệt nếu bình luận dài tối thiểu 10 chữ."):isVietnamese(e)?t&&"function"==typeof t&&t(!0):alert("Bình luận bằng tiếng Việt có dấu! Ban quản trị sẽ chỉ duyệt nếu bình luận bằng tiếng Việt có dấu.")},this.submitComment=function(n,e,r,i){null!==e&&!0!==e?"undefined"!=typeof ME&&((h=ME.userInfo)&&0<h.userId&&0<h.fullname.length?!0!==h.user_blocked?d.pushComment({userId:h.userId,username:h.fullname,useremail:h.email,useravatar:h.avatar,comment_content:n},function(e){i&&"function"==typeof i&&i(e)},r):showDialog("Thông báo",'<div class="modal-notify"><h4 class="noti__header">Không thể gửi bình luận!</h4><p>Tài khoản của bạn đang bị khóa. <br>Hãy liên hệ qua email <a href="mailto:toasoan@thanhnien.vn">toasoan@thanhnien.vn</a>để mở lại tài khoản.</p></div>'):ME.getUserInfo(function(e){(h=e)||1!=f?h&&0<h.userId&&0<h.fullname.length?!0!==h.user_blocked?d.pushComment({userId:h.userId,username:h.fullname,useremail:0<h.email.length?h.email:"",useravatar:h.avatar,comment_content:n},function(e){i&&"function"==typeof i&&i(e)},r):showDialog("Thông báo",'<div class="modal-notify"><h4 class="noti__header">Không thể gửi bình luận!</h4><p>Tài khoản của bạn đang bị khóa. <br>Hãy liên hệ qua email <a href="mailto:toasoan@thanhnien.vn">toasoan@thanhnien.vn</a>để mở lại tài khoản.</p></div>'):showDialog("",'<h5 class="modal-title">Thông tin cá nhân</h5><div class="signin__text">Địa chỉ email của bạn sẽ không hiển thị và chỉ được dùng để liên hệ khi báo Thanh Niên cần thêm thông tin</div><div class="form-group"><input type="text" id="comment_name" maxlength="25" class="form-control" placeholder="Chọn tên hiển thị"/></div><div class="form-group"><input type="text" id="comment_email" class="form-control" placeholder="Email" /></div>',{submit:{text:"Gửi bình luận",action:function(){var e=$("#comment_name").val().trim(),t=$("#comment_email").val().trim();""!==e&&""!==t?isValidEmailAddress(t)?(d.pushComment({userId:generateUID(),username:e,useremail:t,useravatar:"",comment_content:n},function(e){i&&"function"==typeof i&&i(e)},r),f=!0,closeDialog()):alert("Địa chỉ email chưa đúng định dạng."):alert("Bạn cần phải cung cấp tên và email để gửi bình luận!")}},cancel:{text:"Đóng",action:function(){f=!0,closeDialog(),setTimeout(function(){showDialog("Bình luận chưa được gửi","<p>Bạn chưa điền thông tin cá nhân. Để gửi bình luận, bạn cần phải cung cấp thông tin người dùng. Vui lòng thử lại.</p>")},100)}}}):ME.signupDialog("Đăng nhập để tham gia bình luận",function(data,e){f=e,h=data,d.submitComment(n,!1,r)})})):d.checkCommentContent(n,function(e){null!==e&&!0===e?d.submitComment(n,!1,r):i&&"function"==typeof i&&i(e)})},this.pushComment=function(e,t,n){var r;p.find(".input").hide(),r=capitalizeSentence(r=fixCommonErrors(r=fixContent(e.comment_content)));e={object_type:s,object_id:a,user_id:e.userId,name:e.username,email:e.useremail,comment:r,avatar:e.useravatar};n&&(e.parent_id=n),$.ajax({type:"POST",url:window.cmsConfig.domainDesktop+"/api/comments/post/create",cache:!1,data:e}).fail(function(){p.find(".input").show(),showDialog("Thông báo","<p>Có lỗi xảy ra khi gửi bình luận của bạn. Bạn có thể thử lại sau vài phút.</p>"),t&&"function"==typeof t&&t(!1)}).done(function(msg){p.find(".input").show(),msg.data.comment_id,0<msg.data.comment_id?(p.find(".input").find("textarea").val(""),showDialog("Bình luận đã được gửi","<p>Bình luận của bạn đã được gửi thành công và đang chờ duyệt trước khi hiển thị trên trang.</p>"),t&&"function"==typeof t&&t(!0)):(showDialog("Thông báo","<p>Có lỗi xảy ra khi gửi bình luận của bạn. Bạn có thể thử lại sau vài phút.</p>"),t&&"function"==typeof t&&t(!1))})};!function(){p.attr("id","commentbox").attr("data-id",a).addClass("box-comment").html(""),p.html('<header class="zone__heading"><h3>'+(0<$("#storybox.details--forum").length?"Mời bạn đọc tham gia ý kiến":"Bình luận")+"</h3></header>"),p.append('<div class="box-content"> <figure class="ava"><img id="cmt-user-avatar" src="'+window.cmsConfig.domainStatic+'/styles/img/no-ava.png" alt=""></figure> <div class="input clearfix">     <textarea class="form-control" id="txtComment" placeholder="Ý kiến của bạn?"></textarea>     <div class="w-100 mt-3 d-flex justify-content-between">         <div class="login-path hidden" id="login-comment">            <span>Đăng nhập bằng :</span>            <div class="icon-group" id="socialsignin-cmt">                <a href="javascript:void(0);" class="social--fb fb" rel="facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a>                <a href="javascript:void(0);" class="social--gg gg" rel="google"><i class="fa fa-google-plus" aria-hidden="true"></i></a>                <a href="javascript:void(0);" class="social--zl zl" rel="zalo"><i class="fa fa-zalo" aria-hidden="true"></i></a>                <a href="javascript:void(0);" class="ml" id="login-cms"><i class="icon-envelope" aria-hidden="true"></i></a>            </div>            <span>hoặc</span>            <a href="javascript:void(0);" class="register-link" id="signup-cms">Đăng ký</a>         </div>         <div class="note note-list hidden" id="cmtLoginedNote">Ý kiến của bạn sẽ được biên tập trước khi đăng. Xin vui lòng gõ tiếng Việt có dấu             <ul>                 <li><i class="fa fa-square"></i>Tối thiểu 10 chữ</li>                 <li><i class="fa fa-square"></i>Không chứa liên kết</li>             </ul>         </div>     <button class="btnSubmit">Gửi bình luận</button></div></div><div class="user">     <ul class="nav nav-tabs" id="comment_tab" role="tablist">         <li class="nav-item">             <a class="nav-link" href="javascript:void(0);"><span id="total-comment">0</span> bình luận</a>         </li>         <li class="nav-item">             <a class="nav-link active" data-toggle="tab" href="#cmtliketab" role="tab" aria-controls="cmtliketab" aria-selected="false" id="btnLikeTab"><i class="icon-like"></i>Theo lượt thích</a>         </li>         <li class="nav-item">             <a class="nav-link" data-toggle="tab" href="#cmttimetab" role="tab" aria-controls="cmttimetab" aria-selected="false" id="btnTimeTab"><i class="icon-clock"></i>Theo thời gian</a>         </li>     </ul>     <div class="tab-content" id="TabContent">         <div class="tab-pane fade show active" role="tabpanel" aria-labelledby="like-tab" id="cmtliketab">             <div class="text-center">Hãy là người đầu tiên đưa ra ý kiến cho bài viết này!</div>         </div>         <div class="tab-pane fade" role="tabpanel" aria-labelledby="time-tab" id="cmttimetab">             <div class="text-center">Hãy là người đầu tiên đưa ra ý kiến cho bài viết này!</div>         </div>         <button data-page="1" style="display:none;" class="btn btn-link btn-lg mt-3 btnMore">XEM THÊM BÌNH LUẬN</button>     </div></div></div>'),i=p.find(".input textarea"),o=p.find("button.btnSubmit"),l=p.find("div.user #cmtliketab"),u=p.find(".btnMore");var e,t,n=p.find("#btnTimeTab"),r=p.find("#btnLikeTab");ME&&(e=p.find("#login-cms"),t=p.find("#signup-cms"),e.on("click",function(e){e.preventDefault(),ME.loginDialog("Đăng nhập")}),t.on("click",function(e){e.preventDefault(),ME.signupDialog("Đăng ký")})),o.on("click",function(e){e.preventDefault(),d.submitComment(i.val(),!0)}),u.on("click",function(e){e.preventDefault(),d.updateComment(parseInt($(this).attr("data-page")))}),n.on("click",function(e){var t;0<$(".tab-pane .text-center").length&&$(".tab-pane .text-center").remove(),0===$("#cmttimetab > div.inner-comment").length&&($("#cmttimetab").html($("#cmtliketab").html()),t=$("#cmttimetab > div.inner-comment").sort(function(e,t){e=parseFloat($(e).attr("data-time")),t=parseFloat($(t).attr("data-time"));return e<t?1:t<e?-1:0}),$("#cmttimetab").html(t),$("#cmttimetab > div.inner-comment:lt("+v+")").removeClass("hidden"),$("#cmttimetab > div.inner-comment:gt("+v+")").addClass("hidden")),l=p.find("div.user #cmttimetab")}),r.on("click",function(e){var t;0<$(".tab-pane .text-center").length&&$(".tab-pane .text-center").remove(),0===$("#cmtliketab > div.inner-comment").length&&($("#cmtliketab").html($("#cmttimetab").html()),t=$("#cmtliketab > div.inner-comment").sort(function(e,t){e=parseInt($(e).attr("data-likes")),t=parseInt($(t).attr("data-likes"));return e<t?1:t<e?-1:0}),$("#cmtliketab").html(t),$("#cmtliketab > div.inner-comment:lt("+v+")").removeClass("hidden"),$("#cmtliketab > div.inner-comment:gt("+v+")").addClass("hidden")),l=p.find("div.user #cmtliketab")}),d.updateComment(1),p.show(),d.updateReportStatus()}()}function generateUID(){return"user_"+((new Date).getTime().toString()+Math.round(1e4*Math.random()))}function formatTime(e,t){var n,r,i,o=parseInt(e)<1e4?new Date(e.replace(/-/g,"/").replace("+"," +")):new Date(1e3*parseInt(e)),e=t&&t.prefix?t.prefix:"";if(t&&!0===t.friendly){if(i=now()-o.getTime(),i-=1e3*(n=Math.floor(i/1e3/60/60/24))*60*60*24,i-=1e3*(r=Math.floor(i/1e3/60/60))*60*60,i=Math.floor(i/1e3/60),0===n&&0===r)return e+i+" phút trước";if(1===n)return e+"Hôm qua, lúc "+o.getHours()+" giờ "+o.getMinutes()+" phút"}return e+" "+(r=(o.getHours()<10?"0":"")+o.getHours())+":"+(i=(o.getMinutes()<10?"0":"")+o.getMinutes())+" ngày "+(n=(o.getDate()<10?"0":"")+o.getDate())+"/"+((o.getMonth()<9?"0":"")+(o.getMonth()+1))+"/"+o.getFullYear()}function isVietnamese(e){return""===e.trim()||null!==e.match(/á|à|ạ|ả|ã|â|ấ|ầ|ẩ|ẫ|ậ|ă|ắ|ằ|ẳ|ẵ|ặ|é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ|ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ|í|ì|ỉ|ĩ|ị|ú|ù|ủ|ũ|ụ/i)}function fixContent(e){var e=e;return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\s(k|hok|ko)\s/gi," không ")).replace(/\sj\s/gi," gì ")).replace(/potay/gi,"bó tay")).replace(/\sngta/gi," người ta")).replace(/\sng\s/gi," người ")).replace(/\s(dc|đc)/gi," được")).replace(/\smún/gi," muốn")).replace(/\se\s/gi," em ")).replace(/\swa\s/gi," qua ")).replace(/\szậy/gi," vậy")).replace(/hehe(\S*)/i,"")).replace(/:v/gi,"")).replace(/:\)\)+/gi,":)")).replace(/\^\^+/gi,"")).replace(/@@+/g,"@")).replace(/haizz+/gi,"")).replace(/T_+T/gi,"")).replace(/[@#$!%][!@#$%]+/gi,"")}function fixCommonErrors(e){var t=e;t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/!{2,}/g,"!")).replace(/\.{2,}/g,"...")).replace(/\?{2,}/g,"?")).replace(/,{2,}/g,",")).replace(/__+/gi,"_")).replace(/\s+!/g,"!")).replace(/\s+\?/g,"?")).replace(/\s+,/g,",")).replace(/\s+\./g,".")).replace(/\s+\)/g,")")).replace(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi,"")).replace(/(https*:|www\.)\S+/gi,"");for(var n=["("],r=0,i=n.length;r<i;r++){var o=e.match(new RegExp("(\\S)\\"+n[r],"g"));if(o)for(var a=0,s=o.length;a<s;a++)t=t.replace(o[a],o[a].charAt(0)+" "+n[r])}return t=t.replace(/(\s)\1+/g," ")}function capitalizeSentence(e){for(var t=[".","?","!"],n=0,r=t.length;n<r;n++){var i=e.match(new RegExp("\\"+t[n]+"\\s*([^"+t[n]+"])","g"));if(i)for(var o=0,a=i.length;o<a;o++){var s=i[o].charAt(i[o].length-1).toUpperCase();e=e.replace(i[o],t[n]+" "+s)}}return e=e.charAt(0).toUpperCase()+e.substring(1)}function isValidEmailAddress(e){return new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e)}$(document).ready(function(){var e,t,n,r=$(".article-comment");r.length&&(e=$("<section>"),t=r.attr("data-id"),n=r.attr("data-type"),t&&(new Comment(t,e,n),r.append(e),ME&&(ME.displayUserComment(),ME.loginSocial())))});var ePiTextToSpeech=function(){var u,a,c=window.IS_MOBILE?"mobile":-1<window.USER_AGENT.indexOf("mobile")?"tablet":"desktop",d=$(".play-button i"),f=$(".mute-button i"),h=100,p=[],y=!0;function e(){var e;function t(e){e.preventDefault(),o();var t=$(".fill-recent"),n=$(this).width(),r=t.offset().left,n=(e.touches[0].clientX-r)/n;u.seek((n=1<(n=n<0?0:n)?1:n)*a),t.css({width:100*n+"%"})}function s(){var e;u&&(a=u.getDuration(),u&&(e=u.getVolume(),$(".volume-slider-handle").css({left:50*e}),(0<e?r:n)()),function(e){e=i(e);$(".time-display .duration").html(e)}(a),u.on(zPlayer.Events.PLAYER_PAUSE,function(e){o()}),u.on(zPlayer.Events.PLAYER_ENDED,function(e){l()}),u.on(zPlayer.Events.PLAYER_VOLUMEUPDATE,function(e){}),u.on(zPlayer.Events.PLAYER_TIMEUPDATE,function(e){var t=u.getCurrentTime(),n=t/a*100+"%";$(".fill-recent").css({width:n}),function(e){e=i(e);$(".time-display .current").html(e),$(".wrap-recent .current_time").html(e)}(t)}),u.play(),d.addClass("fa-pause"),d.removeClass("fa-play"),d.removeClass("fa-spinner-third"))}function o(){u&&(u.pause(),d.addClass("fa-play"),d.removeClass("fa-pause"),d.removeClass("fa-spinner-third"))}function l(){u&&(u.seek(0),u.off(zPlayer.Events.PLAYER_PAUSE),o())}function n(){f.addClass("fa-volume-mute"),f.removeClass("fa-volume")}function r(){f.addClass("fa-volume"),f.removeClass("fa-volume-mute")}function i(e){return e=parseInt(e),Math.floor(e/60)+":"+String(e%60).padStart(2,"0")}window.onload=function(){var e;0<$(".bm-player").length&&(e=getCookie("tts_voice"),(e=$('.voice-board .voice-name[data-voice-id="'+e+'"]')).length<=0&&!(0<(e=$(".voice-board .voice-name")).length)||e[0].click())},$(".voice-board .voice-name").click(function(e){var t,n,r,i,o,a=$(this).parent();a.hasClass("is-active")?s():(l(),$(".voice-board li").removeClass("is-active"),a.addClass("is-active"),t=a.index(),p[t]?(u=p[t],s()):(y||(i=$('.tts-player[data-index="'+t+'"] .player')[0],o="player-wrapper-"+t,n="video/mp4",a={mimeType:n=0<(a=$(i).find("source").attr("data-src")).indexOf("m3u8")?"video/mpeg":n,source:a,poster:"",height:i.clientHeight,width:"100%",playInline:!0},r=new zPlayer.Player(a),i.outerHTML='<div id="'+o+'" class="player"></div>',r.attachTo(document.getElementById(o)),r.wid=o,d.removeClass("fa-pause"),d.removeClass("fa-play"),d.addClass("fa-spinner-third"),console.log("0. start event load metadata"),r.on(zPlayer.Events.PLAYER_LOADEDMETADATA,function(e){console.log(e),console.log("1. metadata loaded"),p[t]=r,u=r,e.data.path?$('.tts-player[data-index="'+t+'"]').data("src")===$(e.data.path[3]).data("src")&&(console.log("2. event in path play after meta data loaded"),s()):(console.log("2. event not path play after meta data loaded"),s())})),y=!1),i=$(this).data("display-name"),o=$(this).data("voice-id"),$(".select-voice span").html(i),y||setCookie("tts_voice",o,30))}),$(".mute-button").click(function(){u.isMuted()?u&&(u.unmute(),r()):u&&(u.mute(),n())}),$(".play-button").click(function(){var e;u?(u.isPlaying()?o:s)():0<(e=$(".voice-board .is-active .voice-name")).length&&($(e[0].parentNode).removeClass("is-active"),e[0].click())}),console.log("deviceType",c),"desktop"==c?($(".volume-slider").mousedown(function(e){var t,n;e.preventDefault(),1===e.which&&(t=$(this).width(),n=$(this).offset().left,$(this).offset().top,e=(e.pageX-n)/t,h=100*e,u&&u.setVolume(h),$(".volume-slider-handle").css({left:50*e}),$(this).addClass("is-active"),$(document).mousemove(function(e){e=(e.pageX-n)/t;h=100*(e=1<(e=e<0?0:e)?1:e),u&&u.setVolume(h);e*=50;$(".volume-slider-handle").css({left:e})}),$(document).mouseup(function(e){$(document).unbind("mousemove"),$(".volume-slider").removeClass("is-active"),$(document).unbind("mouseup")}))}),$(".progress-bar").mousedown(function(e){var t,n,r,i;1===e.which&&(t=u.getDuration(),n=$(".fill-recent"),r=$(this).width(),i=n.offset().left,e=(e.pageX-i)/r,o(),u.seek(e*t),n.css({width:100*e+"%"}),$(document).mousemove(function(e){e=(e.pageX-i)/r;u.seek((e=1<(e=e<0?0:e)?1:e)*t),n.css({width:100*e+"%"})}),$(document).mouseup(function(e){$(document).unbind("mousemove"),s(),$(document).unbind("mouseup")}))})):(e=document.getElementById("progress-bar"))&&(e.addEventListener("touchstart",t,!1),e.addEventListener("touchmove",t,!1),e.addEventListener("touchend",function(e){e.preventDefault(),s()},!1))}return{load:function(){e()}}};$(function(){0<$(".bm-player").length&&ePiTextToSpeech().load()});var bodywidth=$("#abody").width();function updatebody(){"undefined"!=typeof Web_AdsArticleFooterLeft&&0!=Web_AdsArticleFooterLeft.aNodes.length||"undefined"!=typeof Web_AdsArticleFooterRight&&0!=Web_AdsArticleFooterRight.aNodes.length||$("#detailsbottombanner").remove(),$("#storybox #abody div[style]").each(function(){$(this).attr("style",$(this).attr("style").replace("margin","nomargin"))}),$('#abody td[style*="background-color"]').each(function(){var e=$(this).parents("table");e.length<2?((e=$(this).parents("table:first")).addClass("quote--full"),e.css("width","auto")):e=$(e[1]),e.hasClass("quote")||(0<$(this).attr("style").indexOf("#fae6ab")?e.addClass("quote quote--yellow"):0<$(this).attr("style").indexOf("#e3edf7")?e.addClass("quote quote--cyan"):0<$(this).attr("style").indexOf("#ffffff")&&e.addClass("quote quote--white"))}),$("#abody table.quote--full").addClass("quote"),$('#abody img[src*="news-pbdes.jpg"],#abody img[src*="/img-thanhnien/quote1.gif"]').each(function(){var e=$(this).parents("table:first").parents("table:first");0<e.length&&(e.addClass("quote quote--grey"),e.find("table:first").css("background-color","#f1f1f1"),e.find('img[src*="news-pbdes.jpg"],img[src*="/img-thanhnien/quote1.gif"]').attr("src",window.cmsConfig.domainStatic+"/styles/img/quote2.png"),e.find('img[src*="news-pbdes-2.jpg"],img[src*="/img-thanhnien/quote2.gif"]').remove())}),$("#abody .quote.has-icon").each(function(){0==$(this).find("i").length&&$(this).prepend('<i class="spr spr--quote"></i>')}),$("#abody .quotetable .quote").each(function(){$(this).parents("table.quotetable").replaceWith($(this))}),$("#abody .cms-video").each(function(){$(this).find('a[img=""]').attr("img",window.cmsConfig.domainStatic+"/styles/img/bg-video-thanhnien.png"),$(this).find('img[src=""]').attr("src",window.cmsConfig.domainStatic+"/styles/img/bg-video-thanhnien.png");var e="";0<$(this).parents("figure").length&&""!==(e=$(this).parents("figure:first").find("figcaption").text().trim())&&$(this).parents("figure:first").find("figcaption").replaceWith('<div class="pswp-content__caption"><i class="spr spr--video"></i><div class="imgcaption">'+e+"</div></div>"),""===e&&0<$(this).parents("table.video:first").find(".pswp-content__caption").length&&""!==(e=$(this).parents("table.video:first").find(".pswp-content__caption").text().trim())&&($i=$(this).parents("table.video:first").find(".pswp-content__caption").find("i"),0<$i.length?$i.attr("class","spr spr--video"):$(this).parents("table.video:first").find(".pswp-content__caption").prepend('<i class="spr spr--video"></i>')),""===e&&0<$(this).parent("div").next().length&&""!==(e=$(this).parent("div").next("div").text().trim())&&$(this).parent("div").next("div").addClass("imgcaption").wrap('<div class="pswp-content__caption"></div>').before('<i class="spr spr--video"></i>')}),0<$("#storybox #chapeau").length&&(""===$("#storybox #chapeau").html()&&($("#storybox #chapeau").html($("#storybox #abody h2:first").html()),$("#storybox #abody h2:first").remove()),0<=$("#storybox #chapeau").html().indexOf("(TNO)")&&""!==_prefixDesc&&$("#storybox #chapeau").html($("#storybox #chapeau").html().replace("(TNO)",""))),0<$("#livetimeline").length&&(0<$("#livestream").length?($("#abody #livestream > div.hastitle").each(function(){$("#livetimeline").append('<li><a href="#'+$(this).attr("id")+'"><time>'+$(this).find("time").html()+"</time><span>"+$(this).find(".livetitle strong").html()+"</span></a></li>")}),1<$("#livetimeline li").length&&$("#timelineinit").remove(),$("#livetimeline").height($(window).height()-80),$("#livetimeline").parent(".details--live__aside").height($(window).height()-80),$("#livetimeline li > a").click(function(e){e.preventDefault(),$("html, body").animate({scrollTop:$($(this).attr("href")).offset().top-30},"slow")})):$(".details--live__aside").remove()),$("#storybox #abody .rrHandle").remove(),$("#storybox #abody article.story a").attr("target","_blank"),$("#storybox #abody table.image").attr("width",""),$("#abody .cms-video").each(function(){var e,t="";0<$(this).parents("td").length&&((e=$(this).parents("td:first").clone()).find(".cms-video").remove(),t=e.html()),""===(t=""===(t=""===t&&0<$(this).parent().find("span").length?$(this).parent().find("span").text():t)&&"div"==$(this).parent().prop("tagName").toLowerCase()&&""==(t=$(this).parent().text())?$(this).parent().next().text():t)&&((e=$(this).parent().clone()).find(".cms-video").remove(),t=e.html());try{t=t.trim()}catch(e){}""!==t&&$(this).find("video").attr("video-title",strip_tags(t))})}0===$("#abody #premiumcontent").length&&updatebody();var isFloatShow=!0,isLoadMore=!1;if($(window).scroll(function(){$(window).scrollTop()+$(window).height()>$("footer.site-footer").offset().top+(isLoadMore?$(window).height()/2:50)?isFloatShow&&(isLoadMore?($("nav.floating-bar").addClass("hidden"),isFloatShow=!1):($("#othercontents .hidden").removeClass("hidden"),isLoadMore=!0)):isFloatShow||($("nav.floating-bar.hidden").removeClass("hidden"),isFloatShow=!0)}),0<$("#interviewform").length&&(insertCity("interview"),$("#btnsendquestion").click(function(){var e=$(this).attr("data-id"),t=$("#txtnameinterview"),n=$("#txtemailinterview"),r=$("#txtaddressinterview"),i=$("#txtcontentinterview"),o={iid:e,name:$.trim(t.val()),email:$.trim(n.val()),content:$.trim(i.val()),intro:$.trim(r.val())};parseInt(e)<=0||""===o.name||""===o.email||""===o.content?alert("Bạn chưa nhập đủ thông tin!"):$.ajax({url:"/api/interviews/post/question",method:"POST",cache:!1,data:o,success:function(data){alert("Gửi câu hỏi thành công"),$(t).val(""),$(n).val(""),$(i).val(""),$(r).val("")}})})),$(document).ready(function(){3==$(".native-ad > div").children().length&&$(".native-ad").remove()}),0<$(".rating > div").length&&(loadStyle("raty_css",window.cmsConfig.domainStatic+"/js/raty/lib/jquery.raty.css"),loadPlugin("raty","/raty/lib/jquery.raty.min.js",function(){var n=null;$(".rating > div").raty({path:window.cmsConfig.domainStatic+"/js/raty/images/",score:function(){return $(this).attr("data-score")},click:function(e,t){$(this).attr("data-score",e),null==n?n=grecaptcha.render("captcha_container",{sitekey:"6Lci1RATAAAAACC1Aww1IZrkmX3e9MvFPevnhXW6",callback:function(e){}}):grecaptcha.reset(n),$("#rating_modal").modal(),$("#btnratingsend").attr("rel",$(this).attr("rel")).attr("data-score",$(this).attr("data-score"))}}),$("#btnratingsend").click(function(){var e=grecaptcha.getResponse(n);if(""===e)return alert("Bạn vui lòng nhập mã Captcha"),!1;$.ajax({type:"POST",url:"/api/authors/post/rate",data:{author_id:$(this).attr("rel"),rate:$(this).attr("data-score"),captcha:e},cache:!1}).done(function(msg){alert(msg.error_message),$("#rating").raty("reload"),$("#btnratingclose").click(),grecaptcha.reset(n)})})})),0<$("#post-player").length){var postPlayerContainer=$("#post-player").width();showVideoFull("post-player",htmlDecode($("#stvideo"+_stindex).html()),$("#stimage"+_stindex).html(),$("#post-player").width(),$("#post-player").height(),postPlayerContainer,$("#stlink"+_stindex).text().trim()),$("#post-player").attr("auto","true").removeClass("story__thumb"),$("#post-player video").attr("video-title",$("#sttitle"+_stindex).text().trim()),$("#storyvideotitle").html($("#sttitle"+_stindex).text().trim());var videocount_=4;_stindex++;for(var _vi=0;_vi<videocount_;_vi++)_vi%2==0&&$("#postvideolist").append("<li></li>"),_stindex++,_stindex>=_stcount&&(_stindex=0),$("#postvideolist > li:last-child").append('<article class="story"><a href="javascript:void(0);" class="story__thumb" video="" img="'+$("#stimage"+_stindex).html()+'" con="post-player" idx="'+_stindex+'"><img src="'+$("#stimages"+_stindex).html()+'" alt=""/></a><h2><a href="javascript:void(0);" idx="'+_stindex+'" class="story__title shorten" video="" img="'+$("#stimage"+_stindex).html()+'" con="post-player">'+$("#sttitle"+_stindex).html()+"</a></h2></article>");$("#postvideolist li a").click(function(e){$("#storyvideotitle").html($("#sttitle"+$(this).attr("idx")).text());var t=$("#post-player").width(),n=$("#post-player").height();$("#post-player").html(""),showVideoFull("post-player",htmlDecode($("#stvideo"+$(this).attr("idx")).html()),$("#stimage"+$(this).attr("idx")).html(),t,n,postPlayerContainer,$("#stlink"+$(this).attr("idx")).text().trim()),$("#post-player video").attr("video-title",$("#sttitle"+$(this).attr("idx")).text().trim()).attr("auto","")})}if(0<$("#contentAvatar video").length&&$("#contentAvatar video").attr("video-title",$("#contentAvatar .imgcaption").text()),0<$(".btn-game-vote").length){var gameVotes=[];try{gameVotes=JSON.parse(getCookie("game_vote"))}catch(e){gameVotes=[]}null==gameVotes&&(gameVotes=[]),$(".btn-game-vote").each(function(){0<=gameVotes.indexOf($(this).attr("data"))&&$(".btn-game-vote").addClass("vote-done")}),$(".btn-game-vote").click(function(e){e.preventDefault();var t,e=0<=gameVotes.indexOf($(this).attr("data"));e&&$(this).addClass("vote-done"),e||(t=$(this).attr("data"),$.ajax({type:"POST",url:"/api/games/post/vote",data:{id:t}}).done(function(msg){0===msg.error_code&&(0<$("#gvc"+t).length&&$("#gvc"+t).html(parseInt($("#gvc"+t).html())+1),gameVotes.push(t),setCookie("game_vote",JSON.stringify(gameVotes),365),$(".btn-game-vote").addClass("vote-done"),alert("Cảm ơn bạn đã bình chọn."))}))})}0<$(".btn-giftcode").length&&($.ajax({url:window.cmsConfig.domainDesktop+"/api/games/post/check-giftcode",type:"POST",data:{game_id:$(".btn-giftcode").attr("data")},success:function(msg){msg.data&&!0===msg.data.status?$(".btn-giftcode").removeClass("hidden"):$(".btn-giftcode").remove()}}),$(".btn-giftcode").click(function(){var n=$(this).attr("data");n.length<=0||(0<$("#modal_giftcode").length?($("#fbsharegiftcode").attr("data-id",n),$("#modal_giftcode").addClass("show"),$(".modal-backdrop").length<=0&&$("body").append('<div class="modal-backdrop fade show"></div>')):$.ajax({url:window.cmsConfig.domainStatic+"/template/giftcode.html",success:function(e){var t=$(e),e=t.find("#fbsharegiftcode");0<e.length&&e.attr("data-id",n),$("body").append(t.html()),$("body").append('<div class="modal-backdrop fade show"></div>'),$("#fbsharegiftcode").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();var s=$(this).attr("data-id");FB.login(function(e){var t,n,r,i,o,a;"connected"===e.status&&(t=e.authResponse.userID,n=e.authResponse.accessToken,r=0,o=i="","undefined"==typeof ME||!ME.userInfo||(a=ME.userInfo)&&(0<a.userId&&(r=a.userId),0<a.fullname.length&&(i=a.fullname),0<a.email.length&&(o=a.email)),a=window.location.href,FB.ui({method:"share",href:a,display:"dialog"},function(e){e&&!e.error_message?(e={fbId:t,game_id:s,user_id:r,user_fullname:i,user_email:o,token:n},$.ajax({type:"POST",url:"/api/games/post/giftcode",data:e}).done(function(msg){0<=msg.error_code&&msg.data&&msg.data.code?$("#modal_giftcode_body").html('<p style="text-align: center;">Gift code của bạn là :<br /><strong>'+msg.data.code+"</strong><br />Xin vui lòng chờ 30 phút để nhận code mới.</p>"):-350==msg.error_code&&msg.data&&msg.data.code?$("#modal_giftcode_body").html('<p style="text-align: center;">Bạn đã nhận Gift code:<br /><strong>'+msg.data.code+"</strong><br />Xin vui lòng chờ 30 phút để nhận code mới.</p>"):$("#modal_giftcode_body").html('<p style="text-align: center;">Không còn code hợp lệ hoặc bạn đã nhận toàn bộ code có thể. Xin bạn vui lòng thử lại sau.</p>'),$("#modal_giftcode").hasClass("show")||$("#modal_giftcode").addClass("show")})):(alert("Bạn vui lòng share bài viết để nhận được giftcode. Xin cảm ơn"),$("#modal_giftcode").remove(),0<$(".modal-backdrop").length&&$(".modal-backdrop").remove())}))},{scope:"email"}),$("#modal_giftcode").removeClass("show")}),$("#modal_giftcode .close").click(function(e){$("#modal_giftcode").remove(),0<$(".modal-backdrop").length&&$(".modal-backdrop").remove()})}}))}));